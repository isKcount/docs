import{_ as n}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as s,c as a,f as e}from"./app.ca0279c0.js";const t={},p=e(`<h1 id="kubectl\u591A\u96C6\u7FA4\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#kubectl\u591A\u96C6\u7FA4\u914D\u7F6E" aria-hidden="true">#</a> Kubectl\u591A\u96C6\u7FA4\u914D\u7F6E</h1><h3 id="\u524D\u8A00" tabindex="-1"><a class="header-anchor" href="#\u524D\u8A00" aria-hidden="true">#</a> \u524D\u8A00</h3><ul><li>Kubectl \u662F\u4E00\u4E2A\u547D\u4EE4\u884C\u63A5\u53E3\uFF0C\u7528\u4E8E\u5BF9 Kubernetes \u96C6\u7FA4\u8FD0\u884C\u547D\u4EE4\u3002</li><li>Kubectl \u5728 <code>$HOME/.kube</code> \u76EE\u5F55\u4E2D\u5BFB\u627E\u4E00\u4E2A\u540D\u4E3A config \u7684\u6587\u4EF6\u3002</li><li>\u4F60\u53EF\u4EE5\u901A\u8FC7\u8BBE\u7F6E\u73AF\u5883\u53D8\u91CF KUBECONFIG \u6216\u8BBE\u7F6E --kubeconfig \u53C2\u6570\u6307\u5B9A\u5176\u5B83 kubeconfig \u6587\u4EF6\u3002</li></ul><h3 id="\u57FA\u672C\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#\u57FA\u672C\u914D\u7F6E" aria-hidden="true">#</a> \u57FA\u672C\u914D\u7F6E</h3><ol><li>\u5F53\u96C6\u7FA4\u521D\u59CB\u5316\u6210\u529F\u540E\uFF0C\u8981\u4F7F kubectl \u9002\u7528\u4E8E\u975E root \u7528\u6237\uFF0C\u5219\u9700\u8981\u8FD0\u884C\u4EE5\u4E0B\u547D\u4EE4\uFF0C\u8FD9\u4E9B\u547D\u4EE4\u4E5F\u662F kubeadm init\u8F93\u51FA\u7684\u4E00\u90E8\u5206\uFF1A</li><li>\u5373\u521B\u5EFA.kube\u76EE\u5F55 -&gt; \u62F7\u8D1D\u914D\u7F6E\u6587\u4EF6 -&gt; \u7528\u6237\u6388\u6743</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token environment constant">$HOME</span>/.kube
$ <span class="token function">sudo</span> <span class="token function">cp</span> <span class="token parameter variable">-i</span> /etc/kubernetes/admin.conf <span class="token environment constant">$HOME</span>/.kube/config
$ <span class="token function">sudo</span> <span class="token function">chown</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">id</span> <span class="token parameter variable">-u</span><span class="token variable">)</span></span><span class="token builtin class-name">:</span><span class="token variable"><span class="token variable">$(</span><span class="token function">id</span> <span class="token parameter variable">-g</span><span class="token variable">)</span></span> <span class="token environment constant">$HOME</span>/.kube/config
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>\u5F53\u7136\uFF0C\u5982\u679C\u4F60\u662F root \u7528\u6237\uFF0C\u5219\u53EF\u4EE5\u76F4\u63A5\u6DFB\u52A0\u73AF\u5883\u53D8\u91CF\uFF1A</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token builtin class-name">export</span> <span class="token assign-left variable">KUBECONFIG</span><span class="token operator">=</span>/etc/kubernetes/admin.conf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="\u591A\u96C6\u7FA4\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#\u591A\u96C6\u7FA4\u914D\u7F6E" aria-hidden="true">#</a> \u591A\u96C6\u7FA4\u914D\u7F6E</h3><h4 id="\u67E5\u770Bkubeconfig" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770Bkubeconfig" aria-hidden="true">#</a> \u67E5\u770Bkubeconfig</h4><p>\u540C\u6837\u9700\u8981\u65B0\u5EFA<code>.kube</code>\u6587\u4EF6\u5939\uFF0C\u62F7\u8D1D\u4E0D\u540C\u96C6\u7FA4\u7684config\uFF0C\u4F8B\u5982\u91CD\u547D\u540D\u4E3A<code>config-ceph</code>\u548C<code>config-kubevirt</code>\uFF0C\u5206\u522B\u67E5\u770B\u914D\u7F6E\u6587\u4EF6\u3002 \u9700\u8981\u5BF9\u76F8\u5E94\u7684\u53C2\u6570\u8FDB\u884C\u4FEE\u6539\uFF1A</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@jenkins .kube<span class="token punctuation">]</span><span class="token comment"># cat config</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">clusters</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">cluster</span><span class="token punctuation">:</span>
    <span class="token key atrule">certificate-authority-data</span><span class="token punctuation">:</span> LS0tLS1CRUdJTiBDRVJUSU<span class="token important">******</span>
    <span class="token key atrule">server</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//10.88.88.147<span class="token punctuation">:</span><span class="token number">6443</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> kubernetes								<span class="token comment">#\u8FD9\u91CC\u9700\u8981\u4FEE\u6539</span>
<span class="token key atrule">contexts</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">context</span><span class="token punctuation">:</span>
    <span class="token key atrule">cluster</span><span class="token punctuation">:</span> kubernetes							<span class="token comment">#\u8FD9\u91CC\u9700\u8981\u4FEE\u6539</span>
    <span class="token key atrule">user</span><span class="token punctuation">:</span> kubernetes<span class="token punctuation">-</span>admin						<span class="token comment">#\u8FD9\u91CC\u9700\u8981\u4FEE\u6539</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> kubernetes<span class="token punctuation">-</span>admin@kubernetes				 <span class="token comment">#\u8FD9\u91CC\u9700\u8981\u4FEE\u6539</span>
<span class="token key atrule">current-context</span><span class="token punctuation">:</span> kubernetes<span class="token punctuation">-</span>admin@kubernetes	  <span class="token comment">#\u8FD9\u91CC\u9700\u8981\u4FEE\u6539</span>
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Config
<span class="token key atrule">preferences</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token key atrule">users</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> kubernetes<span class="token punctuation">-</span>admin						<span class="token comment">#\u8FD9\u91CC\u9700\u8981\u4FEE\u6539</span>
  <span class="token key atrule">user</span><span class="token punctuation">:</span>
    <span class="token key atrule">client-certificate-data</span><span class="token punctuation">:</span> LS0tLS1CRUdJTiBDRVJUSUZ<span class="token important">******</span>
    <span class="token key atrule">client-key-data</span><span class="token punctuation">:</span> LS0tLS1CRUdJTiBSU0E<span class="token important">******</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u4FEE\u6539kubeconfig" tabindex="-1"><a class="header-anchor" href="#\u4FEE\u6539kubeconfig" aria-hidden="true">#</a> \u4FEE\u6539kubeconfig</h4><p>\u4E24\u4EFD\u914D\u7F6E\u6587\u4EF6\u4E2D<code>context\u3001cluster\u3001users</code>\u540D\u79F0\u5FC5\u987B\u4E0D\u4E00\u6837\uFF08\u540C\u96C6\u7FA4\u8BBE\u7F6E\u4E0D\u540C\u73AF\u5883\u9664\u5916\uFF09\uFF0C\u5426\u5219\u8C03\u7528\u5C06\u4F1A\u51FA\u9519\uFF0C\u6240\u4EE5\u6211\u4EEC\u53EF\u4EE5\u9002\u5F53\u4FEE\u6539\u914D\u7F6E\u6587\u4EF6\u3002 <strong>\u5982\u4E0B\u662F\u7B2C\u4E00\u4EFDkubevirt\u96C6\u7FA4\u7684\uFF1A</strong></p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@k8s<span class="token punctuation">-</span>master<span class="token punctuation">:</span>~/.kube<span class="token punctuation">]</span> <span class="token comment"># cat  config-kubevirt </span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">clusters</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">cluster</span><span class="token punctuation">:</span>
    <span class="token key atrule">certificate-authority-data</span><span class="token punctuation">:</span> LS0tLS1CRUdJ<span class="token important">******</span>
    <span class="token key atrule">server</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//10.11.121.113<span class="token punctuation">:</span><span class="token number">6443</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> k8s<span class="token punctuation">-</span>kubevirt 
<span class="token key atrule">contexts</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">context</span><span class="token punctuation">:</span>
    <span class="token key atrule">cluster</span><span class="token punctuation">:</span> k8s<span class="token punctuation">-</span>kubevirt 
    <span class="token key atrule">user</span><span class="token punctuation">:</span> k8s<span class="token punctuation">-</span>kubevirt
  <span class="token key atrule">name</span><span class="token punctuation">:</span> k8s<span class="token punctuation">-</span>kubevirt 
<span class="token key atrule">current-context</span><span class="token punctuation">:</span> k8s<span class="token punctuation">-</span>kubevirt
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Config
<span class="token key atrule">preferences</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token key atrule">users</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> k8s<span class="token punctuation">-</span>kubevirt 
  <span class="token key atrule">user</span><span class="token punctuation">:</span>
    <span class="token key atrule">client-certificate-data</span><span class="token punctuation">:</span> LS0tLS1CRUdJTiBDRVJU<span class="token important">******</span>
    <span class="token key atrule">client-key-data</span><span class="token punctuation">:</span> LS0tLS1CRUdJTiBSU0EgUFJJ<span class="token important">******</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u5982\u4E0B\u662Fceph\u96C6\u7FA4\u7684\uFF1A</strong></p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@k8s<span class="token punctuation">-</span>master01 .kube<span class="token punctuation">]</span><span class="token comment"># cat config-ceph  </span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">clusters</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">cluster</span><span class="token punctuation">:</span>
    <span class="token key atrule">certificate-authority-data</span><span class="token punctuation">:</span> LS0tLS1CRUdJTiB<span class="token important">******</span>
    <span class="token key atrule">server</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//10.11.121.117<span class="token punctuation">:</span><span class="token number">6443</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> k8s<span class="token punctuation">-</span>ceph
<span class="token key atrule">contexts</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">context</span><span class="token punctuation">:</span>
    <span class="token key atrule">cluster</span><span class="token punctuation">:</span> k8s<span class="token punctuation">-</span>ceph 
    <span class="token key atrule">user</span><span class="token punctuation">:</span> k8s<span class="token punctuation">-</span>ceph 
  <span class="token key atrule">name</span><span class="token punctuation">:</span> k8s<span class="token punctuation">-</span>ceph 
<span class="token key atrule">current-context</span><span class="token punctuation">:</span> k8s<span class="token punctuation">-</span>ceph 
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Config
<span class="token key atrule">preferences</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token key atrule">users</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> k8s<span class="token punctuation">-</span>ceph 
  <span class="token key atrule">user</span><span class="token punctuation">:</span>
    <span class="token key atrule">client-certificate-data</span><span class="token punctuation">:</span> LS0tLS1CRUdJ<span class="token important">******</span>
    <span class="token key atrule">client-key-data</span><span class="token punctuation">:</span> LS0tLS1CRUdJTiBSU0<span class="token important">******</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u751F\u6210kubeconfig" tabindex="-1"><a class="header-anchor" href="#\u751F\u6210kubeconfig" aria-hidden="true">#</a> \u751F\u6210kubeconfig</h4><p>\u6267\u884C\u4EE5\u4E0B\u547D\u4EE4\u751F\u6210\u65B0\u7684config\u6587\u4EF6\u5373\u53EF</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@k8s<span class="token punctuation">-</span>master<span class="token punctuation">:</span>~/.kube<span class="token punctuation">]</span> <span class="token comment"># KUBECONFIG=config-ymt:config-jhmy kubectl config view --flatten &gt; $HOME/.kube/config</span>
<span class="token punctuation">[</span>root@k8s<span class="token punctuation">-</span>master<span class="token punctuation">:</span>~/.kube<span class="token punctuation">]</span> <span class="token comment"># kubectl config view </span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">clusters</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">cluster</span><span class="token punctuation">:</span>
    <span class="token key atrule">certificate-authority-data</span><span class="token punctuation">:</span> DATA+OMITTED
    <span class="token key atrule">server</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//10.11.121.117<span class="token punctuation">:</span><span class="token number">6443</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> k8s<span class="token punctuation">-</span>ceph
<span class="token punctuation">-</span> <span class="token key atrule">cluster</span><span class="token punctuation">:</span>
    <span class="token key atrule">certificate-authority-data</span><span class="token punctuation">:</span> DATA+OMITTED
    <span class="token key atrule">server</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//10.11.121.113<span class="token punctuation">:</span><span class="token number">6443</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> k8s<span class="token punctuation">-</span>kubevirt
<span class="token key atrule">contexts</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">context</span><span class="token punctuation">:</span>
    <span class="token key atrule">cluster</span><span class="token punctuation">:</span> k8s<span class="token punctuation">-</span>ceph
    <span class="token key atrule">user</span><span class="token punctuation">:</span> k8s<span class="token punctuation">-</span>ceph
  <span class="token key atrule">name</span><span class="token punctuation">:</span> k8s<span class="token punctuation">-</span>ceph
<span class="token punctuation">-</span> <span class="token key atrule">context</span><span class="token punctuation">:</span>
    <span class="token key atrule">cluster</span><span class="token punctuation">:</span> k8s<span class="token punctuation">-</span>kubevirt
    <span class="token key atrule">user</span><span class="token punctuation">:</span> k8s<span class="token punctuation">-</span>kubevirt
  <span class="token key atrule">name</span><span class="token punctuation">:</span> k8s<span class="token punctuation">-</span>kubevirt
<span class="token key atrule">current-context</span><span class="token punctuation">:</span> k8s<span class="token punctuation">-</span>ceph
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Config
<span class="token key atrule">preferences</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token key atrule">users</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> k8s<span class="token punctuation">-</span>ceph
  <span class="token key atrule">user</span><span class="token punctuation">:</span>
    <span class="token key atrule">client-certificate-data</span><span class="token punctuation">:</span> REDACTED
    <span class="token key atrule">client-key-data</span><span class="token punctuation">:</span> REDACTED
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> k8s<span class="token punctuation">-</span>kubevirt
  <span class="token key atrule">user</span><span class="token punctuation">:</span>
    <span class="token key atrule">client-certificate-data</span><span class="token punctuation">:</span> REDACTED
    <span class="token key atrule">client-key-data</span><span class="token punctuation">:</span> REDACTED
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u6D4B\u8BD5\u96C6\u7FA4\u5207\u6362" tabindex="-1"><a class="header-anchor" href="#\u6D4B\u8BD5\u96C6\u7FA4\u5207\u6362" aria-hidden="true">#</a> \u6D4B\u8BD5\u96C6\u7FA4\u5207\u6362</h4><p>\u8FD9\u91CC\u4F7F\u7528<code>\u4E0A\u4E0B\u6587\u7684\u65B9\u5F0F</code>\u5207\u6362kubernetes\u96C6\u7FA4\uFF0C\u67E5\u770B\u5F53\u524D\u7684\u96C6\u7FA4\u8282\u70B9\u5982\u4E0B\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@k8s-master:~/.kube<span class="token punctuation">]</span> <span class="token comment"># kubectl get node </span>
NAME         STATUS   ROLES                  AGE   VERSION
k8s-master   Ready    control-plane,master   9h    v1.22.1
k8s-node     Ready    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>                 9h    v1.22.1
<span class="token punctuation">[</span>root@k8s-master:~/.kube<span class="token punctuation">]</span> <span class="token comment"># kubectl config current-context </span>
k8s-kubevirt
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4F7F\u7528\u4E0A\u4E0B\u6587\u5207\u6362\u96C6\u7FA4\u5E76\u4E14\u67E5\u770B\u662F\u5426\u5DF2\u7ECF\u5207\u6362\u6210\u529F\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@k8s-master:~/.kube<span class="token punctuation">]</span> <span class="token comment"># kubectl config use-context k8s-ceph </span>
Switched to context <span class="token string">&quot;k8s-ceph&quot;</span><span class="token builtin class-name">.</span>
<span class="token punctuation">[</span>root@k8s-master:~/.kube<span class="token punctuation">]</span> <span class="token comment"># kubectl get node </span>
NAME           STATUS   ROLES                  AGE     VERSION
k8s-master01   Ready    control-plane,master   7h54m   v1.22.1
k8s-worker01   Ready    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>                 7h53m   v1.22.1
k8s-worker02   Ready    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>                 7h53m   v1.22.1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,25),c=[p];function l(i,u){return s(),a("div",null,c)}const r=n(t,[["render",l],["__file","19.Kubectl\u591A\u96C6\u7FA4\u914D\u7F6E.html.vue"]]);export{r as default};
