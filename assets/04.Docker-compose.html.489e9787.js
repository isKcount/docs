import{_ as t}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as i,c,a as s,b as n,d as l,f as a,r as o}from"./app.ca0279c0.js";const p={},u=a(`<h1 id="docker-compose" tabindex="-1"><a class="header-anchor" href="#docker-compose" aria-hidden="true">#</a> Docker-compose</h1><p><img src="https://pic.imgdb.cn/item/61ebfa652ab3f51d9120ff7b.png" alt="" loading="lazy"></p><h2 id="docker-compose\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#docker-compose\u662F\u4EC0\u4E48" aria-hidden="true">#</a> Docker Compose\u662F\u4EC0\u4E48</h2><ul><li><p>Docker Compose \u4E0E Docker Stack \u975E\u5E38\u7C7B\u4F3C\u3002<code>\u5B83\u80FD\u591F\u5728 Docker \u8282\u70B9\u4E0A\uFF0C\u4EE5\u5355\u5F15\u64CE\u6A21\u5F0F \uFF08Single-Engine Mode\uFF09\u8FDB\u884C\u591A\u5BB9\u5668\u5E94\u7528\u7684\u90E8\u7F72\u548C\u7BA1\u7406\u3002 </code></p></li><li><p>\u591A\u6570\u7684\u73B0\u4EE3\u5E94\u7528\u901A\u8FC7\u591A\u4E2A\u66F4\u5C0F\u7684\u670D\u52A1\u4E92\u76F8\u534F\u540C\u6765\u7EC4\u6210\u4E00\u4E2A\u5B8C\u6574\u53EF\u7528\u7684\u5E94\u7528\u3002\u6BD4\u5982\u4E00\u4E2A\u7B80\u5355\u7684 \u793A\u4F8B\u5E94\u7528\u53EF\u80FD\u7531\u5982\u4E0B 4 \u4E2A\u670D\u52A1\u7EC4\u6210</p><ul><li><code>Web \u524D\u7AEF\u3002</code></li><li><code>\u8BA2\u5355\u7BA1\u7406\u3002</code></li><li><code>\u54C1\u7C7B\u7BA1\u7406\u3002</code></li><li><code>\u540E\u53F0\u6570\u636E\u5E93\u3002</code></li></ul></li></ul><p>\u5C06\u4EE5\u4E0A\u670D\u52A1\u7EC4\u7EC7\u5728\u4E00\u8D77\uFF0C\u5C31\u662F\u4E00\u4E2A\u53EF\u7528\u7684\u5E94\u7528\u3002 \u90E8\u7F72\u548C\u7BA1\u7406\u7E41\u591A\u7684\u670D\u52A1\u662F\u56F0\u96BE\u7684\u3002<code>\u800C\u8FD9\u6B63\u662F Docker Compose \u8981\u89E3\u51B3\u7684\u95EE\u9898\u3002 Docker Compose \u5E76\u4E0D\u662F\u901A\u8FC7\u811A\u672C\u548C\u5404\u79CD\u5197\u957F\u7684 docker \u547D\u4EE4\u6765\u5C06\u5E94\u7528\u7EC4\u4EF6\u7EC4\u7EC7\u8D77\u6765\uFF0C\u800C\u662F \u901A\u8FC7\u4E00\u4E2A\u58F0\u660E\u5F0F\u7684\u914D\u7F6E\u6587\u4EF6\u63CF\u8FF0\u6574\u4E2A\u5E94\u7528\uFF0C\u4ECE\u800C\u4F7F\u7528\u4E00\u6761\u547D\u4EE4\u5B8C\u6210\u90E8\u7F72\u3002</code> \u5E94\u7528\u90E8\u7F72\u6210\u529F\u540E\uFF0C\u8FD8\u53EF\u4EE5\u901A\u8FC7\u4E00\u7CFB\u5217\u7B80\u5355\u7684\u547D\u4EE4\u5B9E\u73B0\u5BF9\u5176\u5B8C\u6574\u58F0\u660E\u5468\u671F\u7684\u7BA1\u7406\u3002\u751A\u81F3\uFF0C\u914D\u7F6E \u6587\u4EF6\u8FD8\u53EF\u4EE5\u7F6E\u4E8E\u7248\u672C\u63A7\u5236\u7CFB\u7EDF\u4E2D\u8FDB\u884C\u5B58\u50A8\u548C\u7BA1\u7406\u3002</p><h2 id="docker-compose-\u7684\u80CC\u666F" tabindex="-1"><a class="header-anchor" href="#docker-compose-\u7684\u80CC\u666F" aria-hidden="true">#</a> Docker Compose \u7684\u80CC\u666F</h2><p>Docker Compose \u7684\u524D\u8EAB\u662F Fig\u3002Fig \u662F\u4E00\u4E2A\u7531 Orchard \u516C\u53F8\u5F00\u53D1\u7684\u5F3A\u6709\u529B\u7684\u5DE5\u5177\uFF0C\u5728\u5F53\u65F6 \u662F\u8FDB\u884C\u591A\u5BB9\u5668\u7BA1\u7406\u7684\u6700\u4F73\u65B9\u6848\u3002<code>Fig \u662F\u4E00\u4E2A\u57FA\u4E8E Docker \u7684 Python \u5DE5\u5177\uFF0C\u5141\u8BB8\u7528\u6237\u57FA\u4E8E\u4E00 \u4E2A YAML \u6587\u4EF6\u5B9A\u4E49\u591A\u5BB9\u5668\u5E94\u7528\uFF0C\u4ECE\u800C\u53EF\u4EE5\u4F7F\u7528 fig \u547D\u4EE4\u884C\u5DE5\u5177\u8FDB\u884C\u5E94\u7528\u7684\u90E8\u7F72\u3002 Fig \u8FD8\u53EF\u4EE5\u5BF9\u5E94\u7528\u7684\u5168\u751F\u547D\u5468\u671F\u8FDB\u884C\u7BA1\u7406\u3002</code>\u5185\u90E8\u5B9E\u73B0\u4E0A\uFF0CFig \u4F1A\u89E3\u6790 YAML \u6587\u4EF6\uFF0C\u5E76\u901A\u8FC7 Docker API \u8FDB\u884C\u5E94\u7528\u7684\u90E8\u7F72\u548C\u7BA1\u7406\u3002\u5728 2014 \u5E74\uFF0CDocker \u516C\u53F8\u6536\u8D2D\u4E86 Orchard \u516C\u53F8\uFF0C\u5E76 \u5C06 Fig \u66F4\u540D\u4E3A Docker Compose\u3002\u547D\u4EE4\u884C\u5DE5\u5177\u4E5F\u4ECE fig \u66F4\u540D\u4E3A docker-compose\uFF0C\u5E76\u81EA\u6B64 \u6210\u4E3A\u7ED1\u5B9A\u5728 Docker \u5F15\u64CE\u4E4B\u4E0A\u7684\u5916\u90E8\u5DE5\u5177\u3002\u867D\u7136\u5B83\u4ECE\u672A\u5B8C\u5168\u96C6\u6210\u5230 Docker \u5F15\u64CE\u4E2D\uFF0C\u4F46\u662F \u4ECD\u7136\u53D7\u5230\u5E7F\u6CDB\u5173\u6CE8\u5E76\u5F97\u5230\u666E\u904D\u4F7F\u7528\u3002<code>\u76F4\u81F3\u4ECA\u65E5\uFF0CDocker Compose \u4ECD\u7136\u662F\u4E00\u4E2A\u9700\u8981\u5728 Docker \u4E3B\u673A\u4E0A\u8FDB\u884C\u5B89\u88C5\u7684\u5916\u90E8 Python \u5DE5\u5177\u3002\u4F7F\u7528\u5B83\u65F6\uFF0C\u9996\u5148\u7F16\u5199\u5B9A\u4E49\u591A\u5BB9\u5668\uFF08\u591A\u670D\u52A1\uFF09\u5E94\u7528\u7684 YAML \u6587\u4EF6\uFF0C\u7136\u540E\u5C06\u5176\u4EA4\u7531 docker-compose \u547D\u4EE4\u5904\u7406\uFF0CDocker Compose \u5C31\u4F1A\u57FA\u4E8E Docker \u5F15\u64CE API \u5B8C\u6210\u5E94\u7528\u7684\u90E8\u7F72\u3002</code></p><blockquote><p>\u5C0F\u603B\u7ED3\uFF1Adocker-compose \u5C31\u662F\u4E00\u4E2A\u7F16\u6392\u3002\u9700\u8981\u719F\u7EC3 yaml \u8BED\u6CD5\u3002</p></blockquote><h2 id="docker-compose\u5B89\u88C5" tabindex="-1"><a class="header-anchor" href="#docker-compose\u5B89\u88C5" aria-hidden="true">#</a> Docker Compose\u5B89\u88C5</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">curl</span> <span class="token parameter variable">-L</span> https://get.daocloud.io/docker/compose/releases/download/1.12.0/docker-compose-<span class="token variable"><span class="token variable">\`</span><span class="token function">uname</span> <span class="token parameter variable">-s</span><span class="token variable">\`</span></span>-<span class="token variable"><span class="token variable">\`</span><span class="token function">uname</span> <span class="token parameter variable">-m</span><span class="token variable">\`</span></span> <span class="token operator">&gt;</span> /usr/local/bin/docker-compose

$ <span class="token function">chmod</span> +x /usr/local/bin/docker-compose
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>\u5907\u6CE8\uFF1A docker-compose \u662F\u4E00\u4E2A\u57FA\u4E8E yaml \u8BED\u6CD5\u7684\u7F16\u6392 \u521B\u5EFA\u7684\u65F6\u5019\u5C31\u662F\u76F4\u63A5 vim docker-compose.yaml \u8BE5\u6587\u4EF6\u6267\u884C\u5FC5\u987B\u662F\u5728\u5F53\u524D\u6587\u4EF6\u5939\u5426\u5219\u9700\u8981\u52A0 -f</p></blockquote><h2 id="docker-compose\u5E38\u7528\u547D\u4EE4" tabindex="-1"><a class="header-anchor" href="#docker-compose\u5E38\u7528\u547D\u4EE4" aria-hidden="true">#</a> Docker Compose\u5E38\u7528\u547D\u4EE4</h2><h3 id="docker-compose-\u6307\u4EE4" tabindex="-1"><a class="header-anchor" href="#docker-compose-\u6307\u4EE4" aria-hidden="true">#</a> docker-compose \u6307\u4EE4</h3><blockquote><p>\u6A21\u677F\u6307\u4EE4: \u7528\u6765\u4E66\u5199\u5728 docker-compose.yml \u6587\u4EF6\u4E2D\u6307\u4EE4\u79F0\u4E4B\uFF0C\u4E3A\u6A21\u677F\u6307\u4EE4\u7528\u6765\u4E3A\u670D\u52A1\u8FDB\u884C \u670D\u52A1\u7684 \u6307\u4EE4: \u7528\u6765\u5BF9\u6574\u4E2A docker-compose.yml \u5BF9\u5E94\u7684\u8FD9\u4E2A\u9879\u76EE\u64CD\u4F5C\u4E66 \u5199 docker-compose \u547D \u4EE4\u4E4B\u540E\u547D\u4EE4 docker-compose up(\u6307\u4EE4)</p></blockquote><h3 id="_1-up-\u6307\u4EE4" tabindex="-1"><a class="header-anchor" href="#_1-up-\u6307\u4EE4" aria-hidden="true">#</a> 1.up \u6307\u4EE4</h3><p>\u4F5C\u7528:\u7528\u6765\u542F\u52A8\u6240\u6709</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">docker-compose</span> up 
\u9009\u9879:-d \u540E\u53F0\u542F\u52A8\u6240\u6709\u670D\u52A1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-down-\u6307\u4EE4" tabindex="-1"><a class="header-anchor" href="#_2-down-\u6307\u4EE4" aria-hidden="true">#</a> 2.down \u6307\u4EE4</h3><p>\u4F5C\u7528:<code>\u7528\u6765\u5173\u95ED\u6240\u6709 </code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">docker-compose</span> down 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_3-exec-\u6307\u4EE4" tabindex="-1"><a class="header-anchor" href="#_3-exec-\u6307\u4EE4" aria-hidden="true">#</a> 3.exec \u6307\u4EE4</h3><p>\u4F5C\u7528:<code>\u8FDB\u5165\u5BB9\u5668 </code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">docker-compose</span> <span class="token builtin class-name">exec</span> redis <span class="token punctuation">(</span>docker-compose.yml \u4E2D\u58F0\u660E\u670D\u52A1 <span class="token function">id</span><span class="token punctuation">)</span> <span class="token function">bash</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,23),d={id:"_4-ps-\u6307\u4EE4",tabindex:"-1"},r=s("a",{class:"header-anchor",href:"#_4-ps-\u6307\u4EE4","aria-hidden":"true"},"#",-1),k={href:"http://4.ps",target:"_blank",rel:"noopener noreferrer"},m=a(`<p>\u4F5C\u7528:<code>\u7528\u6765\u5C55\u793A\u5F53\u524D </code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ docker-conpose \u8FD0\u884C\u7684\u6240\u6709\u5BB9\u5668 <span class="token function">docker-compose</span> <span class="token function">ps</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_5-restart-\u6307\u4EE4" tabindex="-1"><a class="header-anchor" href="#_5-restart-\u6307\u4EE4" aria-hidden="true">#</a> 5.restart \u6307\u4EE4</h3><p>\u4F5C\u7528:<code>\u7528\u6765\u91CD\u542F\u9879\u76EE\u4E2D\u67D0\u4E2A\u670D\u52A1 \u5982\u679C\u4E0D\u5199\u670D\u52A1 id \u9ED8\u8BA4\u91CD\u542F\u6240\u6709\u670D\u52A1 </code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">docker-compose</span> restart <span class="token punctuation">[</span>\u670D\u52A1 id<span class="token punctuation">]</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_6-rm-\u6307\u4EE4" tabindex="-1"><a class="header-anchor" href="#_6-rm-\u6307\u4EE4" aria-hidden="true">#</a> 6.rm \u6307\u4EE4</h3><p>\u4F5C\u7528:<code>\u7528\u6765\u5220\u9664\u9879\u76EE\u670D\u52A1 </code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">docker-compose</span> <span class="token function">rm</span> \u5220\u9664\u6240\u6709\u670D\u52A1 
$ <span class="token function">docker-compose</span> <span class="token function">rm</span> <span class="token parameter variable">-fv</span> <span class="token punctuation">[</span>\u670D\u52A1 id<span class="token punctuation">]</span>\u6CE8\u610F:\u8C28\u614E\u64CD\u4F5C <span class="token parameter variable">-v</span> \u5220\u9664\u670D\u52A1\u7684\u6570\u636E\u5377 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-start-\u6307\u4EE4" tabindex="-1"><a class="header-anchor" href="#_7-start-\u6307\u4EE4" aria-hidden="true">#</a> 7.start \u6307\u4EE4</h3><p>\u542F\u52A8\u670D\u52A1</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">docker-compose</span> start <span class="token punctuation">[</span>\u670D\u52A1 id<span class="token punctuation">]</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_8-stop-\u6307\u4EE4" tabindex="-1"><a class="header-anchor" href="#_8-stop-\u6307\u4EE4" aria-hidden="true">#</a> 8.stop \u6307\u4EE4</h3><p>\u5173\u95ED\u670D\u52A1</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">docker-compose</span> stop <span class="token punctuation">[</span>\u670D\u52A1 id<span class="token punctuation">]</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_9-top-\u6307\u4EE4" tabindex="-1"><a class="header-anchor" href="#_9-top-\u6307\u4EE4" aria-hidden="true">#</a> 9.top \u6307\u4EE4</h3><p>\u7528\u6765\u67E5\u770B compose \u5BB9\u5668\u5185\u8FD0\u884C\u7684\u8FDB\u7A0B</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">docker-compose</span> <span class="token function">top</span> <span class="token punctuation">[</span>\u670D\u52A1 id<span class="token punctuation">]</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_10-pause-\u6307\u4EE4" tabindex="-1"><a class="header-anchor" href="#_10-pause-\u6307\u4EE4" aria-hidden="true">#</a> 10.pause \u6307\u4EE4</h3><p>\u6302\u8D77\u670D\u52A1</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">docker-compose</span> pause <span class="token punctuation">[</span>\u670D\u52A1 id<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_11-unpause-\u6307\u4EE4" tabindex="-1"><a class="header-anchor" href="#_11-unpause-\u6307\u4EE4" aria-hidden="true">#</a> 11.unpause \u6307\u4EE4</h3><p>\u7EE7\u7EED\u8FD0\u884C\u670D\u52A1</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">docker-compose</span> unpause <span class="token punctuation">[</span>\u670D\u52A1 id<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_12-logs-\u6307\u4EE4" tabindex="-1"><a class="header-anchor" href="#_12-logs-\u6307\u4EE4" aria-hidden="true">#</a> 12.logs \u6307\u4EE4</h3><p>\u67E5\u770B\u670D\u52A1\u65E5\u5FD7</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ docker- compose logs <span class="token punctuation">[</span>\u670D\u52A1 id<span class="token punctuation">]</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5176\u4ED6\u6307\u4EE4 port\uFF1A\u6253\u5370\u7ED1\u5B9A\u7684\u516C\u5171\u7AEF\u53E3\uFF0C\u4E0B\u9762\u547D\u4EE4\u53EF\u4EE5\u8F93\u51FA eureka \u670D\u52A1 8761 \u7AEF\u53E3\u6240\u7ED1\u5B9A \u7684\u516C\u5171\u7AEF\u53E3</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">docker-compose</span> port eureka <span class="token number">8761</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>build\uFF1A<code>\u6784\u5EFA\u6216\u8005\u91CD\u65B0\u6784\u5EFA\u670D\u52A1</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">docker-compose</span> build 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>kill\uFF1A\u901A\u8FC7\u53D1\u9001 SIGKILL \u4FE1\u53F7\u6765\u505C\u6B62\u6307\u5B9A\u670D\u52A1\u7684\u5BB9\u5668</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">docker-compose</span> <span class="token function">kill</span> eureka 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>config\uFF1A\u9A8C\u8BC1 Compose \u6587\u4EF6\u683C\u5F0F\u662F\u5426\u6B63\u786E\uFF0C\u82E5\u6B63\u786E\u5219\u663E\u793A\u914D\u7F6E\uFF0C\u82E5\u683C\u5F0F\u9519\u8BEF\u663E \u793A\u9519\u8BEF\u539F\u56E0 -h\uFF1A</p></blockquote><h3 id="\u67E5\u770B\u5E2E\u52A9" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770B\u5E2E\u52A9" aria-hidden="true">#</a> \u67E5\u770B\u5E2E\u52A9</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">docker-compose</span> pull <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token punctuation">[</span>SERVICE<span class="token punctuation">..</span>.<span class="token punctuation">]</span> \u9009\u9879\u5305\u62EC\uFF1A
  --ignore-pull-failures\uFF0C      \u5FFD\u7565\u62C9\u53D6\u955C\u50CF\u8FC7\u7A0B\u4E2D\u7684\u9519\u8BEF
  --parallel\uFF0C			\u591A\u4E2A\u955C\u50CF\u540C\u65F6\u62C9\u53D6
  --quiet\uFF0C			\u62C9\u53D6\u955C\u50CF\u8FC7\u7A0B\u4E2D\u4E0D\u6253\u5370\u8FDB\u5EA6\u4FE1\u606F
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u62C9\u53D6\u670D\u52A1\u4F9D\u8D56\u7684\u955C\u50CF</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">docker-compose</span> pull
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="docker-compose-\u6A21\u677F\u6307\u4EE4" tabindex="-1"><a class="header-anchor" href="#docker-compose-\u6A21\u677F\u6307\u4EE4" aria-hidden="true">#</a> Docker-compose \u6A21\u677F\u6307\u4EE4</h2><h3 id="\u67E5\u770B\u7B2C\u4E00\u4E2A\u6A21\u677F" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770B\u7B2C\u4E00\u4E2A\u6A21\u677F" aria-hidden="true">#</a> \u67E5\u770B\u7B2C\u4E00\u4E2A\u6A21\u677F</h3><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&quot;3.2&quot;</span> 
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">tomcat</span><span class="token punctuation">:</span> 					  			<span class="token comment">#\u670D\u52A1\u540D\u79F0</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> tomcat<span class="token punctuation">:</span>8.0<span class="token punctuation">-</span>jre8 			    <span class="token comment">#\u4F7F\u7528\u54EA\u4E2A\u955C\u50CF</span>
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>    				     	    <span class="token comment">#\u7528\u6765\u5B8C\u6210host\u4E0E\u5BB9\u5668\u7684\u7AEF\u53E3\u6620\u5C04\u5173\u7CFB</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;8080:8080&quot;</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span> 					  		<span class="token comment">#\u5B8C\u6210\u5BBF\u4E3B\u673A\u4E0E\u5BB9\u5668\u4E2D\u76EE\u5F55\u6570\u636E\u5377\u5171\u4EAB</span>
      <span class="token comment">#\u4E00/root/apps:/usr/local/tomcat/webapps      #\u4F7F\u7528\u81EA\u5B9A\u4E49\u8DEF\u5F84\u6620\u5C04</span>
      <span class="token punctuation">-</span> tomcatwebapps<span class="token punctuation">:</span>/usr/local/tomcat/webapps
<span class="token key atrule">volumes</span><span class="token punctuation">:</span>    					   		<span class="token comment">#\u58F0\u660E\u4E0A\u9762\u670D\u52A1\u6240\u4F7F\u7528\u7684\u81EA\u52A8\u521B\u5EFA\u7684\u5377\u540D</span>
  <span class="token key atrule">tomcatwebapps</span><span class="token punctuation">:</span>				   		<span class="token comment">#\u58F0\u660E\u6307\u4EE4\u7684\u5377\u540Dcompose \u81EA\u52A8\u521B\u5EFA\u8BE5\u5377\u540D\u4F46\u662F\u4F1A\u5728\u4E4B\u524D\u52A0\u5165\u9879\u76EE\u540D</span>
    <span class="token key atrule">external</span><span class="token punctuation">:</span>					   		<span class="token comment">#\u4F7F\u7528\u81EA\u5B9A\u4E49\u5377\u540D.</span>
      false					   			<span class="token comment">#true\u786E\u5B9A\u4F7F\u7528\u6307\u5B9A\u5377\u540D\u6CE8\u610F:\u4E00 \u65E6\u4F7F\u7528\u5916\u90E8\u81EA\u5B9A\u4E49\u5377 \u540D\u542F\u52A8\u670D\u52A1\u4E4B\u524D\u5FC5\u987B\u624B\u52A8\u521B\u5EFA</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u67E5\u770B\u7B2C\u4E8C\u4E2A\u6A21\u677F" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770B\u7B2C\u4E8C\u4E2A\u6A21\u677F" aria-hidden="true">#</a> \u67E5\u770B\u7B2C\u4E8C\u4E2A\u6A21\u677F</h3><p>\u7B2C\u4E8C\u4E2A\u6A21\u677F\u662F\u4F7F\u7528docker-compose\u90E8\u7F72\u591A\u4E2A\u5E94\u7528\u7684\u7F16\u6392\uFF0C<code>docker-compose \u90E8\u7F72\u591A\u5E94\u7528</code></p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">services</span> <span class="token punctuation">:</span>
<span class="token key atrule">tomcat01</span><span class="token punctuation">:</span>    					<span class="token comment">#\u670D\u52A1\u540D\u79F0</span>
  <span class="token key atrule">container_nane</span><span class="token punctuation">:</span> tomcat01 		<span class="token comment">#\u76F8\u5F53\u4E8Erun\u7684 --name</span>
  <span class="token key atrule">image</span><span class="token punctuation">:</span> tomcat<span class="token punctuation">:</span>8.0<span class="token punctuation">-</span>jre8 		<span class="token comment">#\u4F7F\u7528\u54EA\u4E2A\u955C\u50CF\u76F8\u5F53\u4E8Erun image</span>
  <span class="token key atrule">ports</span><span class="token punctuation">:</span> 						<span class="token comment">#\u7528\u6765\u5B8C\u6210host\u4E0E\u5BB9\u5668\u7684\u7AEF\u53E3\u6620\u5C04\u5173\u7CFB  \u76F8\u5F53\u4E8Erun -P</span>
    <span class="token punctuation">-</span> <span class="token string">&quot;8080:8080&quot;</span>
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span> 						<span class="token comment">#\u5B8C\u6210\u5BBF\u4E3B\u673A\u4E0E\u5BB9\u5668\u4E2D\u76EE\u5F55\u6570\u636E\u5377\u5171\u4EAB\u76F8\u5F53 \u4E8Erun -v</span>
    <span class="token comment">#- /root/apps:/usr/1ocal/tomcat/webapps 	#\u4F7F\u7528\u81EA\u5B9A\u4E49\u8DEF\u5F84\u6620\u5C04</span>
    <span class="token punctuation">-</span> /root/apps<span class="token punctuation">:</span>/usr/local/tomcat/webapps
  <span class="token key atrule">networks</span><span class="token punctuation">:</span>   				 	<span class="token comment">#\u4EE3\u8868\u5F53\u524D\u670D\u52A1\u4F7F\u7528\u54EA\u4E2A\u7F51\u7EDC\u6865  \u76F8\u5F53\u4E8Erun --network</span>
    <span class="token punctuation">-</span> hello
<span class="token key atrule">tomcat02</span><span class="token punctuation">:</span>  						<span class="token comment">#\u670D\u52A1\u540D\u79F0</span>
  <span class="token key atrule">container_name</span><span class="token punctuation">:</span> tomcat02
  <span class="token key atrule">image</span><span class="token punctuation">:</span> tomcat<span class="token punctuation">:</span>8.0<span class="token punctuation">-</span>jre8 		<span class="token comment">#\u4F7F\u7528\u54EA\u4E2A\u955C\u50CF</span>
  <span class="token key atrule">ports</span><span class="token punctuation">:</span> 						<span class="token comment">#\u7528\u6765\u5B8C\u6210host\u4E0E\u5BB9\u5668\u7684\u7AEF\u53E3\u6620\u5C04\u5173\u7CFB</span>
    <span class="token punctuation">-</span> <span class="token string">&quot;8081:8080&quot;</span>
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span> 						<span class="token comment">#\u5B8C\u6210\u5BBF\u4E3B\u673A\u4E0E\u5BB9\u5668\u4E2D\u76EE\u5F55\u6570\u636E\u5377\u5171\u4EAB</span>
    <span class="token comment">#- /root/apps:/usr/local/tomcat/webapps #\u4F7F\u7528\u81EA\u5B9A\u4E49\u8DEF\u5F84\u6620\u5C04</span>
    <span class="token punctuation">-</span> tomcatwebapps02<span class="token punctuation">:</span>/usr/local/tomcat/webapps
  <span class="token key atrule">networks</span><span class="token punctuation">:</span> 					<span class="token comment">#\u4EE3\u8868\u5F53\u524D\u670D\u52A1\u4F7F\u7528\u54EA\u4E2A\u7F51\u7EDC\u6865</span>
    <span class="token punctuation">-</span> hello
<span class="token key atrule">mysql</span><span class="token punctuation">:</span>
  <span class="token key atrule">image</span><span class="token punctuation">:</span> mysql<span class="token punctuation">:</span>5.7.32
  <span class="token key atrule">container_name</span><span class="token punctuation">:</span> mysql
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token string">&quot;3307:3306&quot;</span>
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> mysqldata<span class="token punctuation">:</span>/var/lib/mysql
    <span class="token punctuation">-</span> mysqlconf<span class="token punctuation">:</span>/etc/mysql
  <span class="token key atrule">environnent</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> MYSQL_ROOT_PASSWORD=root
  <span class="token key atrule">networks</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> hello
<span class="token key atrule">redis</span><span class="token punctuation">:</span>
  <span class="token key atrule">image</span><span class="token punctuation">:</span> redis<span class="token punctuation">:</span>5.0.10
  <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token string">&quot;6379:6379&quot;</span>
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> redisdata<span class="token punctuation">:</span>/data
  <span class="token key atrule">networks</span><span class="token punctuation">:</span> 
    <span class="token punctuation">-</span> hello
  <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token string">&quot;redis-server --appendonly yes&quot;</span>	 <span class="token comment">#run\u955C\u50CF\u4E4B\u540E\u7528\u6765\u734D\u76D6\u5BB9\u5668\u5185\u5BB9\u9ED8\u8BA4\u547D\u4EE4</span>
<span class="token key atrule">volumes</span><span class="token punctuation">:</span>					<span class="token comment">#\u58F0\u660E\u4E0A\u9762\u670D\u52A1\u6240\u4F7F\u7528\u7684\u81EA\u52A8\u521B\u5EFA\u7684\u5377\u540D</span>
  <span class="token key atrule">tomcatwebapps01</span><span class="token punctuation">:</span>				<span class="token comment">#\u58F0\u660E\u6307\u4EE4\u7684\u5377\u540Dcompose\u81EA\u52A8\u521B\u5EFA\u8BE5\u5377\u540D\u4F46\u662F\u4F1A\u5728\u4E4B\u524D\u52A0\u5165\u9879\u76EE\u540D</span>
    <span class="token key atrule">external</span><span class="token punctuation">:</span>					<span class="token comment">#\u4F7F\u7528\u81EA\u5B9A\u4E49\u5377\u540D\uFF0C</span>
      false					<span class="token comment">#true\u786E\u5B9A\u4F7F\u7528\u6307\u5B9A\u5377\u540D 	\u6CE8\u610F:\u4E00\u65E6\u4F7F\u7528\u5916\u90E8\u81EA\u5B9A\u4E49\u5377\u540D\u542F\u52A8\u670D\u52A1\u4E4B\u524D\u5FC5\u987B\u624B\u52A8\u521B\u5EFA</span>
  <span class="token key atrule">tomcatwebapps02</span><span class="token punctuation">:</span>
  <span class="token key atrule">mysqldata</span><span class="token punctuation">:</span>
  <span class="token key atrule">mysqlconf</span><span class="token punctuation">:</span>
  <span class="token key atrule">redisdata</span><span class="token punctuation">:</span>
<span class="token key atrule">networks</span><span class="token punctuation">:</span>					<span class="token comment">#\u5B9A\u4E49\u670D\u52A1\u7528\u5230\u6865</span>
  <span class="token key atrule">hello</span><span class="token punctuation">:</span>   					<span class="token comment">#\u5B9A\u4E49\u4E0A\u9762\u7684\u670D\u52A1\u7528\u5230\u7684\u7F51\u6865\u540D\u79F0\u9ED8\u8BA4\u521B\u5EFA\u5C31\u662Fbridge</span>
    <span class="token key atrule">external</span><span class="token punctuation">:</span>
      <span class="token boolean important">true</span>					<span class="token comment">#\u4F7F\u7528\u5916\u90E8\u6307\u5B9A\u7F51\u6865\u6CE8\u610F:\u7F51\u6865\u5FC5\u987B\u5B58\u5728.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="docker-compose\u6A21\u677F\u6307\u4EE4\u8BE6\u89E3" tabindex="-1"><a class="header-anchor" href="#docker-compose\u6A21\u677F\u6307\u4EE4\u8BE6\u89E3" aria-hidden="true">#</a> Docker-compose\u6A21\u677F\u6307\u4EE4\u8BE6\u89E3</h2><h3 id="build" tabindex="-1"><a class="header-anchor" href="#build" aria-hidden="true">#</a> build</h3><p><code>\u6784\u5EFA\u6216\u8005\u91CD\u65B0\u6784\u5EFA\u670D\u52A1</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker-compose</span> build
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="container-name" tabindex="-1"><a class="header-anchor" href="#container-name" aria-hidden="true">#</a> container_name</h3><p>\u6307\u5B9A\u5BB9\u5668\u540D\u79F0 \u9ED8\u8BA4\u4F1A\u5C06\u4F7F\u7528</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>container_name: docker-web-container
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="comand" tabindex="-1"><a class="header-anchor" href="#comand" aria-hidden="true">#</a> comand</h3><p>\u8986\u76D6\u5BB9\u5668\u542F\u52A8\u540E\u9ED8\u8BA4\u6267\u884C\u7684\u547D\u4EE4</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>command: <span class="token builtin class-name">echo</span> <span class="token string">&quot;hello world&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="depends-on" tabindex="-1"><a class="header-anchor" href="#depends-on" aria-hidden="true">#</a> depends_on</h3><p><code>\u89E3\u51B3\u5BB9\u5668\u7684\u4F9D\u8D56</code> \u542F\u52A8\u5148\u540E\u7684\u95EE\u9898 \u4EE5\u4E0B\u5148\u542F\u52A8redis db \u518D\u542F\u52A8web</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&quot;3.0&quot;</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">web</span><span class="token punctuation">:</span>
    <span class="token key atrule">build</span><span class="token punctuation">:</span> .
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>            <span class="token comment">#\u4F46\u662Fweb\u670D\u52A1\u4E0D\u4F1A\u7B49\u5F85redis  db\u5B8C\u5168\u542F\u52A8\u4E4B\u540E\u518D\u542F\u52A8</span>
     <span class="token punctuation">-</span> db  (\u670D\u52A1\u7684ID\u540D\u79F0)
     <span class="token punctuation">-</span> redis
  <span class="token key atrule">redis</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis
  <span class="token key atrule">db</span><span class="token punctuation">:</span> 
    <span class="token key atrule">image</span><span class="token punctuation">:</span> mysql<span class="token punctuation">:</span><span class="token number">5.6</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="env-file" tabindex="-1"><a class="header-anchor" href="#env-file" aria-hidden="true">#</a> env_file</h3><p>\u4ECE\u6587\u4EF6\u4E2D\u83B7\u53D6\u53D8\u91CF \u53EF\u4EE5\u4E3A\u5355\u72EC\u7684\u6587\u4EF6\u8DEF\u5F84\u6216\u8005\u5217\u8868 \u5982\u679Cdocker-compose -f FILE \u65B9\u5F0F\u6765\u6307\u5B9ACompose\u6A21\u677F\u6587\u4EF6 \u5219env_file\u4E2D\u53D8\u91CF\u7684\u8DEF\u5F84\u4F1A\u57FA\u4E8E\u6A21\u677F\u6587\u4EF6\u8DEF\u5F84</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">env_file</span><span class="token punctuation">:</span> .env

<span class="token key atrule">env_file</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> ./common.env
  <span class="token punctuation">-</span> ./apps/web.env
  <span class="token punctuation">-</span> /opt/secrets.env
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="environment" tabindex="-1"><a class="header-anchor" href="#environment" aria-hidden="true">#</a> environment</h3><p>\u8BBE\u7F6E\u73AF\u5883\u53D8\u91CF <code>\u53EF\u4EE5\u4F7F\u7528\u6570\u7EC4\u548C\u5B57\u5178\u4E24\u79CD\u683C\u5F0F</code> \u53EA\u7ED9\u5B9A\u540D\u79F0\u7684\u53D8\u91CF\u4F1A\u81EA\u52A8\u83B7\u53D6\u8FD0\u884Ccompose\u4E3B\u673A\u4E0A\u5BF9\u5E94\u7684\u53D8\u91CF</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">environment</span><span class="token punctuation">:</span>
  <span class="token key atrule">RACK_ENV</span><span class="token punctuation">:</span> development
  <span class="token key atrule">SESSION_SECRET</span><span class="token punctuation">:</span>
  
 <span class="token key atrule">environment</span><span class="token punctuation">:</span>
   <span class="token punctuation">-</span> PACK_ENV=development
   <span class="token punctuation">-</span> SESSION_SECRET
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="image" tabindex="-1"><a class="header-anchor" href="#image" aria-hidden="true">#</a> image</h3><p>\u6307\u5B9A\u955C\u50CF\u7684\u540D\u79F0\u6216\u8005ID \u672C\u5730\u4E0D\u5B58\u5728\u4F1A\u5C1D\u8BD5\u62C9\u53D6</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">image</span><span class="token punctuation">:</span> centos
<span class="token key atrule">image</span><span class="token punctuation">:</span> orcharup/centos 
<span class="token key atrule">image</span><span class="token punctuation">:</span> a1s2df3a
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ports" tabindex="-1"><a class="header-anchor" href="#ports" aria-hidden="true">#</a> ports</h3><p>\u66B4\u9732\u7AEF\u53E3\u4FE1\u606F \u5BBF\u4E3B\u673A\u7AEF\u53E3\uFF1A\u5BB9\u5668\u7AEF\u53E3\u6620\u5C04</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token string">&quot;3000&quot;</span>
  <span class="token punctuation">-</span> <span class="token string">&quot;8080:8080&quot;</span>
  <span class="token punctuation">-</span> <span class="token string">&quot;49100:22&quot;</span>
  <span class="token punctuation">-</span> <span class="token string">&quot;127.0.0.1:8080:8080&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="volumes" tabindex="-1"><a class="header-anchor" href="#volumes" aria-hidden="true">#</a> volumes</h3><p>\u6570\u636E\u5377\u6240\u6302\u8F7D\u8DEF\u5F84\u8BBE\u7F6E \u53EF\u4EE5\u8BBE\u7F6E\u5BBF\u4E3B\u673A\u8DEF\u5F84 \u6570\u636E\u5377\u540D\u79F0 \u5E76\u53EF\u4EE5\u8BBE\u7F6E\u8BBF\u95EE\u6A21\u5F0F</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">volumes</span><span class="token punctuation">:</span>
 <span class="token punctuation">-</span> /var/lib/mysql
 <span class="token punctuation">-</span> cache/<span class="token punctuation">:</span>/tmp/apache
 <span class="token punctuation">-</span> ~/configs<span class="token punctuation">:</span>/etc/configs/<span class="token punctuation">:</span>ro
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5982\u679C\u8DEF\u5F84\u4E3A\u6570\u636E\u5377\u540D\u79F0 <code>\u5FC5\u987B\u5728\u6587\u4EF6\u4E2D\u914D\u7F6E\u6570\u636E\u5377</code></p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&quot;3.0&quot;</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">tomcat</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> tomcat<span class="token punctuation">:</span>8.0<span class="token punctuation">-</span>jre8
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;8080:8080&quot;</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> mysql_data<span class="token punctuation">:</span>/var/lib/mysql
<span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  <span class="token key atrule">mysql_data</span><span class="token punctuation">:</span>
    <span class="token key atrule">external</span><span class="token punctuation">:</span>
      <span class="token boolean important">false</span>
 <span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span><span class="token punctuation">---</span>
<span class="token comment">#\u5982\u679C\u662F\u81EA\u5B9A\u4E49\u521B\u5EFA\u7684volumes\u5C31\u5982\u4E0B</span>
<span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  <span class="token key atrule">mysql_data</span><span class="token punctuation">:</span>
    <span class="token key atrule">external</span><span class="token punctuation">:</span>
      <span class="token boolean important">true</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="network" tabindex="-1"><a class="header-anchor" href="#network" aria-hidden="true">#</a> network</h3><p>\u914D\u7F6E\u5BB9\u5668\u8FDE\u63A5\u7684\u7F51\u7EDC</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&quot;3&quot;</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>

    <span class="token key atrule">some-service</span><span class="token punctuation">:</span>
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> some<span class="token punctuation">-</span>network
      <span class="token punctuation">-</span> other<span class="token punctuation">-</span>network
<span class="token key atrule">networks</span><span class="token punctuation">:</span>
  <span class="token key atrule">some-network</span><span class="token punctuation">:</span>
  <span class="token key atrule">other-network</span><span class="token punctuation">:</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="healtheck" tabindex="-1"><a class="header-anchor" href="#healtheck" aria-hidden="true">#</a> healtheck</h3><p>\u901A\u8FC7\u547D\u4EE4\u68C0\u67E5\u5BB9\u5668\u662F\u5426\u5065\u5EB7\u8FD0\u884C</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">healthcheck</span><span class="token punctuation">:</span>
  <span class="token key atrule">test</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;CMD&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;curl&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;-f&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;http://localhost&quot;</span><span class="token punctuation">]</span>
  <span class="token key atrule">interval</span><span class="token punctuation">:</span> 1m30s
  <span class="token key atrule">timeout</span><span class="token punctuation">:</span> 10s 
  <span class="token key atrule">retries</span><span class="token punctuation">:</span> <span class="token number">3</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="sysctls" tabindex="-1"><a class="header-anchor" href="#sysctls" aria-hidden="true">#</a> sysctls</h3><p>\u914D\u7F6E\u5BB9\u5668\u7684\u5185\u6838\u53C2\u6570</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">sysctls</span><span class="token punctuation">:</span>
  <span class="token key atrule">net.core.somaxconn</span><span class="token punctuation">:</span> <span class="token number">1024</span>
  <span class="token key atrule">net.ipv4.tcp_syncookies</span><span class="token punctuation">:</span> <span class="token number">0</span>

<span class="token key atrule">sysctls</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> net.core.somaxconn=1024
  <span class="token punctuation">-</span> net.ipv4.tcp_syncookies=0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ulimits" tabindex="-1"><a class="header-anchor" href="#ulimits" aria-hidden="true">#</a> ulimits</h3><p>\u6307\u5B9A\u5BB9\u5668\u7684ulimits\u9650\u5236\u503C</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">ulimits</span><span class="token punctuation">:</span>
  <span class="token key atrule">nproc</span><span class="token punctuation">:</span> <span class="token number">65535</span>
  <span class="token key atrule">nofile</span><span class="token punctuation">:</span>
    <span class="token key atrule">soft</span><span class="token punctuation">:</span> <span class="token number">20000</span>
    <span class="token key atrule">hard</span><span class="token punctuation">:</span> <span class="token number">40000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="compose\u7684build\u6307\u4EE4" tabindex="-1"><a class="header-anchor" href="#compose\u7684build\u6307\u4EE4" aria-hidden="true">#</a> compose\u7684build\u6307\u4EE4</h3><p>build \u6307\u4EE4 \u4F5C\u7528\uFF1A\u5C06\u6307\u5B9A\u7684dockefile\u6253\u5305\u6210\u6307\u5BF9\u5E94\u955C\u50CF\uFF0C\u7136\u540E\u8FD0\u884C\u8BE5\u955C\u50CF</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">web</span><span class="token punctuation">:</span>
   <span class="token key atrule">build</span><span class="token punctuation">:</span> \u6307\u5B9ADockerfile\u6240\u5728\u76EE\u5F55\uFF0C\u5148\u6839\u636Ebuild\u4E2D\u7684dockerfile\u81EA\u52A8\u6784\u6210\u955C\u50CF\uFF0C\u81EA\u52A8\u8FD0\u884C\u5BB9\u5668
     <span class="token key atrule">context</span><span class="token punctuation">:</span> demo   ./demo   /root/demo\u6307\u5B9A\u4E0A\u4E0B\u6587\u76EE\u5F55  Dockerfile\u6240\u5728\u76EE\u5F55 
     <span class="token key atrule">dockerfile</span><span class="token punctuation">:</span> Dockerfile
   <span class="token key atrule">container_name</span><span class="token punctuation">:</span> demo
   <span class="token key atrule">ports</span><span class="token punctuation">:</span>
     <span class="token punctuation">-</span> <span class="token string">&quot;8081:8081&quot;</span>
   <span class="token key atrule">networks</span><span class="token punctuation">:</span>
     <span class="token punctuation">-</span> hello  
   <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
     <span class="token punctuation">-</span> tomcat01
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u5916\u90E8\u547D\u4EE4" tabindex="-1"><a class="header-anchor" href="#\u5916\u90E8\u547D\u4EE4" aria-hidden="true">#</a> \u5916\u90E8\u547D\u4EE4</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token string">&#39;\u521B\u5EFA\u5377&#39;</span>
$ <span class="token function">docker</span> volume create  tomcatwebapps01 
 
<span class="token string">&#39;\u67E5\u770B\u5377&#39;</span>
$ <span class="token function">docker</span> volume <span class="token function">ls</span> 
 
<span class="token string">&#39;\u521B\u5EFA\u7F51\u6865&#39;</span>
$ <span class="token function">docker</span> network  create bridge hello  
 
<span class="token string">&#39;\u67E5\u770B\u7F51\u6865&#39;</span> 
$ <span class="token function">docker</span> network <span class="token function">ls</span> 
 
<span class="token string">&#39;\u67E5\u770B\u5BB9\u5668\u4FE1\u606F&#39;</span> 
$ <span class="token function">docker</span> inspect \u5BB9\u5668\u540D 
 
<span class="token string">&#39;\u5982\u679C\u8981\u4F7F\u7528\u81EA\u5B9A\u4E49\u5377\u540D\u5C31\u8981\u624B\u52A8\u521B\u5EFA\u5377\u540D&#39;</span> 
$ <span class="token function">docker</span> volume create \u5377\u540D 
 
<span class="token string">&#39;\u5982\u679C\u8981\u4F7F\u7528\u81EA\u5B9A\u4E49\u7F51\u6865\u5C31\u8981\u624B\u52A8\u521B\u5EFA\u6865&#39;</span> 
$ <span class="token function">docker</span> network create <span class="token parameter variable">-d</span> bridge \u6865\u540D
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,90);function v(b,h){const e=o("ExternalLinkIcon");return i(),c("div",null,[u,s("h3",d,[r,n(),s("a",k,[n("4.ps"),l(e)]),n(" \u6307\u4EE4")]),m])}const f=t(p,[["render",v],["__file","04.Docker-compose.html.vue"]]);export{f as default};
