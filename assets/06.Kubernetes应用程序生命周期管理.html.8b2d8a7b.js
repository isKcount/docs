import{_ as l}from"./_plugin-vue_export-helper.cdc0426e.js";import{o,c as i,a as n,b as s,d as a,f as t,r as c}from"./app.ca0279c0.js";const p={},r=t(`<h1 id="kubernetes\u5E94\u7528\u7A0B\u5E8F\u751F\u547D\u5468\u671F\u7BA1\u7406" tabindex="-1"><a class="header-anchor" href="#kubernetes\u5E94\u7528\u7A0B\u5E8F\u751F\u547D\u5468\u671F\u7BA1\u7406" aria-hidden="true">#</a> Kubernetes\u5E94\u7528\u7A0B\u5E8F\u751F\u547D\u5468\u671F\u7BA1\u7406</h1><h2 id="\u5E94\u7528\u7A0B\u5E8F\u751F\u547D\u5468\u671F\u7BA1\u7406" tabindex="-1"><a class="header-anchor" href="#\u5E94\u7528\u7A0B\u5E8F\u751F\u547D\u5468\u671F\u7BA1\u7406" aria-hidden="true">#</a> \u5E94\u7528\u7A0B\u5E8F\u751F\u547D\u5468\u671F\u7BA1\u7406</h2><p><strong>\u5728Kubernetes\u4E2D\u90E8\u7F72\u5E94\u7528\u6D41\u7A0B</strong></p><p><strong>\u670D\u52A1\u7F16\u6392\uFF08YAML\uFF09</strong></p><p><strong>Deployment\u5DE5\u4F5C\u8D1F\u8F7D\u5747\u8861\u5668</strong></p><ul><li>\u4ECB\u7ECD</li><li>\u5E94\u7528\u751F\u547D\u5468\u671F\u7BA1\u7406\u6D41\u7A0B</li><li>\u5E94\u7528\u90E8\u7F72</li><li>\u5E94\u7528\u5347\u7EA7</li><li>\u6C34\u5E73\u6269\u7F29\u5BB9 \u56DE\u6EDA</li><li>\u6EDA\u52A8\u5347\u7EA7\u4E0E\u56DE\u6EDA\u5B9E\u73B0\u673A\u5236</li></ul><img src="https://pic.imgdb.cn/item/61ebeca92ab3f51d911391a7.png" style="zoom:67%;"><h3 id="\u4F7F\u7528deployment\u90E8\u7F72java\u5E94\u7528" tabindex="-1"><a class="header-anchor" href="#\u4F7F\u7528deployment\u90E8\u7F72java\u5E94\u7528" aria-hidden="true">#</a> \u4F7F\u7528Deployment\u90E8\u7F72Java\u5E94\u7528</h3><p><strong>\u4F7F\u7528Deployment\u63A7\u5236\u5668\u90E8\u7F72\u955C\u50CF\uFF1A</strong></p><p><strong>\u521B\u5EFA\u4E00\u4E2ADeployment\u63A7\u5236\u5668\u7136\u540E\u955C\u50CF\u4F7F\u7528\u7684\u65F6nginx:latest</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl create deployment web --image=nginx:latest deployment.apps/web created</span>
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get deploy </span>
NAME   READY   UP-TO-DATE   AVAILABLE   AGEweb    <span class="token number">0</span>/1     <span class="token number">1</span>            <span class="token number">0</span>           11s
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u4F7F\u7528Service\u5C06Pod\u66B4\u9732\u51FA\u53BB\uFF1A</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl expose deployment web --port=80 --target-port=80 --type=NodePort      service/web exposed</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>\u8BBF\u95EE\u5E94\u7528\uFF1A</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get service</span>
NAME         TYPE        CLUSTER-IP      EXTERNAL-IP   PORT<span class="token punctuation">(</span>S<span class="token punctuation">)</span>        AGE
kubernetes   ClusterIP   <span class="token number">10.96</span>.0.1       <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">443</span>/TCP        11h
web          NodePort    <span class="token number">10.99</span>.251.101   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">80</span>:30746/TCP   3m15shttp://NodeIP:Port     
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u670D\u52A1\u7F16\u6392-yaml\u6587\u4EF6\u683C\u5F0F\u8BF4\u660E" tabindex="-1"><a class="header-anchor" href="#\u670D\u52A1\u7F16\u6392-yaml\u6587\u4EF6\u683C\u5F0F\u8BF4\u660E" aria-hidden="true">#</a> \u670D\u52A1\u7F16\u6392\uFF1AYAML\u6587\u4EF6\u683C\u5F0F\u8BF4\u660E</h3><p><strong>\u5728\u6B64\u4E4B\u524D\u5B66\u4E60ansible\u7684\u65F6\u5019\u5C31\u6709\u5B66\u4E60\u8FC7yaml\u6587\u4EF6\u683C\u5F0F</strong></p><p>K8s\u662F\u4E00\u4E2A\u5BB9\u5668\u7F16\u6392\u5F15\u64CE\uFF0C\u4F7F\u7528YAML\u6587\u4EF6\u7F16\u6392\u8981\u90E8\u7F72\u5E94\u7528\uFF0C\u56E0\u6B64\u5728\u5B66\u4E60\u4E4B\u524D\uFF0C\u5E94\u5148\u4E86\u89E3YAML\u8BED\u6CD5\u683C\u5F0F\uFF1A</p><p>\u2022 \u7F29\u8FDB\u8868\u793A\u5C42\u7EA7\u5173\u7CFB</p><p>\u2022 \u4E0D\u652F\u6301\u5236\u8868\u7B26\u201Ctab\u201D\u7F29\u8FDB\uFF0C\u4F7F\u7528\u7A7A\u683C\u7F29\u8FDB</p><p>\u2022 \u901A\u5E38\u5F00\u5934\u7F29\u8FDB 2 \u4E2A\u7A7A\u683C</p><p>\u2022 \u5B57\u7B26\u540E\u7F29\u8FDB 1 \u4E2A\u7A7A\u683C\uFF0C\u5982\u5192\u53F7\u3001\u9017\u53F7\u7B49</p><p>\u2022 \u201C---\u201D \u8868\u793AYAML\u683C\u5F0F\uFF0C\u4E00\u4E2A\u6587\u4EF6\u7684\u5F00\u59CB</p><p>\u2022 \u201C#\u201D\u6CE8\u91CA</p><h3 id="\u670D\u52A1\u7F16\u6392-yaml\u6587\u4EF6\u521B\u5EFA\u8D44\u6E90\u5BF9\u8C61" tabindex="-1"><a class="header-anchor" href="#\u670D\u52A1\u7F16\u6392-yaml\u6587\u4EF6\u521B\u5EFA\u8D44\u6E90\u5BF9\u8C61" aria-hidden="true">#</a> \u670D\u52A1\u7F16\u6392\uFF1AYAML\u6587\u4EF6\u521B\u5EFA\u8D44\u6E90\u5BF9\u8C61</h3><img src="https://pic.imgdb.cn/item/61ebeca92ab3f51d911391b3.png" style="zoom:67%;"><h3 id="\u670D\u52A1\u7F16\u6392-yaml\u6587\u4EF6\u521B\u5EFA\u8D44\u6E90\u5BF9\u8C61-1" tabindex="-1"><a class="header-anchor" href="#\u670D\u52A1\u7F16\u6392-yaml\u6587\u4EF6\u521B\u5EFA\u8D44\u6E90\u5BF9\u8C61-1" aria-hidden="true">#</a> \u670D\u52A1\u7F16\u6392\uFF1AYAML\u6587\u4EF6\u521B\u5EFA\u8D44\u6E90\u5BF9\u8C61</h3><img src="https://pic.imgdb.cn/item/61ebeca92ab3f51d911391be.png" style="zoom:67%;"><blockquote><p><strong>\u670D\u52A1\u7F16\u6392\uFF1A\u8D44\u6E90\u5B57\u6BB5\u592A\u591A\uFF0C\u8BB0\u4E0D\u4F4F\u600E\u4E48\u529E?</strong></p></blockquote><p><img src="https://pic.imgdb.cn/item/61ebecb52ab3f51d9113a1b6.png" alt="" loading="lazy"></p><h3 id="\u8D44\u6E90\u5B57\u6BB5\u591A\u7684\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#\u8D44\u6E90\u5B57\u6BB5\u591A\u7684\u95EE\u9898" aria-hidden="true">#</a> \u8D44\u6E90\u5B57\u6BB5\u591A\u7684\u95EE\u9898</h3><ul><li>\u7528create\u547D\u4EE4\u751F\u6210</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ kubectl create deployment nginx <span class="token parameter variable">--image</span><span class="token operator">=</span>nginx:1.16 <span class="token parameter variable">-o</span> yaml --dry-run   <span class="token operator">&gt;</span> my-deploy.yaml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>\u7528get\u547D\u4EE4\u5BFC\u51FA</li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$ kubectl get deployment nginx -o yaml &gt; my-deploy.yaml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>Pod\u5BB9\u5668\u7684\u5B57\u6BB5\u5FD8\u8BB0\u62FC\u5199\u4E86</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ kubectl explain pods.spec.containers
$ kubectl explain deployment
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="pod" tabindex="-1"><a class="header-anchor" href="#pod" aria-hidden="true">#</a> Pod</h2><h3 id="pod\u5BF9\u8C61-\u57FA\u672C\u6982\u5FF5" tabindex="-1"><a class="header-anchor" href="#pod\u5BF9\u8C61-\u57FA\u672C\u6982\u5FF5" aria-hidden="true">#</a> Pod\u5BF9\u8C61\uFF1A\u57FA\u672C\u6982\u5FF5</h3>`,39),d=n("li",null,[n("strong",null,[n("code",null,"Pod \u662F\u53EF\u4EE5\u5728 Kubernetes \u4E2D\u521B\u5EFA\u548C\u7BA1\u7406\u7684\u3001\u6700\u5C0F\u7684\u53EF\u90E8\u7F72\u7684\u8BA1\u7B97\u5355\u5143\u3002")])],-1),u=n("em",null,"Pod",-1),k={href:"https://kubernetes.io/zh/docs/concepts/overview/what-is-kubernetes/#why-containers",target:"_blank",rel:"noopener noreferrer"},m={href:"https://kubernetes.io/zh/docs/concepts/workloads/pods/init-containers/",target:"_blank",rel:"noopener noreferrer"},b={href:"https://kubernetes.io/zh/docs/concepts/workloads/pods/ephemeral-containers/",target:"_blank",rel:"noopener noreferrer"},v=n("li",null,[n("strong",null,[n("code",null,"\u8D44\u6E90\u5171\u4EAB\u548C\u901A\u4FE1\uFF1A")]),s(" Pod \u4F7F\u5B83\u7684\u6210\u5458\u5BB9\u5668\u95F4\u80FD\u591F\u8FDB\u884C\u6570\u636E\u5171\u4EAB\u548C\u901A\u4FE1\u3002")],-1),h=n("strong",null,[n("code",null,"Pod\u4E2D\u7684\u5B58\u50A8\uFF1A")],-1),g={href:"https://kubernetes.io/zh/docs/concepts/storage/volumes/",target:"_blank",rel:"noopener noreferrer"},y=n("h3",{id:"\u5982\u4F55\u4F7F\u7528-pod",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u5982\u4F55\u4F7F\u7528-pod","aria-hidden":"true"},"#"),s(" \u5982\u4F55\u4F7F\u7528 Pod")],-1),P={href:"https://kubernetes.io/zh/docs/concepts/workloads/controllers/deployment/",target:"_blank",rel:"noopener noreferrer"},_={href:"https://kubernetes.io/zh/docs/concepts/workloads/controllers/job/",target:"_blank",rel:"noopener noreferrer"},f={href:"https://kubernetes.io/zh/docs/concepts/workloads/controllers/statefulset/",target:"_blank",rel:"noopener noreferrer"},x={href:"https://kubernetes.io/zh/docs/concepts/architecture/controller/",target:"_blank",rel:"noopener noreferrer"},A={href:"https://kubernetes.io/zh/docs/concepts/architecture/nodes/",target:"_blank",rel:"noopener noreferrer"},R=n("em",null,"\u9A71\u9010",-1),E=n("p",null,"Kubernetes \u96C6\u7FA4\u4E2D\u7684 Pod \u4E3B\u8981\u6709\u4E24\u79CD\u7528\u6CD5\uFF1A",-1),w=n("ul",null,[n("li",null,[n("strong",null,"\u8FD0\u884C\u5355\u4E2A\u5BB9\u5668\u7684 Pod"),s('\u3002"\u6BCF\u4E2A Pod \u4E00\u4E2A\u5BB9\u5668"\u6A21\u578B\u662F\u6700\u5E38\u89C1\u7684 Kubernetes \u7528\u4F8B\uFF1B \u5728\u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0C\u53EF\u4EE5\u5C06 Pod \u770B\u4F5C\u5355\u4E2A\u5BB9\u5668\u7684\u5305\u88C5\u5668\uFF0C\u5E76\u4E14 Kubernetes \u76F4\u63A5\u7BA1\u7406 Pod\uFF0C\u800C\u4E0D\u662F\u5BB9\u5668\u3002')]),n("li",null,[n("strong",null,"\u8FD0\u884C\u591A\u4E2A\u534F\u540C\u5DE5\u4F5C\u7684\u5BB9\u5668\u7684 Pod"),s("\u3002 Pod \u53EF\u80FD\u5C01\u88C5\u7531\u591A\u4E2A\u7D27\u5BC6\u8026\u5408\u4E14\u9700\u8981\u5171\u4EAB\u8D44\u6E90\u7684\u5171\u5904\u5BB9\u5668\u7EC4\u6210\u7684\u5E94\u7528\u7A0B\u5E8F\u3002 \u8FD9\u4E9B\u4F4D\u4E8E\u540C\u4E00\u4F4D\u7F6E\u7684\u5BB9\u5668\u53EF\u80FD\u5F62\u6210\u5355\u4E2A\u5185\u805A\u7684\u670D\u52A1\u5355\u5143 \u2014\u2014 \u4E00\u4E2A\u5BB9\u5668\u5C06\u6587\u4EF6\u4ECE\u5171\u4EAB\u5377\u63D0\u4F9B\u7ED9\u516C\u4F17\uFF0C \u800C\u53E6\u4E00\u4E2A\u5355\u72EC\u7684\u201C\u8FB9\u8F66\u201D\uFF08sidecar\uFF09\u5BB9\u5668\u5219\u5237\u65B0\u6216\u66F4\u65B0\u8FD9\u4E9B\u6587\u4EF6\u3002 Pod \u5C06\u8FD9\u4E9B\u5BB9\u5668\u548C\u5B58\u50A8\u8D44\u6E90\u6253\u5305\u4E3A\u4E00\u4E2A\u53EF\u7BA1\u7406\u7684\u5B9E\u4F53\u3002")])],-1),S=n("h3",{id:"pod-\u600E\u6837\u7BA1\u7406\u591A\u4E2A\u5BB9\u5668",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#pod-\u600E\u6837\u7BA1\u7406\u591A\u4E2A\u5BB9\u5668","aria-hidden":"true"},"#"),s(" Pod \u600E\u6837\u7BA1\u7406\u591A\u4E2A\u5BB9\u5668")],-1),T=n("li",null,"Pod \u88AB\u8BBE\u8BA1\u6210\u652F\u6301\u5F62\u6210\u5185\u805A\u670D\u52A1\u5355\u5143\u7684\u591A\u4E2A\u534F\u4F5C\u8FC7\u7A0B\uFF08\u5F62\u5F0F\u4E3A\u5BB9\u5668\uFF09\u3002 Pod \u4E2D\u7684\u5BB9\u5668\u88AB\u81EA\u52A8\u5B89\u6392\u5230\u96C6\u7FA4\u4E2D\u7684\u540C\u4E00\u7269\u7406\u673A\u6216\u865A\u62DF\u673A\u4E0A\uFF0C\u5E76\u53EF\u4EE5\u4E00\u8D77\u8FDB\u884C\u8C03\u5EA6\u3002 \u5BB9\u5668\u4E4B\u95F4\u53EF\u4EE5\u5171\u4EAB\u8D44\u6E90\u548C\u4F9D\u8D56\u3001\u5F7C\u6B64\u901A\u4FE1\u3001\u534F\u8C03\u4F55\u65F6\u4EE5\u53CA\u4F55\u79CD\u65B9\u5F0F\u7EC8\u6B62\u81EA\u8EAB\u3002",-1),q={href:"https://kubernetes.io/zh/docs/concepts/workloads/pods/#pod-networking",target:"_blank",rel:"noopener noreferrer"},C={href:"https://kubernetes.io/zh/docs/concepts/workloads/pods/#pod-storage",target:"_blank",rel:"noopener noreferrer"},D=n("h3",{id:"pod-\u4F7F\u7528",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#pod-\u4F7F\u7528","aria-hidden":"true"},"#"),s(" Pod \u4F7F\u7528")],-1),z=n("blockquote",null,[n("p",null,[n("strong",null,"\u8BF4\u660E\uFF1A"),s(" \u91CD\u542F Pod \u4E2D\u7684\u5BB9\u5668\u4E0D\u5E94\u4E0E\u91CD\u542F Pod \u6DF7\u6DC6\u3002 Pod \u4E0D\u662F\u8FDB\u7A0B\uFF0C\u800C\u662F\u5BB9\u5668\u8FD0\u884C\u7684\u73AF\u5883\u3002 \u5728\u88AB\u5220\u9664\u4E4B\u524D\uFF0CPod \u4F1A\u4E00\u76F4\u5B58\u5728\u3002")]),n("p",null,[n("strong",null,"Pod \u548C\u63A7\u5236\u5668")]),n("p",null,[n("strong",null,"\u4F60\u53EF\u4EE5\u4F7F\u7528\u5DE5\u4F5C\u8D1F\u8F7D\u8D44\u6E90\u6765\u521B\u5EFA\u548C\u7BA1\u7406\u591A\u4E2A Pod\u3002 \u8D44\u6E90\u7684\u63A7\u5236\u5668\u80FD\u591F\u5904\u7406\u526F\u672C\u7684\u7BA1\u7406\u3001\u4E0A\u7EBF\uFF0C\u5E76\u5728 Pod \u5931\u6548\u65F6\u63D0\u4F9B\u81EA\u6108\u80FD\u529B\u3002 \u4F8B\u5982\uFF0C\u5982\u679C\u4E00\u4E2A\u8282\u70B9\u5931\u8D25\uFF0C\u63A7\u5236\u5668\u6CE8\u610F\u5230\u8BE5\u8282\u70B9\u4E0A\u7684 Pod \u5DF2\u7ECF\u505C\u6B62\u5DE5\u4F5C\uFF0C \u5C31\u53EF\u4EE5\u521B\u5EFA\u66FF\u6362\u6027\u7684 Pod\u3002\u8C03\u5EA6\u5668\u4F1A\u5C06\u66FF\u8EAB Pod \u8C03\u5EA6\u5230\u4E00\u4E2A\u5065\u5EB7\u7684\u8282\u70B9\u6267\u884C\u3002")])],-1),j=n("h3",{id:"pod-\u6A21\u7248",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#pod-\u6A21\u7248","aria-hidden":"true"},"#"),s(" Pod \u6A21\u7248")],-1),N={href:"https://kubernetes.io/zh/docs/concepts/workloads/",target:"_blank",rel:"noopener noreferrer"},I=n("em",null,"Pod \u6A21\u677F\uFF08Pod Template\uFF09",-1),M={href:"https://kubernetes.io/zh/docs/concepts/workloads/controllers/deployment/",target:"_blank",rel:"noopener noreferrer"},U={href:"https://kubernetes.io/zh/docs/concepts/workloads/controllers/job/",target:"_blank",rel:"noopener noreferrer"},L={href:"https://kubernetes.io/zh/docs/concepts/workloads/controllers/daemonset/",target:"_blank",rel:"noopener noreferrer"},J=n("li",null,[s("\u5DE5\u4F5C\u8D1F\u8F7D\u7684\u63A7\u5236\u5668\u4F1A\u4F7F\u7528\u8D1F\u8F7D\u5BF9\u8C61\u4E2D\u7684 "),n("code",null,"PodTemplate"),s(" \u6765\u751F\u6210\u5B9E\u9645\u7684 Pod\u3002 "),n("code",null,"PodTemplate"),s(" \u662F\u4F60\u7528\u6765\u8FD0\u884C\u5E94\u7528\u65F6\u6307\u5B9A\u7684\u8D1F\u8F7D\u8D44\u6E90\u7684\u76EE\u6807\u72B6\u6001\u7684\u4E00\u90E8\u5206\u3002")],-1),O=t(`<p>\u4E0B\u9762\u7684\u793A\u4F8B\u662F\u4E00\u4E2A\u7B80\u5355\u7684 Job \u7684\u6E05\u5355\uFF0C\u5176\u4E2D\u7684 <code>template</code> \u6307\u793A\u542F\u52A8\u4E00\u4E2A\u5BB9\u5668\u3002 \u8BE5 Pod \u4E2D\u7684\u5BB9\u5668\u4F1A\u6253\u5370\u4E00\u6761\u6D88\u606F\u4E4B\u540E\u6682\u505C\u3002</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> batch/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Job
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> hello
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token comment"># \u8FD9\u91CC\u662F Pod \u6A21\u7248</span>
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> hello
        <span class="token key atrule">image</span><span class="token punctuation">:</span> busybox
        <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&#39;sh&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;-c&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;echo &quot;Hello, Kubernetes!&quot; &amp;&amp; sleep 3600&#39;</span><span class="token punctuation">]</span>
      <span class="token key atrule">restartPolicy</span><span class="token punctuation">:</span> OnFailure
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="pod-\u66F4\u65B0\u4E0E\u66FF\u6362" tabindex="-1"><a class="header-anchor" href="#pod-\u66F4\u65B0\u4E0E\u66FF\u6362" aria-hidden="true">#</a> Pod \u66F4\u65B0\u4E0E\u66FF\u6362</h3><ul><li>\u4FEE\u6539 Pod \u6A21\u7248\u6216\u8005\u5207\u6362\u5230\u65B0\u7684 Pod \u6A21\u7248\u90FD\u4E0D\u4F1A\u5BF9\u5DF2\u7ECF\u5B58\u5728\u7684 Pod \u8D77\u4F5C\u7528\u3002 Pod \u4E0D\u4F1A\u76F4\u63A5\u6536\u5230\u6A21\u7248\u7684\u66F4\u65B0\u3002\u76F8\u53CD\uFF0C \u65B0\u7684 Pod \u4F1A\u88AB\u521B\u5EFA\u51FA\u6765\uFF0C\u4E0E\u66F4\u6539\u540E\u7684 Pod \u6A21\u7248\u5339\u914D\u3002</li><li>\u5F53\u67D0\u5DE5\u4F5C\u8D1F\u8F7D\u7684 Pod \u6A21\u677F\u88AB\u6539\u53D8\u65F6\uFF0C\u63A7\u5236\u5668\u4F1A\u57FA\u4E8E\u66F4\u65B0\u7684\u6A21\u677F \u521B\u5EFA\u65B0\u7684 Pod \u5BF9\u8C61\u800C\u4E0D\u662F\u5BF9\u73B0\u6709 Pod \u6267\u884C\u66F4\u65B0\u6216\u8005\u4FEE\u8865\u64CD\u4F5C\u3002</li><li>Pod \u7684\u7EDD\u5927\u591A\u6570\u5143\u6570\u636E\u90FD\u662F\u4E0D\u53EF\u53D8\u7684\u3002\u4F8B\u5982\uFF0C\u4F60\u4E0D\u53EF\u4EE5\u6539\u53D8\u5176 <code>namespace</code>\u3001<code>name</code>\u3001 <code>uid</code> \u6216\u8005 <code>creationTimestamp</code> \u5B57\u6BB5\uFF1B<code>generation</code> \u5B57\u6BB5\u662F\u6BD4\u8F83\u7279\u522B\u7684\uFF0C\u5982\u679C\u66F4\u65B0 \u8BE5\u5B57\u6BB5\uFF0C\u53EA\u80FD\u589E\u52A0\u5B57\u6BB5\u53D6\u503C\u800C\u4E0D\u80FD\u51CF\u5C11\u3002</li><li>\u5728\u66F4\u65B0<code>spec.activeDeadlineSeconds</code> \u5B57\u6BB5\u65F6\uFF0C\u4EE5\u4E0B\u4E24\u79CD\u66F4\u65B0\u64CD\u4F5C\u662F\u88AB\u5141\u8BB8\u7684\uFF1A <ol><li>\u5982\u679C\u8BE5\u5B57\u6BB5\u5C1A\u672A\u8BBE\u7F6E\uFF0C\u53EF\u4EE5\u5C06\u5176\u8BBE\u7F6E\u4E3A\u4E00\u4E2A\u6B63\u6570\uFF1B</li><li>\u5982\u679C\u8BE5\u5B57\u6BB5\u5DF2\u7ECF\u8BBE\u7F6E\u4E3A\u4E00\u4E2A\u6B63\u6570\uFF0C\u53EF\u4EE5\u5C06\u5176\u8BBE\u7F6E\u4E3A\u4E00\u4E2A\u66F4\u5C0F\u7684\u3001\u975E\u8D1F\u7684\u6574\u6570\u3002</li></ol></li></ul><h3 id="\u5BB9\u5668\u63A2\u9488" tabindex="-1"><a class="header-anchor" href="#\u5BB9\u5668\u63A2\u9488" aria-hidden="true">#</a> \u5BB9\u5668\u63A2\u9488</h3><p><em>Pr+obe</em> \u662F\u7531 kubelet \u5BF9\u5BB9\u5668\u6267\u884C\u7684\u5B9A\u671F\u8BCA\u65AD\u3002\u8981\u6267\u884C\u8BCA\u65AD\uFF0Ckubelet \u53EF\u4EE5\u6267\u884C\u4E09\u79CD\u52A8\u4F5C\uFF1A</p><ul><li><code>ExecAction</code>\uFF08\u501F\u52A9\u5BB9\u5668\u8FD0\u884C\u65F6\u6267\u884C\uFF09</li><li><code>TCPSocketAction</code>\uFF08\u7531 kubelet \u76F4\u63A5\u68C0\u6D4B\uFF09</li><li><code>HTTPGetAction</code>\uFF08\u7531 kubelet \u76F4\u63A5\u68C0\u6D4B\uFF09</li></ul><h3 id="pod-\u7684\u751F\u547D\u5468\u671F" tabindex="-1"><a class="header-anchor" href="#pod-\u7684\u751F\u547D\u5468\u671F" aria-hidden="true">#</a> Pod \u7684\u751F\u547D\u5468\u671F</h3>`,8),G=n("code",null,"Pending",-1),H={href:"https://kubernetes.io/zh/docs/concepts/workloads/pods/pod-lifecycle/#pod-phase",target:"_blank",rel:"noopener noreferrer"},K=n("code",null,"Running",-1),Y=n("code",null,"Succeeded",-1),V=n("code",null,"Failed",-1),F=n("code",null,"kubelet",-1),$={href:"https://kubernetes.io/zh/docs/concepts/workloads/pods/pod-lifecycle/#container-states",target:"_blank",rel:"noopener noreferrer"},B={href:"https://kubernetes.io/zh/docs/concepts/scheduling-eviction/",target:"_blank",rel:"noopener noreferrer"},X={href:"https://kubernetes.io/zh/docs/concepts/workloads/pods/pod-lifecycle/#pod-termination",target:"_blank",rel:"noopener noreferrer"},W=n("blockquote",null,[n("h4",{id:"pod-\u751F\u547D\u671F",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#pod-\u751F\u547D\u671F","aria-hidden":"true"},"#"),s(" Pod \u751F\u547D\u671F")])],-1),Z={class:"task-list-container"},Q={class:"task-list-item"},nn=n("input",{type:"checkbox",class:"task-list-item-checkbox",id:"task-item-0",checked:"checked",disabled:"disabled"},null,-1),sn={class:"task-list-item-label",for:"task-item-0"},en={href:"https://kubernetes.io/zh/docs/concepts/overview/working-with-objects/names/#uids",target:"_blank",rel:"noopener noreferrer"},an={class:"task-list-item"},tn=n("input",{type:"checkbox",class:"task-list-item-checkbox",id:"task-item-1",checked:"checked",disabled:"disabled"},null,-1),ln={class:"task-list-item-label",for:"task-item-1"},on={href:"https://kubernetes.io/zh/docs/concepts/architecture/nodes/",target:"_blank",rel:"noopener noreferrer"},cn={href:"https://kubernetes.io/zh/docs/concepts/workloads/pods/pod-lifecycle/#pod-garbage-collection",target:"_blank",rel:"noopener noreferrer"},pn={class:"task-list-item"},rn=n("input",{type:"checkbox",class:"task-list-item-checkbox",id:"task-item-2",checked:"checked",disabled:"disabled"},null,-1),dn={class:"task-list-item-label",for:"task-item-2"},un={href:"https://kubernetes.io/zh/docs/concepts/architecture/nodes/",target:"_blank",rel:"noopener noreferrer"},kn={href:"https://kubernetes.io/zh/docs/concepts/architecture/controller/",target:"_blank",rel:"noopener noreferrer"},mn=n("li",{class:"task-list-item"},[n("input",{type:"checkbox",class:"task-list-item-checkbox",id:"task-item-3",checked:"checked",disabled:"disabled"}),n("label",{class:"task-list-item-label",for:"task-item-3"}," \u4EFB\u4F55\u7ED9\u5B9A\u7684 Pod \uFF08\u7531 UID \u5B9A\u4E49\uFF09\u4ECE\u4E0D\u4F1A\u88AB\u201C\u91CD\u65B0\u8C03\u5EA6\uFF08rescheduled\uFF09\u201D\u5230\u4E0D\u540C\u7684\u8282\u70B9\uFF1B \u76F8\u53CD\uFF0C\u8FD9\u4E00 Pod \u53EF\u4EE5\u88AB\u4E00\u4E2A\u65B0\u7684\u3001\u51E0\u4E4E\u5B8C\u5168\u76F8\u540C\u7684 Pod \u66FF\u6362\u6389\u3002 \u5982\u679C\u9700\u8981\uFF0C\u65B0 Pod \u7684\u540D\u5B57\u53EF\u4EE5\u4E0D\u53D8\uFF0C\u4F46\u662F\u5176 UID \u4F1A\u4E0D\u540C\u3002")],-1),bn={class:"task-list-item"},vn=n("input",{type:"checkbox",class:"task-list-item-checkbox",id:"task-item-4",checked:"checked",disabled:"disabled"},null,-1),hn={class:"task-list-item-label",for:"task-item-4"},gn={href:"https://kubernetes.io/zh/docs/concepts/storage/volumes/",target:"_blank",rel:"noopener noreferrer"},yn=t('<blockquote><h4 id="pod-\u9636\u6BB5" tabindex="-1"><a class="header-anchor" href="#pod-\u9636\u6BB5" aria-hidden="true">#</a> Pod \u9636\u6BB5</h4></blockquote><p>Pod \u7684\u9636\u6BB5\u662F Pod \u5728\u5176\u751F\u547D\u5468\u671F\u4E2D\u6240\u5904\u4F4D\u7F6E\u7684\u7B80\u5355\u5B8F\u89C2\u6982\u8FF0\u3002 \u8BE5\u9636\u6BB5\u5E76\u4E0D\u662F\u5BF9\u5BB9\u5668\u6216 Pod \u72B6\u6001\u7684\u7EFC\u5408\u6C47\u603B\uFF0C\u4E5F\u4E0D\u662F\u4E3A\u4E86\u6210\u4E3A\u5B8C\u6574\u7684\u72B6\u6001\u673A\u3002</p><table><thead><tr><th><code>Pending</code>\uFF08\u60AC\u51B3\uFF09</th><th>Pod \u5DF2\u88AB Kubernetes \u7CFB\u7EDF\u63A5\u53D7\uFF0C\u4F46\u6709\u4E00\u4E2A\u6216\u8005\u591A\u4E2A\u5BB9\u5668\u5C1A\u672A\u521B\u5EFA\u4EA6\u672A\u8FD0\u884C\u3002\u6B64\u9636\u6BB5\u5305\u62EC\u7B49\u5F85 Pod \u88AB\u8C03\u5EA6\u7684\u65F6\u95F4\u548C\u901A\u8FC7\u7F51\u7EDC\u4E0B\u8F7D\u955C\u50CF\u7684\u65F6\u95F4\uFF0C</th></tr></thead><tbody><tr><td><code>Running</code>\uFF08\u8FD0\u884C\u4E2D\uFF09</td><td>Pod \u5DF2\u7ECF\u7ED1\u5B9A\u5230\u4E86\u67D0\u4E2A\u8282\u70B9\uFF0CPod \u4E2D\u6240\u6709\u7684\u5BB9\u5668\u90FD\u5DF2\u88AB\u521B\u5EFA\u3002\u81F3\u5C11\u6709\u4E00\u4E2A\u5BB9\u5668\u4ECD\u5728\u8FD0\u884C\uFF0C\u6216\u8005\u6B63\u5904\u4E8E\u542F\u52A8\u6216\u91CD\u542F\u72B6\u6001\u3002</td></tr><tr><td><code>Succeeded</code>\uFF08\u6210\u529F\uFF09</td><td>Pod \u4E2D\u7684\u6240\u6709\u5BB9\u5668\u90FD\u5DF2\u6210\u529F\u7EC8\u6B62\uFF0C\u5E76\u4E14\u4E0D\u4F1A\u518D\u91CD\u542F\u3002</td></tr><tr><td><code>Failed</code>\uFF08\u5931\u8D25\uFF09</td><td>Pod \u4E2D\u7684\u6240\u6709\u5BB9\u5668\u90FD\u5DF2\u7EC8\u6B62\uFF0C\u5E76\u4E14\u81F3\u5C11\u6709\u4E00\u4E2A\u5BB9\u5668\u662F\u56E0\u4E3A\u5931\u8D25\u7EC8\u6B62\u3002\u4E5F\u5C31\u662F\u8BF4\uFF0C\u5BB9\u5668\u4EE5\u975E 0 \u72B6\u6001\u9000\u51FA\u6216\u8005\u88AB\u7CFB\u7EDF\u7EC8\u6B62\u3002</td></tr><tr><td><code>Unknown</code>\uFF08\u672A\u77E5\uFF09</td><td>\u56E0\u4E3A\u67D0\u4E9B\u539F\u56E0\u65E0\u6CD5\u53D6\u5F97 Pod \u7684\u72B6\u6001\u3002\u8FD9\u79CD\u60C5\u51B5\u901A\u5E38\u662F\u56E0\u4E3A\u4E0E Pod \u6240\u5728\u4E3B\u673A\u901A\u4FE1\u5931\u8D25\u3002</td></tr></tbody></table><p>\u5982\u679C\u67D0\u8282\u70B9\u6B7B\u6389\u6216\u8005\u4E0E\u96C6\u7FA4\u4E2D\u5176\u4ED6\u8282\u70B9\u5931\u8054\uFF0CKubernetes \u4F1A\u5B9E\u65BD\u4E00\u79CD\u7B56\u7565\uFF0C\u5C06\u5931\u53BB\u7684\u8282\u70B9\u4E0A\u8FD0\u884C\u7684\u6240\u6709 Pod \u4E3A <code>Failed</code>\u3002</p><blockquote><h4 id="\u5BB9\u5668\u72B6\u6001" tabindex="-1"><a class="header-anchor" href="#\u5BB9\u5668\u72B6\u6001" aria-hidden="true">#</a> \u5BB9\u5668\u72B6\u6001</h4></blockquote>',5),Pn={href:"https://kubernetes.io/zh/docs/concepts/workloads/pods/pod-lifecycle/#pod-phase",target:"_blank",rel:"noopener noreferrer"},_n={href:"https://kubernetes.io/zh/docs/concepts/containers/container-lifecycle-hooks/",target:"_blank",rel:"noopener noreferrer"},fn={href:"https://kubernetes.io/docs/reference/generated/kube-scheduler/",target:"_blank",rel:"noopener noreferrer"},xn=n("code",null,"kubelet",-1),An={href:"https://kubernetes.io/zh/docs/setup/production-environment/container-runtimes",target:"_blank",rel:"noopener noreferrer"},Rn=t('<p>\u5BB9\u5668\u7684\u72B6\u6001\u6709\u4E09\u79CD\uFF1A</p><ul><li><code>Waiting</code>\uFF08\u7B49\u5F85\uFF09</li><li><code>Running</code>\uFF08\u8FD0\u884C\u4E2D\uFF09</li><li><code>Terminated</code>\uFF08\u5DF2\u7EC8\u6B62\uFF09</li></ul><blockquote><h4 id="\u5BB9\u5668\u91CD\u542F\u7B56\u7565" tabindex="-1"><a class="header-anchor" href="#\u5BB9\u5668\u91CD\u542F\u7B56\u7565" aria-hidden="true">#</a> \u5BB9\u5668\u91CD\u542F\u7B56\u7565</h4></blockquote><p>Pod \u7684 <code>spec</code> \u4E2D\u5305\u542B\u4E00\u4E2A <code>restartPolicy</code> \u5B57\u6BB5\uFF0C\u5176\u53EF\u80FD\u53D6\u503C\u5305\u62EC Always\u3001OnFailure \u548C Never\u3002\u9ED8\u8BA4\u503C\u662F Always\u3002</p><p><code>restartPolicy</code> \u9002\u7528\u4E8E Pod \u4E2D\u7684\u6240\u6709\u5BB9\u5668\u3002<code>restartPolicy</code> \u4EC5\u9488\u5BF9\u540C\u4E00\u8282\u70B9\u4E0A <code>kubelet</code> \u7684\u5BB9\u5668\u91CD\u542F\u52A8\u4F5C\u3002\u5F53 Pod \u4E2D\u7684\u5BB9\u5668\u9000\u51FA\u65F6\uFF0C<code>kubelet</code> \u4F1A\u6309\u6307\u6570\u56DE\u9000 \u65B9\u5F0F\u8BA1\u7B97\u91CD\u542F\u7684\u5EF6\u8FDF\uFF0810s\u300120s\u300140s\u3001...\uFF09\uFF0C\u5176\u6700\u957F\u5EF6\u8FDF\u4E3A 5 \u5206\u949F\u3002 \u4E00\u65E6\u67D0\u5BB9\u5668\u6267\u884C\u4E86 10 \u5206\u949F\u5E76\u4E14\u6CA1\u6709\u51FA\u73B0\u95EE\u9898\uFF0C<code>kubelet</code> \u5BF9\u8BE5\u5BB9\u5668\u7684\u91CD\u542F\u56DE\u9000\u8BA1\u65F6\u5668\u6267\u884C \u91CD\u7F6E\u64CD\u4F5C\u3002</p><blockquote><h4 id="pod-\u72B6\u51B5" tabindex="-1"><a class="header-anchor" href="#pod-\u72B6\u51B5" aria-hidden="true">#</a> Pod \u72B6\u51B5</h4></blockquote>',6),En={href:"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.22/#podcondition-v1-core",target:"_blank",rel:"noopener noreferrer"},wn=n("li",null,[n("code",null,"PodScheduled"),s("\uFF1APod \u5DF2\u7ECF\u88AB\u8C03\u5EA6\u5230\u67D0\u8282\u70B9\uFF1B")],-1),Sn=n("li",null,[n("code",null,"ContainersReady"),s("\uFF1APod \u4E2D\u6240\u6709\u5BB9\u5668\u90FD\u5DF2\u5C31\u7EEA\uFF1B")],-1),Tn=n("code",null,"Initialized",-1),qn={href:"https://kubernetes.io/zh/docs/concepts/workloads/pods/init-containers/",target:"_blank",rel:"noopener noreferrer"},Cn=n("li",null,[n("code",null,"Ready"),s("\uFF1APod \u53EF\u4EE5\u4E3A\u8BF7\u6C42\u63D0\u4F9B\u670D\u52A1\uFF0C\u5E76\u4E14\u5E94\u8BE5\u88AB\u6DFB\u52A0\u5230\u5BF9\u5E94\u670D\u52A1\u7684\u8D1F\u8F7D\u5747\u8861\u6C60\u4E2D")],-1),Dn=t('<table><thead><tr><th><code>type</code></th><th>Pod \u72B6\u51B5\u7684\u540D\u79F0</th></tr></thead><tbody><tr><td><code>status</code></td><td>\u8868\u660E\u8BE5\u72B6\u51B5\u662F\u5426\u9002\u7528\uFF0C\u53EF\u80FD\u7684\u53D6\u503C\u6709 &quot;<code>True</code>&quot;, &quot;<code>False</code>&quot; \u6216 &quot;<code>Unknown</code>&quot;</td></tr><tr><td><code>lastProbeTime</code></td><td>\u4E0A\u6B21\u63A2\u6D4B Pod \u72B6\u51B5\u65F6\u7684\u65F6\u95F4\u6233</td></tr><tr><td><code>lastTransitionTime</code></td><td>Pod \u4E0A\u6B21\u4ECE\u4E00\u79CD\u72B6\u6001\u8F6C\u6362\u5230\u53E6\u4E00\u79CD\u72B6\u6001\u65F6\u7684\u65F6\u95F4\u6233</td></tr><tr><td><code>reason</code></td><td>\u673A\u5668\u53EF\u8BFB\u7684\u3001\u9A7C\u5CF0\u7F16\u7801\uFF08UpperCamelCase\uFF09\u7684\u6587\u5B57\uFF0C\u8868\u8FF0\u4E0A\u6B21\u72B6\u51B5\u53D8\u5316\u7684\u539F\u56E0</td></tr><tr><td><code>message</code></td><td>\u4EBA\u7C7B\u53EF\u8BFB\u7684\u6D88\u606F\uFF0C\u7ED9\u51FA\u4E0A\u6B21\u72B6\u6001\u8F6C\u6362\u7684\u8BE6\u7EC6\u4FE1\u606F</td></tr></tbody></table><blockquote><h4 id="pod-\u5C31\u7EEA\u6001" tabindex="-1"><a class="header-anchor" href="#pod-\u5C31\u7EEA\u6001" aria-hidden="true">#</a> Pod \u5C31\u7EEA\u6001</h4></blockquote><ul><li><p><strong>FEATURE STATE:</strong> <code>Kubernetes v1.14 [stable]</code></p></li><li><p>\u4F60\u7684\u5E94\u7528\u53EF\u4EE5\u5411 PodStatus \u4E2D\u6CE8\u5165\u989D\u5916\u7684\u53CD\u9988\u6216\u8005\u4FE1\u53F7\uFF1A<em>Pod Readiness\uFF08Pod \u5C31\u7EEA\u6001\uFF09</em>\u3002 \u8981\u4F7F\u7528\u8FD9\u4E00\u7279\u6027\uFF0C\u53EF\u4EE5\u8BBE\u7F6E Pod \u89C4\u7EA6\u4E2D\u7684 <code>readinessGates</code> \u5217\u8868\uFF0C\u4E3A kubelet \u63D0\u4F9B\u4E00\u7EC4\u989D\u5916\u7684\u72B6\u51B5\u4F9B\u5176\u8BC4\u4F30 Pod \u5C31\u7EEA\u6001\u65F6\u4F7F\u7528\u3002</p></li><li><p>\u5C31\u7EEA\u6001\u95E8\u63A7\u57FA\u4E8E Pod \u7684 <code>status.conditions</code> \u5B57\u6BB5\u7684\u5F53\u524D\u503C\u6765\u505A\u51B3\u5B9A\u3002 \u5982\u679C Kubernetes \u65E0\u6CD5\u5728 <code>status.conditions</code> \u5B57\u6BB5\u4E2D\u627E\u5230\u67D0\u72B6\u51B5\uFF0C\u5219\u8BE5\u72B6\u51B5\u7684 \u72B6\u6001\u503C\u9ED8\u8BA4\u4E3A &quot;<code>False</code>&quot;\u3002</p></li></ul><h3 id="\u5BB9\u5668\u63A2\u9488-1" tabindex="-1"><a class="header-anchor" href="#\u5BB9\u5668\u63A2\u9488-1" aria-hidden="true">#</a> \u5BB9\u5668\u63A2\u9488</h3>',4),zn={href:"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.22/#probe-v1-core",target:"_blank",rel:"noopener noreferrer"},jn={href:"https://kubernetes.io/zh/docs/reference/command-line-tools-reference/kubelet/",target:"_blank",rel:"noopener noreferrer"},Nn={href:"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.22/#handler-v1-core",target:"_blank",rel:"noopener noreferrer"},In={href:"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.22/#execaction-v1-core",target:"_blank",rel:"noopener noreferrer"},Mn={href:"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.22/#tcpsocketaction-v1-core",target:"_blank",rel:"noopener noreferrer"},Un={href:"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.22/#httpgetaction-v1-core",target:"_blank",rel:"noopener noreferrer"},Ln=t("<p>\u6BCF\u6B21\u63A2\u6D4B\u90FD\u5C06\u83B7\u5F97\u4EE5\u4E0B\u4E09\u79CD\u7ED3\u679C\u4E4B\u4E00\uFF1A</p><ul><li><code>Success</code>\uFF08\u6210\u529F\uFF09\uFF1A\u5BB9\u5668\u901A\u8FC7\u4E86\u8BCA\u65AD\u3002</li><li><code>Failure</code>\uFF08\u5931\u8D25\uFF09\uFF1A\u5BB9\u5668\u672A\u901A\u8FC7\u8BCA\u65AD\u3002</li><li><code>Unknown</code>\uFF08\u672A\u77E5\uFF09\uFF1A\u8BCA\u65AD\u5931\u8D25\uFF0C\u56E0\u6B64\u4E0D\u4F1A\u91C7\u53D6\u4EFB\u4F55\u884C\u52A8\u3002</li></ul><p>\u9488\u5BF9\u8FD0\u884C\u4E2D\u7684\u5BB9\u5668\uFF0C<code>kubelet</code> \u53EF\u4EE5\u9009\u62E9\u662F\u5426\u6267\u884C\u4EE5\u4E0B\u4E09\u79CD\u63A2\u9488\uFF0C\u4EE5\u53CA\u5982\u4F55\u9488\u5BF9\u63A2\u6D4B\u7ED3\u679C\u4F5C\u51FA\u53CD\u5E94\uFF1A</p>",3),Jn=n("code",null,"livenessProbe",-1),On={href:"https://kubernetes.io/zh/docs/concepts/workloads/pods/pod-lifecycle/#restart-policy",target:"_blank",rel:"noopener noreferrer"},Gn=n("code",null,"Success",-1),Hn=n("li",null,[n("p",null,[n("code",null,"readinessProbe"),s("\uFF1A\u6307\u793A\u5BB9\u5668\u662F\u5426\u51C6\u5907\u597D\u4E3A\u8BF7\u6C42\u63D0\u4F9B\u670D\u52A1\u3002\u5982\u679C\u5C31\u7EEA\u6001\u63A2\u6D4B\u5931\u8D25\uFF0C \u7AEF\u70B9\u63A7\u5236\u5668\u5C06\u4ECE\u4E0E Pod \u5339\u914D\u7684\u6240\u6709\u670D\u52A1\u7684\u7AEF\u70B9\u5217\u8868\u4E2D\u5220\u9664\u8BE5 Pod \u7684 IP \u5730\u5740\u3002 \u521D\u59CB\u5EF6\u8FDF\u4E4B\u524D\u7684\u5C31\u7EEA\u6001\u7684\u72B6\u6001\u503C\u9ED8\u8BA4\u4E3A "),n("code",null,"Failure"),s("\u3002 \u5982\u679C\u5BB9\u5668\u4E0D\u63D0\u4F9B\u5C31\u7EEA\u6001\u63A2\u9488\uFF0C\u5219\u9ED8\u8BA4\u72B6\u6001\u4E3A "),n("code",null,"Success"),s("\u3002")])],-1),Kn=n("code",null,"startupProbe",-1),Yn=n("code",null,"kubelet",-1),Vn={href:"https://kubernetes.io/zh/docs/concepts/workloads/pods/pod-lifecycle/#restart-policy",target:"_blank",rel:"noopener noreferrer"},Fn=n("code",null,"Success",-1),$n=t('<li><h4 id="\u4F55\u65F6\u8BE5\u4F7F\u7528\u5B58\u6D3B\u6001\u63A2\u9488" tabindex="-1"><a class="header-anchor" href="#\u4F55\u65F6\u8BE5\u4F7F\u7528\u5B58\u6D3B\u6001\u63A2\u9488" aria-hidden="true">#</a> \u4F55\u65F6\u8BE5\u4F7F\u7528\u5B58\u6D3B\u6001\u63A2\u9488?</h4><ul><li><strong>FEATURE STATE:</strong> <code>Kubernetes v1.0 [stable]</code></li><li>\u5982\u679C\u5BB9\u5668\u4E2D\u7684\u8FDB\u7A0B\u80FD\u591F\u5728\u9047\u5230\u95EE\u9898\u6216\u4E0D\u5065\u5EB7\u7684\u60C5\u51B5\u4E0B\u81EA\u884C\u5D29\u6E83\uFF0C\u5219\u4E0D\u4E00\u5B9A\u9700\u8981\u5B58\u6D3B\u6001\u63A2\u9488; <code>kubelet</code> \u5C06\u6839\u636E Pod \u7684<code>restartPolicy</code> \u81EA\u52A8\u6267\u884C\u4FEE\u590D\u64CD\u4F5C\u3002</li><li>\u5982\u679C\u4F60\u5E0C\u671B\u5BB9\u5668\u5728\u63A2\u6D4B\u5931\u8D25\u65F6\u88AB\u6740\u6B7B\u5E76\u91CD\u65B0\u542F\u52A8\uFF0C\u90A3\u4E48\u8BF7\u6307\u5B9A\u4E00\u4E2A\u5B58\u6D3B\u6001\u63A2\u9488\uFF0C \u5E76\u6307\u5B9A<code>restartPolicy</code> \u4E3A &quot;<code>Always</code>&quot; \u6216 &quot;<code>OnFailure</code>&quot;\u3002</li></ul></li><li><h4 id="\u4F55\u65F6\u8BE5\u4F7F\u7528\u5C31\u7EEA\u6001\u63A2\u9488" tabindex="-1"><a class="header-anchor" href="#\u4F55\u65F6\u8BE5\u4F7F\u7528\u5C31\u7EEA\u6001\u63A2\u9488" aria-hidden="true">#</a> \u4F55\u65F6\u8BE5\u4F7F\u7528\u5C31\u7EEA\u6001\u63A2\u9488?</h4><ul><li><p><strong>FEATURE STATE:</strong> <code>Kubernetes v1.0 [stable]</code></p></li><li><p>\u5982\u679C\u8981\u4EC5\u5728\u63A2\u6D4B\u6210\u529F\u65F6\u624D\u5F00\u59CB\u5411 Pod \u53D1\u9001\u8BF7\u6C42\u6D41\u91CF\uFF0C\u8BF7\u6307\u5B9A\u5C31\u7EEA\u6001\u63A2\u9488\u3002 \u5728\u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0C\u5C31\u7EEA\u6001\u63A2\u9488\u53EF\u80FD\u4E0E\u5B58\u6D3B\u6001\u63A2\u9488\u76F8\u540C\uFF0C\u4F46\u662F\u89C4\u7EA6\u4E2D\u7684\u5C31\u7EEA\u6001\u63A2\u9488\u7684\u5B58\u5728\u610F\u5473\u7740 Pod \u5C06\u5728\u542F\u52A8\u9636\u6BB5\u4E0D\u63A5\u6536\u4EFB\u4F55\u6570\u636E\uFF0C\u5E76\u4E14\u53EA\u6709\u5728\u63A2\u9488\u63A2\u6D4B\u6210\u529F\u540E\u624D\u5F00\u59CB\u63A5\u6536\u6570\u636E\u3002</p></li><li><p>\u5982\u679C\u4F60\u5E0C\u671B\u5BB9\u5668\u80FD\u591F\u81EA\u884C\u8FDB\u5165\u7EF4\u62A4\u72B6\u6001\uFF0C\u4E5F\u53EF\u4EE5\u6307\u5B9A\u4E00\u4E2A\u5C31\u7EEA\u6001\u63A2\u9488\uFF0C\u68C0\u67E5\u67D0\u4E2A\u7279\u5B9A\u4E8E \u5C31\u7EEA\u6001\u7684\u56E0\u6B64\u4E0D\u540C\u4E8E\u5B58\u6D3B\u6001\u63A2\u6D4B\u7684\u7AEF\u70B9\u3002</p></li><li><p>\u5982\u679C\u4F60\u7684\u5E94\u7528\u7A0B\u5E8F\u5BF9\u540E\u7AEF\u670D\u52A1\u6709\u4E25\u683C\u7684\u4F9D\u8D56\u6027\uFF0C\u4F60\u53EF\u4EE5\u540C\u65F6\u5B9E\u73B0\u5B58\u6D3B\u6001\u548C\u5C31\u7EEA\u6001\u63A2\u9488\u3002 \u5F53\u5E94\u7528\u7A0B\u5E8F\u672C\u8EAB\u662F\u5065\u5EB7\u7684\uFF0C\u5B58\u6D3B\u6001\u63A2\u9488\u68C0\u6D4B\u901A\u8FC7\u540E\uFF0C\u5C31\u7EEA\u6001\u63A2\u9488\u4F1A\u989D\u5916\u68C0\u67E5\u6BCF\u4E2A\u6240\u9700\u7684\u540E\u7AEF\u670D\u52A1\u662F\u5426\u53EF\u7528\u3002 \u8FD9\u53EF\u4EE5\u5E2E\u52A9\u4F60\u907F\u514D\u5C06\u6D41\u91CF\u5BFC\u5411\u53EA\u80FD\u8FD4\u56DE\u9519\u8BEF\u4FE1\u606F\u7684 Pod\u3002</p></li><li><p><strong>\u8BF4\u660E\uFF1A</strong></p><p><strong><code>\u8BF7\u6CE8\u610F\uFF0C\u5982\u679C\u4F60\u53EA\u662F\u60F3\u5728 Pod \u88AB\u5220\u9664\u65F6\u80FD\u591F\u6392\u7A7A\u8BF7\u6C42\uFF0C\u5219\u4E0D\u4E00\u5B9A\u9700\u8981\u4F7F\u7528\u5C31\u7EEA\u6001\u63A2\u9488\uFF1B \u5728\u5220\u9664 Pod \u65F6\uFF0CPod \u4F1A\u81EA\u52A8\u5C06\u81EA\u8EAB\u7F6E\u4E8E\u672A\u5C31\u7EEA\u72B6\u6001\uFF0C\u65E0\u8BBA\u5C31\u7EEA\u6001\u63A2\u9488\u662F\u5426\u5B58\u5728\u3002 \u7B49\u5F85 Pod \u4E2D\u7684\u5BB9\u5668\u505C\u6B62\u671F\u95F4\uFF0CPod \u4F1A\u4E00\u76F4\u5904\u4E8E\u672A\u5C31\u7EEA\u72B6\u6001\u3002</code></strong></p></li></ul></li><li><h4 id="\u4F55\u65F6\u8BE5\u4F7F\u7528\u542F\u52A8\u63A2\u9488" tabindex="-1"><a class="header-anchor" href="#\u4F55\u65F6\u8BE5\u4F7F\u7528\u542F\u52A8\u63A2\u9488" aria-hidden="true">#</a> \u4F55\u65F6\u8BE5\u4F7F\u7528\u542F\u52A8\u63A2\u9488\uFF1F</h4><ul><li><p><strong>FEATURE STATE:</strong> <code>Kubernetes v1.18 [beta]</code></p></li><li><p>\u5BF9\u4E8E\u6240\u5305\u542B\u7684\u5BB9\u5668\u9700\u8981\u8F83\u957F\u65F6\u95F4\u624D\u80FD\u542F\u52A8\u5C31\u7EEA\u7684 Pod \u800C\u8A00\uFF0C\u542F\u52A8\u63A2\u9488\u662F\u6709\u7528\u7684\u3002 \u4F60\u4E0D\u518D\u9700\u8981\u914D\u7F6E\u4E00\u4E2A\u8F83\u957F\u7684\u5B58\u6D3B\u6001\u63A2\u6D4B\u65F6\u95F4\u95F4\u9694\uFF0C\u53EA\u9700\u8981\u8BBE\u7F6E\u53E6\u4E00\u4E2A\u72EC\u7ACB\u7684\u914D\u7F6E\u9009\u5B9A\uFF0C \u5BF9\u542F\u52A8\u671F\u95F4\u7684\u5BB9\u5668\u6267\u884C\u63A2\u6D4B\uFF0C\u4ECE\u800C\u5141\u8BB8\u4F7F\u7528\u8FDC\u8FDC\u8D85\u51FA\u5B58\u6D3B\u6001\u65F6\u95F4\u95F4\u9694\u6240\u5141\u8BB8\u7684\u65F6\u957F\u3002</p></li><li><p>\u5982\u679C\u4F60\u7684\u5BB9\u5668\u542F\u52A8\u65F6\u95F4\u901A\u5E38\u8D85\u51FA <code>initialDelaySeconds + failureThreshold \xD7 periodSeconds</code> \u603B\u503C\uFF0C\u4F60\u5E94\u8BE5\u8BBE\u7F6E\u4E00\u4E2A\u542F\u52A8\u63A2\u6D4B\uFF0C\u5BF9\u5B58\u6D3B\u6001\u63A2\u9488\u6240\u4F7F\u7528\u7684\u540C\u4E00\u7AEF\u70B9\u6267\u884C\u68C0\u67E5\u3002 <code>periodSeconds</code> \u7684\u9ED8\u8BA4\u503C\u662F 10 \u79D2\u3002\u4F60\u5E94\u8BE5\u5C06\u5176 <code>failureThreshold</code> \u8BBE\u7F6E\u5F97\u8DB3\u591F\u9AD8\uFF0C \u4EE5\u4FBF\u5BB9\u5668\u6709\u5145\u8DB3\u7684\u65F6\u95F4\u5B8C\u6210\u542F\u52A8\uFF0C\u5E76\u4E14\u907F\u514D\u66F4\u6539\u5B58\u6D3B\u6001\u63A2\u9488\u6240\u4F7F\u7528\u7684\u9ED8\u8BA4\u503C\u3002 \u8FD9\u4E00\u8BBE\u7F6E\u6709\u52A9\u4E8E\u51CF\u5C11\u6B7B\u9501\u72B6\u51B5\u7684\u53D1\u751F\u3002</p></li></ul></li>',3),Bn=t(`<h3 id="pod\u5BF9\u8C61-\u7BA1\u7406\u547D\u4EE4" tabindex="-1"><a class="header-anchor" href="#pod\u5BF9\u8C61-\u7BA1\u7406\u547D\u4EE4" aria-hidden="true">#</a> Pod\u5BF9\u8C61\uFF1A\u7BA1\u7406\u547D\u4EE4</h3><p><strong>\u521B\u5EFAPod</strong></p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># vim pod.yaml </span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> web
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> container1
    <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx

$ kubectl apply  <span class="token punctuation">-</span>f pod.yaml 
pod/web created
$ kubectl get pods 
NAME   READY   STATUS    RESTARTS   AGE
web    1/1     Running   0          2m23s
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u67E5\u770BPod</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ kubectl get pods 
$ kubectl describe pod <span class="token operator">&lt;</span>Pod\u540D\u79F0<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u67E5\u770B\u65E5\u5FD7</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ kubectl logs <span class="token operator">&lt;</span>Pod\u540D\u79F0<span class="token operator">&gt;</span> <span class="token punctuation">[</span>-c container<span class="token punctuation">]</span>
$ kubectl logs <span class="token operator">&lt;</span>Pod\u540D\u79F0<span class="token operator">&gt;</span> <span class="token punctuation">[</span>-c container<span class="token punctuation">]</span> <span class="token parameter variable">-f</span> 

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl logs web container1 </span>
/docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration
/docker-entrypoint.sh: Looking <span class="token keyword">for</span> shell scripts <span class="token keyword">in</span> /docker-entrypoint.d/
/docker-entrypoint.sh: Launching /docker-entrypoint.d/10-listen-on-ipv6-by-default.sh
<span class="token number">10</span>-listen-on-ipv6-by-default.sh: info: Getting the checksum of /etc/nginx/conf.d/default.conf
<span class="token number">10</span>-listen-on-ipv6-by-default.sh: info: Enabled listen on IPv6 <span class="token keyword">in</span> /etc/nginx/conf.d/default.conf
/docker-entrypoint.sh: Launching /docker-entrypoint.d/20-envsubst-on-templates.sh
/docker-entrypoint.sh: Launching /docker-entrypoint.d/30-tune-worker-processes.sh
/docker-entrypoint.sh: Configuration complete<span class="token punctuation">;</span> ready <span class="token keyword">for</span> start up
<span class="token number">2021</span>/10/27 02:26:25 <span class="token punctuation">[</span>notice<span class="token punctuation">]</span> <span class="token number">1</span><span class="token comment">#1: using the &quot;epoll&quot; event method</span>
<span class="token number">2021</span>/10/27 02:26:25 <span class="token punctuation">[</span>notice<span class="token punctuation">]</span> <span class="token number">1</span><span class="token comment">#1: nginx/1.21.3</span>
<span class="token number">2021</span>/10/27 02:26:25 <span class="token punctuation">[</span>notice<span class="token punctuation">]</span> <span class="token number">1</span><span class="token comment">#1: built by gcc 8.3.0 (Debian 8.3.0-6) </span>
<span class="token number">2021</span>/10/27 02:26:25 <span class="token punctuation">[</span>notice<span class="token punctuation">]</span> <span class="token number">1</span><span class="token comment">#1: OS: Linux 3.10.0-862.2.3.el7.x86_64</span>
<span class="token number">2021</span>/10/27 02:26:25 <span class="token punctuation">[</span>notice<span class="token punctuation">]</span> <span class="token number">1</span><span class="token comment">#1: getrlimit(RLIMIT_NOFILE): 1048576:1048576</span>
<span class="token number">2021</span>/10/27 02:26:25 <span class="token punctuation">[</span>notice<span class="token punctuation">]</span> <span class="token number">1</span><span class="token comment">#1: start worker processes</span>
<span class="token number">2021</span>/10/27 02:26:25 <span class="token punctuation">[</span>notice<span class="token punctuation">]</span> <span class="token number">1</span><span class="token comment">#1: start worker process 31</span>
<span class="token number">2021</span>/10/27 02:26:25 <span class="token punctuation">[</span>notice<span class="token punctuation">]</span> <span class="token number">1</span><span class="token comment">#1: start worker process 32</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u8FDB\u5165\u5BB9\u5668\u7EC8\u7AEF</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ kubectl <span class="token builtin class-name">exec</span> <span class="token operator">&lt;</span>Pod\u540D\u79F0<span class="token operator">&gt;</span> <span class="token punctuation">[</span>-c container<span class="token punctuation">]</span> <span class="token parameter variable">--bash</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>\u5220\u9664Pod</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ kubectl delete pod <span class="token operator">&lt;</span>Pod\u540D\u79F0<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="pod\u5BF9\u8C61-\u91CD\u542F\u7B56\u7565-\u5065\u5EB7\u68C0\u67E5" tabindex="-1"><a class="header-anchor" href="#pod\u5BF9\u8C61-\u91CD\u542F\u7B56\u7565-\u5065\u5EB7\u68C0\u67E5" aria-hidden="true">#</a> Pod\u5BF9\u8C61\uFF1A\u91CD\u542F\u7B56\u7565+\u5065\u5EB7\u68C0\u67E5</h3><h3 id="\u91CD\u542F\u7B56\u7565" tabindex="-1"><a class="header-anchor" href="#\u91CD\u542F\u7B56\u7565" aria-hidden="true">#</a> <code>\u91CD\u542F\u7B56\u7565</code></h3><ul><li><p><code>Always\uFF1A</code> \u5F53\u5BB9\u5668\u7EC8\u6B62\u9000\u51FA\u540E\uFF0C\u603B\u662F\u91CD\u542F\u5BB9\u5668\uFF0C\u9ED8\u8BA4\u7B56\u7565\u3002</p></li><li><p><code>OnFailure\uFF1A</code> \u5F53\u5BB9\u5668\u5F02\u5E38\u9000\u51FA\u540E\uFF0C\uFF08\u9000\u51FA\u72B6\u6001\u7801\u975E0\uFF09\u65F6\uFF0C\u624D\u91CD\u542F\u5BB9\u5668\u3002</p></li><li><p><code>Never\uFF1A</code> \u5F53\u5BB9\u5668\u7EC8\u6B62\u9000\u51FA\uFF0C\u4ECE\u4E0D\u91CD\u542F\u5BB9\u5668\u3002</p></li></ul><h3 id="\u5065\u5EB7\u68C0\u67E5\u6709\u4EE5\u4E0B\u4E24\u79CD\u7C7B\u578B" tabindex="-1"><a class="header-anchor" href="#\u5065\u5EB7\u68C0\u67E5\u6709\u4EE5\u4E0B\u4E24\u79CD\u7C7B\u578B" aria-hidden="true">#</a> <code>\u5065\u5EB7\u68C0\u67E5\u6709\u4EE5\u4E0B\u4E24\u79CD\u7C7B\u578B</code></h3><ul><li><p><code>livenessProbe\uFF08\u5B58\u6D3B\u68C0\u67E5\uFF09\uFF1A</code> \u5982\u679C\u68C0\u67E5\u5931\u8D25\uFF0C\u5C06\u6740\u6B7B\u5BB9\u5668\uFF0C\u6839\u636EPod\u7684restartPolicy\u6765\u64CD\u4F5C\u3002</p></li><li><p><code>readinessProbe\uFF08\u5C31\u7EEA\u68C0\u67E5\uFF09\uFF1A</code> \u5982\u679C\u68C0\u67E5\u5931\u8D25\uFF0CKubernetes\u4F1A\u628APod\u4ECEservice endpoints\u4E2D\u5254\u9664\u3002</p></li></ul><h3 id="\u652F\u6301\u4EE5\u4E0B\u4E09\u79CD\u68C0\u67E5\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u652F\u6301\u4EE5\u4E0B\u4E09\u79CD\u68C0\u67E5\u65B9\u6CD5" aria-hidden="true">#</a> <code>\u652F\u6301\u4EE5\u4E0B\u4E09\u79CD\u68C0\u67E5\u65B9\u6CD5</code></h3><ul><li><p><code>httpGet\uFF1A</code> \u53D1\u9001http\u8BF7\u6C42\uFF0C\u8FD4\u56DE200-400\u8303\u56F4\u72B6\u6001\u7801\u4E3A\u6210\u529F\u3002</p></li><li><p><code>exec\uFF1A </code> \u6267\u884CShell\u547D\u4EE4\u8FD4\u56DE\u72B6\u6001\u7801\u662F0\u4E3A\u6210\u529F\u3002</p></li><li><p><code>tcpSocket\uFF1A</code> \u53D1\u8D77TCP Socket\u5EFA\u7ACB\u6210\u529F\u3002</p></li></ul><p><strong>\u7AEF\u53E3\u63A2\u6D4B</strong></p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># cat pod.yaml  </span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> web
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">restartPolicy</span><span class="token punctuation">:</span> Always		   <span class="token comment">#\u91CD\u542F\u7B56\u7565 </span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx
    <span class="token key atrule">name</span><span class="token punctuation">:</span> web
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
    <span class="token key atrule">readinessProbe</span><span class="token punctuation">:</span> 		   <span class="token comment">#\u7AEF\u53E3\u63A2\u6D4B</span>
      <span class="token key atrule">tcpSocket</span><span class="token punctuation">:</span> 
        <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span> 			   <span class="token comment">#\u63A2\u6D4B\u7684\u7AEF\u53E3\u662F80	</span>
      <span class="token key atrule">initialDelaySeconds</span><span class="token punctuation">:</span> <span class="token number">30</span>  <span class="token comment">#\u542F\u52A8\u5BB9\u5668\u540E\u591A\u5C11\u79D2\u5065\u5EB7\u68C0\u67E5</span>
      <span class="token key atrule">periodSeconds</span><span class="token punctuation">:</span> <span class="token number">10</span>        <span class="token comment">#\u4EE5\u540E\u95F4\u9694\u591A\u5C11\u79D2\u68C0\u67E5\u4E00\u6B21</span>
        
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f pod.yaml        </span>
pod/web created
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get  pods </span>
NAME   READY   STATUS    RESTARTS   AGE
web    0/1     Running   0          97s

\u9700\u8981\u7B49\u5230\u7AEF\u53E3\u63A2\u6D4B\u5B8C\u6210\u4E4B\u540E\u624D\u80FDready
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get  pods </span>
NAME   READY   STATUS    RESTARTS   AGE
web    1/1     Running   0          97s
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>http\u8BF7\u6C42\u7684\u5065\u5EB7\u68C0\u67E5</strong></p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># vim pod.yaml  </span>
      <span class="token key atrule">tcpSocket</span><span class="token punctuation">:</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> web
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx
    <span class="token key atrule">name</span><span class="token punctuation">:</span> web
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
    <span class="token key atrule">readinessProbe</span><span class="token punctuation">:</span>
      <span class="token key atrule">httpGet</span><span class="token punctuation">:</span>
        <span class="token key atrule">path</span><span class="token punctuation">:</span> /index.html
        <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>
      <span class="token key atrule">initialDelaySeconds</span><span class="token punctuation">:</span> <span class="token number">30</span>
      <span class="token key atrule">periodSeconds</span><span class="token punctuation">:</span> <span class="token number">10</span>
      

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f pod.yaml  </span>
pod/web created

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get pods </span>
NAME   READY   STATUS    RESTARTS   AGE
web    0/1     Running   0          19s
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u67E5\u770B\u65E5\u5FD7\u68C0\u67E5\u662F\u5426\u6709\u5065\u5EB7\u68C0\u67E5\u6210\u529F</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl logs web web -f </span>
/docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration
/docker-entrypoint.sh: Looking <span class="token keyword">for</span> shell scripts <span class="token keyword">in</span> /docker-entrypoint.d/
/docker-entrypoint.sh: Launching /docker-entrypoint.d/10-listen-on-ipv6-by-default.sh
<span class="token number">10</span>-listen-on-ipv6-by-default.sh: info: Getting the checksum of /etc/nginx/conf.d/default.conf
<span class="token number">10</span>-listen-on-ipv6-by-default.sh: info: Enabled listen on IPv6 <span class="token keyword">in</span> /etc/nginx/conf.d/default.conf
/docker-entrypoint.sh: Launching /docker-entrypoint.d/20-envsubst-on-templates.sh
/docker-entrypoint.sh: Launching /docker-entrypoint.d/30-tune-worker-processes.sh
/docker-entrypoint.sh: Configuration complete<span class="token punctuation">;</span> ready <span class="token keyword">for</span> start up
<span class="token number">2021</span>/10/27 <span class="token number">12</span>:10:13 <span class="token punctuation">[</span>notice<span class="token punctuation">]</span> <span class="token number">1</span><span class="token comment">#1: using the &quot;epoll&quot; event method</span>
<span class="token number">2021</span>/10/27 <span class="token number">12</span>:10:13 <span class="token punctuation">[</span>notice<span class="token punctuation">]</span> <span class="token number">1</span><span class="token comment">#1: nginx/1.21.3</span>
<span class="token number">2021</span>/10/27 <span class="token number">12</span>:10:13 <span class="token punctuation">[</span>notice<span class="token punctuation">]</span> <span class="token number">1</span><span class="token comment">#1: built by gcc 8.3.0 (Debian 8.3.0-6) </span>
<span class="token number">2021</span>/10/27 <span class="token number">12</span>:10:13 <span class="token punctuation">[</span>notice<span class="token punctuation">]</span> <span class="token number">1</span><span class="token comment">#1: OS: Linux 3.10.0-862.2.3.el7.x86_64</span>
<span class="token number">2021</span>/10/27 <span class="token number">12</span>:10:13 <span class="token punctuation">[</span>notice<span class="token punctuation">]</span> <span class="token number">1</span><span class="token comment">#1: getrlimit(RLIMIT_NOFILE): 1048576:1048576</span>
<span class="token number">2021</span>/10/27 <span class="token number">12</span>:10:13 <span class="token punctuation">[</span>notice<span class="token punctuation">]</span> <span class="token number">1</span><span class="token comment">#1: start worker processes</span>
<span class="token number">2021</span>/10/27 <span class="token number">12</span>:10:13 <span class="token punctuation">[</span>notice<span class="token punctuation">]</span> <span class="token number">1</span><span class="token comment">#1: start worker process 31</span>
<span class="token number">2021</span>/10/27 <span class="token number">12</span>:10:13 <span class="token punctuation">[</span>notice<span class="token punctuation">]</span> <span class="token number">1</span><span class="token comment">#1: start worker process 32</span>
<span class="token number">172.25</span>.253.138 - - <span class="token punctuation">[</span><span class="token number">27</span>/Oct/2021:12:10:45 +0000<span class="token punctuation">]</span> <span class="token string">&quot;GET /index.html HTTP/1.1&quot;</span> <span class="token number">200</span> <span class="token number">615</span> <span class="token string">&quot;-&quot;</span> <span class="token string">&quot;kube-probe/1.20&quot;</span> <span class="token string">&quot;-&quot;</span>
<span class="token number">172.25</span>.253.138 - - <span class="token punctuation">[</span><span class="token number">27</span>/Oct/2021:12:10:55 +0000<span class="token punctuation">]</span> <span class="token string">&quot;GET /index.html HTTP/1.1&quot;</span> <span class="token number">200</span> <span class="token number">615</span> <span class="token string">&quot;-&quot;</span> <span class="token string">&quot;kube-probe/1.20&quot;</span> <span class="token string">&quot;-&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u793A\u4F8B\uFF1A\u6267\u884CShell\u547D\u4EE4</strong></p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">livenessProbe</span><span class="token punctuation">:</span> 
  <span class="token key atrule">exec</span><span class="token punctuation">:</span> 
    <span class="token key atrule">command</span><span class="token punctuation">:</span> 
    <span class="token punctuation">-</span> cat
    <span class="token punctuation">-</span> /tmp/healthy
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u793A\u4F8B\uFF1AHTTP\u8BF7\u6C42</strong></p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">livenessProbe</span><span class="token punctuation">:</span> 
  <span class="token key atrule">httpGet</span><span class="token punctuation">:</span> 
    <span class="token key atrule">path</span><span class="token punctuation">:</span> /healthz 
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span>
    <span class="token key atrule">httpHeaders</span><span class="token punctuation">:</span> 
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Custom<span class="token punctuation">-</span>Header
      <span class="token key atrule">value</span><span class="token punctuation">:</span> Awesome
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="pod\u5BF9\u8C61-lnit-container" tabindex="-1"><a class="header-anchor" href="#pod\u5BF9\u8C61-lnit-container" aria-hidden="true">#</a> Pod\u5BF9\u8C61\uFF1Alnit Container</h3><p><strong>lnit Container\uFF1A \u987E\u540D\u601D\u4E49\uFF0C\u7528\u4E8E\u521D\u59CB\u5316\u5DE5\u4F5C\uFF0C\u6267\u884C\u5B8C\u5C31\u7ED3\u675F\uFF0C\u53EF\u4EE5\u7406\u89E3\u4E3A\u4E00\u6B21\u6027\u4EFB\u52A1\u3002</strong></p><ul><li><code>\u652F\u6301\u5927\u90E8\u5206\u5E94\u7528\u5BB9\u5668\u914D\u7F6E\uFF0C\u4F46\u4E0D\u652F\u6301\u5065\u5EB7\u68C0\u67E5</code></li><li><code>\u4F18\u5148\u5E94\u7528\u5BB9\u5668\u6267\u884C</code></li></ul><p><strong>\u5E94\u7528\u573A\u666F\uFF1A</strong></p><ul><li><code>\u73AF\u5883\u68C0\u67E5\uFF1A \u4F8B\u5982\u786E\u4FDD\u5E94\u7528\u5BB9\u5668\u4F9D\u8D56\u7684\u670D\u52A1\u542F\u52A8\u540E\u518D\u542F\u52A8\u5E94\u7528\u5BB9\u5668</code></li><li><code>\u521D\u59CB\u5316\u914D\u7F6E\uFF1A \u4F8B\u5982\u7ED9\u5E94\u7528\u5BB9\u5668\u51C6\u5907\u914D\u7F6E\u6587\u4EF6</code></li></ul><p><strong>\u793A\u4F8B\uFF1A\u90E8\u7F72\u4E00\u4E2Aweb\u7F51\u7AD9\uFF0C\u7F51\u7AD9\u7A0B\u5E8F\u6CA1\u6709\u6253\u5305\u5230\u955C\u50CF\u4E2D\uFF0C\u800C\u662F\u5E0C\u671B\u4ECE\u4EE3\u7801\u4ED3\u5E93\u4E2D\u52A8\u6001\u62C9\u53D6\u653E\u5230\u5E94\u7528\u5BB9\u5668\u4E2D\u3002</strong></p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># cat init-container.yaml  </span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> init<span class="token punctuation">-</span>demo
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">initContainers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> busybox
    <span class="token key atrule">name</span><span class="token punctuation">:</span> init<span class="token punctuation">-</span>demo
    <span class="token key atrule">command</span><span class="token punctuation">:</span> 
    <span class="token punctuation">-</span> wget 
    <span class="token punctuation">-</span> <span class="token string">&quot;-O&quot;</span>
    <span class="token punctuation">-</span> <span class="token string">&quot;/opt/index.html&quot;</span>
    <span class="token punctuation">-</span> <span class="token string">&quot;http://www.ctnrs.com&quot;</span>
    <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> wwwroot
      <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> <span class="token string">&quot;/opt&quot;</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span> 
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx 
    <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx 
    <span class="token key atrule">ports</span><span class="token punctuation">:</span> 
    <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span> 
    <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span> 
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> wwwroot 
      <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> /usr/share/nginx/html 
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span> 
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> wwwroot 
    <span class="token key atrule">emptyDir</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f init-container.yaml  </span>
pod/init-demo created
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u56E0\u6B64\uFF0CPod\u4E2D\u4F1A\u6709\u8FD9\u51E0\u79CD\u7C7B\u578B\u7684\u5BB9\u5668\uFF1A</strong></p><ul><li><p><strong><code>Infrastructure Container:</code></strong> \u57FA\u7840\u5BB9\u5668</p><ul><li>\u7EF4\u62A4\u6574\u4E2APod\u7684\u7F51\u7EDC</li></ul></li><li><p><strong><code>InitContainers\uFF1A</code></strong> \u521D\u59CB\u5316\u5BB9\u5668</p><ul><li>\u5148\u4E8E\u4E1A\u52A1\u5BB9\u5668\u5F00\u59CB\u6267\u884C</li></ul></li><li><p><strong><code>Containers\uFF1A</code></strong> \u4E1A\u52A1\u5BB9\u5668</p><ul><li>\u5E76\u884C\u542F\u52A8</li></ul></li></ul><h3 id="pod\u5BF9\u8C61-\u9759\u6001pod" tabindex="-1"><a class="header-anchor" href="#pod\u5BF9\u8C61-\u9759\u6001pod" aria-hidden="true">#</a> Pod\u5BF9\u8C61\uFF1A\u9759\u6001Pod</h3>`,39),Xn=n("em",null,"\u9759\u6001 Pod\uFF08Static Pod\uFF09",-1),Wn=n("code",null,"kubelet",-1),Zn={href:"https://kubernetes.io/zh/docs/reference/command-line-tools-reference/kube-apiserver/",target:"_blank",rel:"noopener noreferrer"},Qn={href:"https://kubernetes.io/zh/docs/concepts/workloads/controllers/deployment/",target:"_blank",rel:"noopener noreferrer"},ns=n("code",null,"kubelet",-1),ss={href:"https://kubernetes.io/docs/reference/generated/kubelet",target:"_blank",rel:"noopener noreferrer"},es=n("code",null,"kubelet",-1),as={href:"https://kubernetes.io/zh/docs/concepts/overview/components/#control-plane-components",target:"_blank",rel:"noopener noreferrer"},ts=n("code",null,"kubelet",-1),ls={href:"https://kubernetes.io/zh/docs/reference/glossary/?all=true#term-mirror-pod",target:"_blank",rel:"noopener noreferrer"},os=n("p",null,[n("strong",null,"\u8BF4\u660E\uFF1A")],-1),is=n("code",null,"spec",-1),cs={href:"https://kubernetes.io/zh/docs/tasks/configure-pod-container/configure-service-account/",target:"_blank",rel:"noopener noreferrer"},ps={href:"https://kubernetes.io/zh/docs/tasks/configure-pod-container/configure-pod-configmap/",target:"_blank",rel:"noopener noreferrer"},rs={href:"https://kubernetes.io/zh/docs/concepts/configuration/secret/",target:"_blank",rel:"noopener noreferrer"},ds=t(`<h3 id="\u9759\u6001pod\u7684\u7279\u70B9" tabindex="-1"><a class="header-anchor" href="#\u9759\u6001pod\u7684\u7279\u70B9" aria-hidden="true">#</a> \u9759\u6001Pod\u7684\u7279\u70B9\uFF1A</h3><ul><li><strong>Pod\u7531\u7279\u5B9A\u8282\u70B9\u4E0A\u7684kubelet\u7BA1\u7406</strong></li><li><strong>\u4E0D\u80FD\u4F7F\u7528\u63A7\u5236\u5668</strong></li><li><strong>Pod\u7684\u540D\u79F0\u6807\u8BC6\u5F53\u524D\u8282\u70B9\u7684\u540D\u79F0</strong></li><li><strong>\u5728kubelet\u7684\u914D\u7F6E\u6587\u4EF6\u4E0B\u542F\u52A8Pod\u65E0\u6CD5\u4F7F\u7528kubectl\u5220\u9664\uFF0C\u53EA\u80FD\u5220\u9664yaml\u6587\u4EF6\uFF0C\u65B9\u4FBF\u66F4\u65B0\u6570\u636E</strong></li></ul><h3 id="\u5728kubelet\u914D\u7F6E\u6587\u4EF6\u4E2D\u542F\u7528\u9759\u6001pod" tabindex="-1"><a class="header-anchor" href="#\u5728kubelet\u914D\u7F6E\u6587\u4EF6\u4E2D\u542F\u7528\u9759\u6001pod" aria-hidden="true">#</a> \u5728kubelet\u914D\u7F6E\u6587\u4EF6\u4E2D\u542F\u7528\u9759\u6001Pod\uFF1A</h3><div class="language-http ext-http line-numbers-mode"><pre class="language-http"><code>[root@master ~]# cat /var/lib/kubelet/config.yaml | grep staticPodPath:
<span class="token header"><span class="token header-name keyword">staticPodPath</span><span class="token punctuation">:</span> <span class="token header-value">/etc/kubernetes/manifests</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># cd /etc/kubernetes/manifests/</span>
<span class="token punctuation">[</span>root@master manifests<span class="token punctuation">]</span><span class="token comment"># vim pod.yaml </span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">run</span><span class="token punctuation">:</span> mypod1
  <span class="token key atrule">name</span><span class="token punctuation">:</span> static<span class="token punctuation">-</span>pod
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> busybox
    <span class="token key atrule">name</span><span class="token punctuation">:</span> mypod1
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;/bin/sh&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-c&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;sleep 360000&quot;</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="deployment" tabindex="-1"><a class="header-anchor" href="#deployment" aria-hidden="true">#</a> Deployment</h2><img src="https://pic.imgdb.cn/item/61ebecb52ab3f51d9113a1c2.png" style="zoom:67%;"><h3 id="deployment-\u5E94\u7528\u751F\u547D\u5468\u671F\u7BA1\u7406\u6D41\u7A0B" tabindex="-1"><a class="header-anchor" href="#deployment-\u5E94\u7528\u751F\u547D\u5468\u671F\u7BA1\u7406\u6D41\u7A0B" aria-hidden="true">#</a> Deployment\uFF1A\u5E94\u7528\u751F\u547D\u5468\u671F\u7BA1\u7406\u6D41\u7A0B</h3><img src="https://pic.imgdb.cn/item/61ebecb52ab3f51d9113a1cb.png" style="zoom:67%;"><h3 id="deployment-\u90E8\u7F72\u5E94\u7528" tabindex="-1"><a class="header-anchor" href="#deployment-\u90E8\u7F72\u5E94\u7528" aria-hidden="true">#</a> Deployment\uFF1A\u90E8\u7F72\u5E94\u7528</h3><ul><li><strong>\u521B\u5EFAdeployment\u7684yaml\u6587\u4EF6</strong></li></ul><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># cat deployment.yaml  </span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> web
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">3</span> 				<span class="token comment"># Pod\u526F\u672C\u9884\u671F\u6570\u91CF</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> web
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> web 			<span class="token comment"># Pod\u526F\u672C\u7684\u6807\u7B7E</span>
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> web
        <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>\u90E8\u7F72nginx\u955C\u50CF</strong></li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f deployment.yaml  </span>
deployment.apps/web unchanged
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get  deployment </span>
NAME   READY   UP-TO-DATE   AVAILABLE   AGE
web    <span class="token number">2</span>/3     <span class="token number">2</span>            <span class="token number">2</span>           3m
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="deployment-\u6EDA\u52A8\u5347\u7EA7" tabindex="-1"><a class="header-anchor" href="#deployment-\u6EDA\u52A8\u5347\u7EA7" aria-hidden="true">#</a> Deployment\uFF1A\u6EDA\u52A8\u5347\u7EA7</h3><p><strong><code>\u7B2C\u4E8C\u6B65\uFF1A\u5E94\u7528\u5347\u7EA7\uFF08\u66F4\u65B0\u955C\u50CF\u4E09\u79CD\u65B9\u5F0F\uFF09</code></strong></p><ul><li>kubectl apply -f xxx.yaml</li><li>kubectl set image deployment/web nginx=nginx:1.16</li><li>kubectl edit deployment/web</li><li>\u6EDA\u52A8\u5347\u7EA7\uFF1AK8s\u5BF9Pod\u5347\u7EA7\u7684\u9ED8\u8BA4\u7B56\u7565\uFF0C\u901A\u8FC7\u4F7F \u7528\u65B0\u7248\u672CPod\u9010\u6B65\u66F4\u65B0\u65E7\u7248\u672CPod\uFF0C\u5B9E\u73B0\u96F6\u505C\u673A \u53D1\u5E03\uFF0C\u7528\u6237\u65E0\u611F\u77E5\u3002</li></ul><p><strong>\u4F7F\u7528kubectl set\u5B9E\u73B0\u6EDA\u52A8\u5347\u7EA7</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment">#  kubectl set image deployment/web  web=nginx:1.16  </span>
deployment.apps/web image updated
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><img src="https://pic.imgdb.cn/item/61ebecb52ab3f51d9113a1d3.png" style="zoom:67%;"><h3 id="deployment-\u6C34\u5E73\u6269\u7F29\u5BB9" tabindex="-1"><a class="header-anchor" href="#deployment-\u6C34\u5E73\u6269\u7F29\u5BB9" aria-hidden="true">#</a> Deployment\uFF1A\u6C34\u5E73\u6269\u7F29\u5BB9</h3><p><strong><code>\u7B2C\u4E09\u6B65\uFF1A\u6C34\u5E73\u6269\u7F29\u5BB9\uFF08\u542F\u52A8\u591A\u5B9E\u4F8B\uFF0C\u63D0\u9AD8\u5E76\u53D1\uFF09</code></strong></p><ul><li><p>\u4FEE\u6539yaml\u91CCreplicas\u503C\uFF0C\u518Dapply</p></li><li><p>kubectl scale deployment web --replicas=10</p><p>\u6CE8\uFF1Areplicas\u53C2\u6570\u63A7\u5236Pod\u526F\u672C\u6570\u91CF</p></li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl scale deployment/web --replicas=10 </span>
deployment.apps/web scaled

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get  deployment</span>
NAME   READY   UP-TO-DATE   AVAILABLE   AGE
web    <span class="token number">2</span>/10    <span class="token number">0</span>            <span class="token number">2</span>           16m
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="deployment-\u56DE\u6EDA" tabindex="-1"><a class="header-anchor" href="#deployment-\u56DE\u6EDA" aria-hidden="true">#</a> Deployment\uFF1A\u56DE\u6EDA</h3><p><strong><code>\u7B2C\u56DB\u6B65\uFF1A\u56DE\u6EDA\uFF08\u53D1\u5E03\u5931\u8D25\u6062\u590D\u6B63\u5E38\u7248\u672C\uFF09</code></strong></p><ul><li>kubectl rollout history deployment/web # \u67E5\u770B\u5386\u53F2\u53D1\u5E03\u7248\u672C</li><li>kubectl rollout undo deployment/web # \u56DE\u6EDA\u4E0A\u4E00\u4E2A\u7248\u672C</li><li>kubectl rollout undo deployment/web --to-revision=2 # \u56DE\u6EDA\u5386\u53F2\u6307\u5B9A\u7248\u672C</li><li>\u6CE8\uFF1A\u56DE\u6EDA\u662F\u91CD\u65B0\u90E8\u7F72\u67D0\u4E00\u6B21\u90E8\u7F72\u65F6\u7684\u72B6\u6001\uFF0C\u5373\u5F53\u65F6\u7248\u672C\u6240\u6709\u914D\u7F6E</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl rollout history deployment/web </span>
deployment.apps/web 
REVISION  CHANGE-CAUSE
<span class="token number">1</span>         <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
<span class="token number">2</span>         <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl rollout undo deployment/web        </span>
deployment.apps/web rolled back

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl rollout undo deployment/web --to-revision=2 </span>
deployment.apps/web rolled back
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="deployment-\u5220\u9664" tabindex="-1"><a class="header-anchor" href="#deployment-\u5220\u9664" aria-hidden="true">#</a> Deployment\uFF1A\u5220\u9664</h3><p><strong><code>\u6700\u540E\uFF0C\u9879\u76EE\u4E0B\u7EBF\uFF1A</code></strong></p><ul><li>kubectl delete deploy/web</li><li>kubectl delete svc/web</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl delete deployment/web </span>
deployment.apps <span class="token string">&quot;web&quot;</span> deleted
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="deployment-\u6EDA\u52A8\u5347\u7EA7\u4E0E\u56DE\u6EDA\u5B9E\u73B0\u673A\u5236" tabindex="-1"><a class="header-anchor" href="#deployment-\u6EDA\u52A8\u5347\u7EA7\u4E0E\u56DE\u6EDA\u5B9E\u73B0\u673A\u5236" aria-hidden="true">#</a> Deployment\uFF1A\u6EDA\u52A8\u5347\u7EA7\u4E0E\u56DE\u6EDA\u5B9E\u73B0\u673A\u5236</h3><p><strong><code>\u6EDA\u52A8\u66F4\u65B0\u7B56\u7565</code></strong></p><p>\u6BCF\u6B21\u53EA\u5347\u7EA7\u4E00\u4E2A\u6216\u591A\u4E2A\u670D\u52A1\uFF0C\u5347\u7EA7\u5B8C\u6210\u52A0\u5165\u751F\u4EA7\u73AF\u5883\uFF0C\u4E0D\u65AD\u6267\u884C\u8FD9\u4E2A\u8FC7 \u7A0B\uFF0C\u76F4\u5230\u96C6\u7FA4\u4E2D\u7684\u5168\u90E8\u65E7\u7248\u5347\u7EA7\u65B0\u7248\u672C\u3002</p><p><strong>\u7279\u70B9\uFF1A</strong></p><ul><li>\u7528\u6237\u65E0\u611F\u77E5\uFF0C\u5E73\u6ED1\u8FC7\u6E21</li></ul><p><strong>\u7F3A\u70B9\uFF1A</strong></p><ul><li>\u90E8\u7F72\u5468\u671F\u957F</li><li>\u53D1\u5E03\u7B56\u7565\u8F83\u590D\u6742</li></ul><h2 id="replicationcontroller\u548Creplicaset" tabindex="-1"><a class="header-anchor" href="#replicationcontroller\u548Creplicaset" aria-hidden="true">#</a> ReplicationController\u548CReplicaSet</h2><h3 id="replicationcontroller" tabindex="-1"><a class="header-anchor" href="#replicationcontroller" aria-hidden="true">#</a> ReplicationController</h3><ul><li><code>\u5B9E\u9645\u5DE5\u4F5C\u4E2D\uFF0C\u5F88\u5C11\u5355\u72EC\u64CD\u4F5CPod\u7684\uFF0C\u4E4B\u6240\u4EE5k8s\u80FD\u591F\u201C\u81EA\u6108\u201D\uFF0C\u5C31\u662F\u901A\u8FC7rc\uFF08ReplicationController\uFF09\u3001rs\uFF08ReplicaSet\uFF09\u3001Deployment\u7B49\u8FD9\u4E9B\u7EC4\u4EF6\uFF0C\u518D\u52A0\u4E0Ak8s\u6838\u5FC3controller\u5DE5\u4F5C\u673A\u5236\u6765\u5B9E\u73B0\u7684\u3002</code></li><li><code>ReplicationController\uFF08\u7B80\u79F0\u4E3ARC\uFF09\u3002</code> \u5728\u65E7\u7248\u672C\u7684Kubernetes\u4E2D\uFF0C\u53EA\u6709ReplicationController\u5BF9\u8C61\u3002\u5B83\u7684\u4E3B\u8981\u4F5C\u7528\u662F\u786E\u4FDDPod\u4EE5\u4F60\u6307\u5B9A\u7684\u526F\u672C\u6570\u8FD0\u884C\uFF0C\u5373\u5982\u679C\u6709\u5BB9\u5668\u5F02\u5E38\u9000\u51FA\uFF0C\u4F1A\u81EA\u52A8\u521B\u5EFA\u65B0\u7684 Pod \u6765\u66FF\u4EE3\uFF1B\u800C\u5F02\u5E38\u591A\u51FA\u6765\u7684\u5BB9\u5668\u4E5F\u4F1A\u81EA\u52A8\u56DE\u6536\u3002\u53EF\u4EE5\u8BF4\uFF0C\u901A\u8FC7ReplicationController\uFF0CKubernetes\u5B9E\u73B0\u4E86\u96C6\u7FA4\u7684\u9AD8\u53EF\u7528\u6027\u3002</li><li><code>ReplicationController\uFF08rc\uFF09\u5728\u65B0\u7684\u7248\u672C\u4E2D\uFF0C\u5DF2\u7ECF\u88ABReplicaSet\uFF08rs\uFF09\u66FF\u6362\u4E86\uFF0C\u76F8\u5BF9\u4E8Erc\uFF0Crs\u6709\u66F4\u597D\u7684\u6807\u7B7E\u63A7\u5236\u7B56\u7565\u3002</code>\u5BF9\u4E8Epod\u526F\u672C\u7684\u63A7\u5236\u4F5C\u7528\uFF0Crs\u548Crc\u7684\u6548\u679C\u662F\u4E00\u6837\u7684\u3002**</li></ul><h3 id="replicationcontroller\u7684\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#replicationcontroller\u7684\u4F7F\u7528" aria-hidden="true">#</a> ReplicationController\u7684\u4F7F\u7528</h3><ul><li>\u521B\u5EFA\u4E00\u4E2ARC</li><li>\u5FEB\u901F\u751F\u6210\u4E00\u4E2Adeployment\u7136\u540E\u4FEE\u6539\u7C7B\u578B\u4E3Areplicationcontroller</li></ul><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># cat  nginx.yaml 									</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1						<span class="token comment">#api\u7684\u7248\u672C\u7528v1\uFF0Cdeployment\u9ED8\u8BA4\u662Fapps/v1</span>
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ReplicationController			<span class="token comment">#\u6307\u5B9A\u8D44\u6E90\u7C7B\u578B\u662FReplicationController</span>
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> test<span class="token punctuation">-</span>rc
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">3</span>						<span class="token comment">#\u526F\u672C\u63A7\u5236\u57283</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> test<span class="token punctuation">-</span>rc					<span class="token comment">#\u6807\u7B7E\u9009\u62E9\u5668</span>
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> test<span class="token punctuation">-</span>rc
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx
        <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
        <span class="token key atrule">ports</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span>

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f replicationcontroller.yaml </span>
replicationcontroller/test<span class="token punctuation">-</span>rc created
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u9A8C\u8BC1\u64CD\u4F5C</strong></p><ul><li>\u67E5\u770B\u751F\u6210\u7684rc\uFF0C\u67E5\u770Bpod\u526F\u672C\u6570\u3002</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl delete rc nginx-demo </span>
replicationcontroller <span class="token string">&quot;nginx-demo&quot;</span> deleted
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get rc</span>
NAME      DESIRED   CURRENT   READY   AGE
test-rc   <span class="token number">3</span>         <span class="token number">3</span>         <span class="token number">3</span>       2m53s
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get pods </span>
NAME            READY   STATUS    RESTARTS   AGE
test-rc-v952c   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          3m
test-rc-vr252   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          3m
test-rc-x42p9   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          3m
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>\u64CD\u4F5Cpod\uFF0C\u9A8C\u8BC1rc\u7684\u526F\u672C\u63A7\u5236\u6548\u679C\u3002</p></blockquote><ul><li>\u53EF\u4EE5\u76F4\u63A5\u5220\u9664pod\uFF0C\u4F46\u7531\u4E8Erc\u8BBE\u7F6E\u4E86\u76EE\u6807\u526F\u672C\u6570\u2014\u20143\u4E2A\uFF0C\u6240\u4EE5\u4F7F\u7528kubectl delete\u547D\u4EE4\u5220\u9664pod\u540E\uFF0C\u53C8\u4F1A\u9A6C\u4E0A\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684pod\uFF0C\u4EE5\u4FBF\u7EF4\u63013\u4E2A\u526F\u672C\u3002</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get pods </span>
NAME            READY   STATUS    RESTARTS   AGE
test-rc-v952c   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          3m
test-rc-vr252   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          3m
test-rc-x42p9   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          3m
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl delete pods --all</span>
pod <span class="token string">&quot;test-rc-v952c&quot;</span> deleted
pod <span class="token string">&quot;test-rc-vr252&quot;</span> deleted
pod <span class="token string">&quot;test-rc-x42p9&quot;</span> deleted

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get pods </span>
NAME            READY   STATUS              RESTARTS   AGE
test-rc-dwqpf   <span class="token number">0</span>/1     ContainerCreating   <span class="token number">0</span>          19s
test-rc-r2pjp   <span class="token number">0</span>/1     ContainerCreating   <span class="token number">0</span>          19s
test-rc-s4j58   <span class="token number">1</span>/1     Running             <span class="token number">0</span>          19s
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u4FBF\u6377\u7684\u8FDB\u884C\u6269\u5BB9\u548C\u7F29\u5BB9" tabindex="-1"><a class="header-anchor" href="#\u4FBF\u6377\u7684\u8FDB\u884C\u6269\u5BB9\u548C\u7F29\u5BB9" aria-hidden="true">#</a> <strong>\u4FBF\u6377\u7684\u8FDB\u884C\u6269\u5BB9\u548C\u7F29\u5BB9</strong></h3><ul><li>\u5BF9\u5176Pod\u8FDB\u884C\u6269\u5C55\u4F38\u7F29\uFF0C\u6269\u5C55\u52305\u4E2A\u526F\u672C</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl scale replicationcontroller test-rc --replicas=5</span>
replicationcontroller/test-rc scaled

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get pods </span>
NAME            READY   STATUS    RESTARTS   AGE
test-rc-dwqpf   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          2m12s
test-rc-f75hw   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          33s
test-rc-r2pjp   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          2m12s
test-rc-s4j58   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          2m12s
test-rc-w6tdr   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          33s
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="replicaset" tabindex="-1"><a class="header-anchor" href="#replicaset" aria-hidden="true">#</a> ReplicaSet</h2><ul><li><p><strong>Kubernetes\u5B98\u65B9\u5F3A\u70C8\u5EFA\u8BAE\u907F\u514D\u76F4\u63A5\u4F7F\u7528ReplicaSet\uFF0C\u800C\u5E94\u8BE5\u901A\u8FC7Deployment\u6765\u521B\u5EFARS\u548CPod\u3002\u7531\u4E8EReplicaSet\u662FReplicationController\u7684\u4EE3\u66FF\u7269\uFF0C\u56E0\u6B64\u7528\u6CD5\u57FA\u672C\u76F8\u540C\uFF0C\u552F\u4E00\u7684\u533A\u522B\u5728\u4E8EReplicaSet\u652F\u6301\u96C6\u5408\u5F0F\u7684selector\u3002</strong></p></li><li><p><strong>\u4F5C\u4E3AReplicationController\u7684\u4E0B\u4E00\u4EE3\uFF0C\u652F\u6301\u65B0\u7684\u57FA\u4E8E\u96C6\u5408\u7684\u6807\u7B7E\u9009\u62E9\u7B97\u7B26\u3002</strong></p></li></ul><h3 id="replicaset\u63A7\u5236\u5668\u7528\u9014" tabindex="-1"><a class="header-anchor" href="#replicaset\u63A7\u5236\u5668\u7528\u9014" aria-hidden="true">#</a> <strong>ReplicaSet\u63A7\u5236\u5668\u7528\u9014\uFF1A</strong></h3><p><strong>Pod\u526F\u672C\u6570\u91CF\u7BA1\u7406\uFF0C\u4E0D\u65AD\u5BF9\u6BD4\u5F53\u524DPod\u6570\u91CF\u4E0E\u671F\u671BPod\u6570\u91CF</strong></p><p><strong>Deployment\u6BCF\u6B21\u53D1\u5E03\u90FD\u4F1A\u521B\u5EFA\u4E00\u4E2ARS\u4F5C\u4E3A\u8BB0\u5F55\uFF0C\u7528\u4E8E\u5B9E\u73B0\u56DE\u6EDA</strong></p><ul><li><strong>kubectl get rs #\u67E5\u770BRS\u8BB0\u5F55</strong></li><li><strong>kubectl rollout history deployment web #\u7248\u672C\u5BF9\u5E94RS\u8BB0\u5F55</strong></li></ul><h3 id="replicaset\u7684\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#replicaset\u7684\u4F7F\u7528" aria-hidden="true">#</a> ReplicaSet\u7684\u4F7F\u7528</h3><ul><li><p>\u521B\u5EFA\u4E00\u4E2ARS</p></li><li><p>\u521B\u5EFA\u4E00\u4E2Areplicaset\u7684yaml</p></li></ul><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># cat replicaset.yaml </span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ReplicaSet
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">tier</span><span class="token punctuation">:</span> frontend
  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">3</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">tier</span><span class="token punctuation">:</span> fronted
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">tier</span><span class="token punctuation">:</span> fronted
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx
        <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
        <span class="token key atrule">ports</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f replicaset.yaml </span>
replicaset.apps/nginx created
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u884C\u9A8C\u8BC1replicaset\u548Cpods\u7684\u6570\u91CF</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get replicaset</span>
NAME    DESIRED   CURRENT   READY   AGE
nginx   <span class="token number">3</span>         <span class="token number">3</span>         <span class="token number">3</span>       3m1s

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get  pods</span>
NAME          READY   STATUS    RESTARTS   AGE
nginx-75rjb   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          3m6s
nginx-87ncr   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          3m6s
nginx-xsw76   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          3m6s
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>###ReplicaSet\u7684\u4F38\u7F29</p><ul><li><p><code>\u4F7F\u7528Horizontal Pod Autoscaler\uFF08HPA\uFF09</code></p></li><li><p>RS\u53EF\u4EE5\u901A\u8FC7HPA\u6765\u6839\u636E\u4E00\u4E9B\u8FD0\u884C\u65F6\u6307\u6807\u5B9E\u73B0\u81EA\u52A8\u4F38\u7F29\uFF0C\u4E0B\u9762\u662F\u4E00\u4E2A\u7B80\u5355\u7684\u4F8B\u5B50\uFF1A</p></li><li><p>\u4E0B\u9762\u7684\u63CF\u8FF0\u6587\u4EF6\u4F1A\u521B\u5EFA\u4E00\u4E2A\u540D\u4E3Afrontend-scaler\u7684HorizontalPodAutoscaler\uFF0C\u5B83\u4F1A\u6839\u636ECPU\u7684\u8FD0\u884C\u53C2\u6570\u6765\u5BF9\u540D\u4E3Afrontend\u7684RS\u8FDB\u884C\u81EA\u52A8\u4F38\u7F29\u3002</p></li></ul><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># cat  hpa.yaml  </span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> autoscaling/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> HorizontalPodAutoscaler
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> frontend<span class="token punctuation">-</span>scaler
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">scaleTargetRef</span><span class="token punctuation">:</span>
    <span class="token key atrule">kind</span><span class="token punctuation">:</span> ReplicaSet
    <span class="token key atrule">name</span><span class="token punctuation">:</span> frontend			<span class="token comment">#\u8FD9\u91CC\u5C31\u53EF\u4EE5\u7ED1\u5B9A\u4E0A\u9762\u7684\u6807\u8BB0\u5BF9\u5E94\u7684frontend</span>
  <span class="token key atrule">minReplicas</span><span class="token punctuation">:</span> <span class="token number">3</span>
  <span class="token key atrule">maxReplicas</span><span class="token punctuation">:</span> <span class="token number">10</span>
  <span class="token key atrule">targetCPUUtilizationPercentage</span><span class="token punctuation">:</span> <span class="token number">50</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u67E5\u770Bhpa\u7684\u8BE6\u7EC6</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f hpa.yaml </span>
horizontalpodautoscaler.autoscaling/frontend-scaler created

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get hpa </span>
NAME              REFERENCE             TARGETS         MINPODS   MAXPODS   REPLICAS   AGE
frontend-scaler   ReplicaSet/frontend   <span class="token operator">&lt;</span>unknown<span class="token operator">&gt;</span>/50%   <span class="token number">3</span>         <span class="token number">10</span>        <span class="token number">0</span>          5s
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>\u6700\u540E\u6211\u4EEC\u603B\u7ED3\u4E0B\u5173\u4E8E RC / RS \u7684\u2F00\u4E9B\u7279\u6027\u548C\u4F5C\u2F64\u5427\uFF1A</p></li><li><p>\u2F24\u90E8\u5206\u60C5\u51B5\u4E0B\uFF0C\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7\u5B9A\u4E49\u2F00\u4E2A RC \u5B9E\u73B0\u7684 Pod \u7684\u521B\u5EFA\u548C\u526F\u672C\u6570</p></li><li><p>RC \u4E2D\u5305\u542B\u2F00\u4E2A\u5B8C\u6574\u7684 Pod \u5B9A\u4E49\u6A21\u5757\uFF08\u4E0D\u5305\u542B apiversion \u548C kind)</p></li><li><p>RC \u662F\u901A\u8FC7 label selector \u673A\u5236\u6765\u5B9E\u73B0\u5BF9 Pod \u526F\u672C</p></li><li><p>\u901A\u8FC7\u6539\u53D8 RC \u2FA5\u2FAF\u7684 Pod \u526F\u672C\u6570\u91CF\uFF0C\u53EF\u4EE5\u5B9E\u73B0 Pod \u7684\u6269</p></li><li><p>\u901A\u8FC7\u6539\u53D8 RC \u2FA5\u2FAF\u7684 Pod \u6A21\u677F\u4E2D\u955C\u50CF\u7248\u672C\uFF0C\u53EF\u4EE5\u5B9E\u73B0 Pod \u7684\u6EDA\u52A8\u5347\u7EA7\u529F\u80FD\uFF08\u4F46\u662F\u4E0D\u2F40\u6301\u2F00\u952E\u56DE \u6EDA\uFF0C\u9700\u8981\u2F64\u76F8\u540C\u7684\u2F45\u6CD5\u53BB\u4FEE\u6539\u955C\u50CF\u5730\u5740\uFF09</p></li></ul><h2 id="hpa" tabindex="-1"><a class="header-anchor" href="#hpa" aria-hidden="true">#</a> HPA</h2><h3 id="hpa\u7684\u7B80\u8981\u6982\u8FF0" tabindex="-1"><a class="header-anchor" href="#hpa\u7684\u7B80\u8981\u6982\u8FF0" aria-hidden="true">#</a> HPA\u7684\u7B80\u8981\u6982\u8FF0</h3><ul><li>Kubernetes \u4E3A\u6211\u4EEC\u63D0\u4F9B\u4E86\u8FD9\u6837\u2F00\u4E2A\u8D44\u6E90\u5BF9\u8C61\uFF1A <code>Horizontal Pod Autoscaling \uFF08Pod\u2F54\u5E73\u2F83\u52A8 \u4F38\u7F29\uFF09</code>\uFF0C\u7B80\u79F0 HPA \u3002 HAP \u901A\u8FC7\u76D1\u63A7\u5206\u6790 RC \u6216\u8005 Deployment \u63A7\u5236\u7684\u6240\u6709 Pod \u7684\u8D1F\u8F7D\u53D8\u5316\u60C5\u51B5\u6765\u786E\u5B9A \u662F\u5426\u9700\u8981\u8C03\u6574 Pod \u7684\u526F\u672C\u6570\u91CF\uFF0C\u8FD9\u662F HPA \u6700\u57FA\u672C\u7684\u539F\u7406\u3002</li></ul><img src="https://pic.imgdb.cn/item/61ebeefb2ab3f51d9115f0d9.png" style="zoom:67%;"><ul><li><p>HPA \u5728 kubernetes \u96C6\u7FA4\u4E2D\u88AB\u8BBE\u8BA1\u6210\u2F00\u4E2A controller \uFF0C\u6211\u4EEC\u53EF\u4EE5\u7B80\u5355\u7684\u901A\u8FC7 kubectl autoscale \u547D\u4EE4 \u6765\u521B\u5EFA\u2F00\u4E2A HPA \u8D44\u6E90\u5BF9\u8C61\uFF0C HPA Controller \u9ED8\u8BA430s\u8F6E\u8BE2\u2F00\u6B21\uFF08\u53EF\u901A\u8FC7 kube-controller-manager \u7684\u6807\u5FD7 --horizontal-pod-autoscaler-sync-period \u8FDB\u2F8F\u8BBE\u7F6E\uFF09\uFF0C\u67E5\u8BE2\u6307\u5B9A\u7684\u8D44\u6E90\uFF08RC\u6216\u8005 Deployment\uFF09\u4E2D Pod \u7684\u8D44\u6E90\u4F7F\u2F64\u7387\uFF0C\u5E76\u4E14\u4E0E\u521B\u5EFA\u65F6\u8BBE\u5B9A\u7684\u503C\u548C\u6307\u6807\u505A\u5BF9\u2F50\uFF0C\u4ECE\u2F7D\u5B9E\u73B0\u2F83\u52A8\u4F38\u7F29\u7684\u529F\u80FD\u3002</p></li><li><p>\u76EE\u524D\u4E3B\u8981\u5206\u4E24\u4E2A\u7248\u672C\uFF0Cautoscaling/v1\u548Cautoscaling/v2beta2\uFF0Cv1\u7248\u672C\u53EA\u652F\u6301 cpu\uFF0Cv2beta2\u7248\u672C\u652F\u6301 \u81EA\u5B9A\u4E49 \uFF0C\u5185\u5B58 \uFF0C\u4F46\u662F\u76EE\u524D\u4E5F\u4EC5\u4EC5\u662F\u5904\u4E8Ebeta\u9636\u6BB5\u3002</p></li></ul><h3 id="\u5B89\u88C5metrics-server" tabindex="-1"><a class="header-anchor" href="#\u5B89\u88C5metrics-server" aria-hidden="true">#</a> \u5B89\u88C5Metrics Server</h3><ul><li><p><code>HPA\u9700\u8981\u4ECEMetrics Server\u4E2D\u83B7\u53D6Pod\u7684CPU\u548C\u5185\u5B58Metrics\uFF0C\u7528\u6765\u5224\u65AD\u662F\u5426\u8FBE\u5230\u81EA\u52A8\u4F38\u7F29\u9608\u503C\u3002</code></p></li><li><p>Kubernetes\u96C6\u7FA4\u4F7F\u7528Metrics Server\u6765\u91C7\u96C6\u5BB9\u5668\u7684CPU\u548C\u5185\u5B58\u4F7F\u7528\u60C5\u51B5\uFF0C\u7528\u6765\u76D1\u63A7Node\u548CPod\u7684CPU\u548C\u5185\u5B58\u4F7F\u7528\u60C5\u51B5\uFF0C\u5E76\u7528\u4F5CHPA\uFF08\u81EA\u52A8\u6A2A\u5411\u6269\u5C55\uFF09\u3002</p></li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># wget https://github.com/kubernetes-sigs/metrics-server/releases/download/v0.3.7/components.yaml</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># vim components.yaml</span>
<span class="token punctuation">...</span>
<span class="token key atrule">containers</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> metrics<span class="token punctuation">-</span>server
<span class="token key atrule">image</span><span class="token punctuation">:</span> lizhenliang/metrics<span class="token punctuation">-</span>server<span class="token punctuation">:</span>v0.3.7 					<span class="token comment">#\u4FEE\u6539\u955C\u50CF</span>
<span class="token key atrule">imagePullPolicy</span><span class="token punctuation">:</span> IfNotPresent
<span class="token key atrule">args</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>cert<span class="token punctuation">-</span>dir=/tmp
<span class="token punctuation">-</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>secure<span class="token punctuation">-</span>port=4443
<span class="token punctuation">-</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>kubelet<span class="token punctuation">-</span>insecure<span class="token punctuation">-</span>tls									<span class="token comment">#\u4E0D\u9A8C\u8BC1kubelet\u63D0\u4F9B\u7684https\u8BC1\u4E66</span>
<span class="token punctuation">-</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>kubelet<span class="token punctuation">-</span>preferred<span class="token punctuation">-</span>address<span class="token punctuation">-</span>types=InternalIP				<span class="token comment">#\u4F7F\u7528\u8282\u70B9IP\u8FDE\u63A5kubelet</span>
<span class="token punctuation">...</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl delete -f components.yaml </span>
clusterrole.rbac.authorization.k8s.io <span class="token string">&quot;system:aggregated-metrics-reader&quot;</span> deleted
clusterrolebinding.rbac.authorization.k8s.io <span class="token string">&quot;metrics-server:system:auth-delegator&quot;</span> deleted
rolebinding.rbac.authorization.k8s.io <span class="token string">&quot;metrics-server-auth-reader&quot;</span> deleted
Warning: apiregistration.k8s.io/v1beta1 APIService is deprecated <span class="token keyword">in</span> v1.19+, unavailable <span class="token keyword">in</span> v1.22+<span class="token punctuation">;</span> use apiregistration.k8s.io/v1 APIService
apiservice.apiregistration.k8s.io <span class="token string">&quot;v1beta1.metrics.k8s.io&quot;</span> deleted
serviceaccount <span class="token string">&quot;metrics-server&quot;</span> deleted
deployment.apps <span class="token string">&quot;metrics-server&quot;</span> deleted
<span class="token function">service</span> <span class="token string">&quot;metrics-server&quot;</span> deleted
clusterrole.rbac.authorization.k8s.io <span class="token string">&quot;system:metrics-server&quot;</span> deleted
clusterrolebinding.rbac.authorization.k8s.io <span class="token string">&quot;system:metrics-server&quot;</span> deleted
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u68C0\u67E5\u76D1\u63A7\u8D44\u6E90\u662F\u5426\u6B63\u5E38\u8FD0\u884C</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl top nodes</span>
NAME     CPU<span class="token punctuation">(</span>cores<span class="token punctuation">)</span>   CPU%   MEMORY<span class="token punctuation">(</span>bytes<span class="token punctuation">)</span>   MEMORY%   
master   182m         <span class="token number">4</span>%     2166Mi          <span class="token number">28</span>%       
<span class="token function">node</span>     76m          <span class="token number">1</span>%     1818Mi          <span class="token number">23</span>%    
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="hpa\u7684\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#hpa\u7684\u4F7F\u7528" aria-hidden="true">#</a> HPA\u7684\u4F7F\u7528</h3><ul><li>\u521B\u5EFA\u2F00\u4E2A Deployment \u7BA1\u7406\u7684 Nginx Pod\uFF0C\u7136\u540E\u5229\u2F64 HPA \u6765\u8FDB\u2F8F\u2F83\u52A8\u6269\u7F29\u5BB9\u3002</li></ul><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># cat deployment.yaml </span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> hpa<span class="token punctuation">-</span>nginx<span class="token punctuation">-</span>deployment
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">revisionHistoryLimit</span><span class="token punctuation">:</span> <span class="token number">15</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> hpa<span class="token punctuation">-</span>nginx<span class="token punctuation">-</span>deployment
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> hpa<span class="token punctuation">-</span>nginx<span class="token punctuation">-</span>deployment
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx
        <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
        <span class="token key atrule">ports</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u67E5\u770Bdeployment\u548Cpod</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get deployments.apps </span>
NAME                   READY   UP-TO-DATE   AVAILABLE   AGE
hpa-nginx-deployment   <span class="token number">1</span>/1     <span class="token number">1</span>            <span class="token number">1</span>           3m58s

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get pods </span>
NAME                                    READY   STATUS    RESTARTS   AGE
hpa-nginx-deployment-7d546c5c67-qdkhm   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          4m2s
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u521B\u5EFA\u4E00\u4E2AHPA\uFF0C\u7528kubectl autosca\u6765\u521B\u5EFA</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl autoscale deployment hpa-nginx-deployment --max=10 --min=1 --cpu-percent=50 --dry-run -o yaml &gt;&gt; hpa.yaml </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># cat hpa.yaml  </span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> autoscaling/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> HorizontalPodAutoscaler
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> hpa<span class="token punctuation">-</span>nginx<span class="token punctuation">-</span>deployment
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">maxReplicas</span><span class="token punctuation">:</span> <span class="token number">10</span>		<span class="token comment">#\u6700\u5927\u4F38\u7F29\u526F\u672C\u523010</span>
  <span class="token key atrule">minReplicas</span><span class="token punctuation">:</span> <span class="token number">1</span>		<span class="token comment">#\u6700\u5C0F\u4F38\u7F29\u526F\u672C\u52301</span>
  <span class="token key atrule">scaleTargetRef</span><span class="token punctuation">:</span>		<span class="token comment">#\u4F38\u7F29\u526F\u672C\u7684\u6765\u6E90\uFF0C\u8D44\u6E90\u7C7B\u578B\uFF0CRC\uFF0CRS\uFF0CDeployment</span>
    <span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
    <span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
    <span class="token key atrule">name</span><span class="token punctuation">:</span> hpa<span class="token punctuation">-</span>nginx<span class="token punctuation">-</span>deployment
  <span class="token key atrule">targetCPUUtilizationPercentage</span><span class="token punctuation">:</span> <span class="token number">50</span>		<span class="token comment">#\u89E6\u53D1\u4F38\u7F29\u7684cpu\u4F7F\u2F64\u7387</span>
<span class="token key atrule">status</span><span class="token punctuation">:</span>
  <span class="token key atrule">currentCPUUtilizationPercentage</span><span class="token punctuation">:</span> <span class="token number">48</span> 		<span class="token comment">#\u5F53\u524D\u8D44\u6E90\u4E0Bpod\u7684cpu\u4F7F\u2F64\u7387</span>
  <span class="token key atrule">currentReplicas</span><span class="token punctuation">:</span> <span class="token number">1</span> 						<span class="token comment">#\u5F53\u524D\u7684\u526F\u672C\u6570</span>
  <span class="token key atrule">desiredReplicas</span><span class="token punctuation">:</span> <span class="token number">2</span> 						<span class="token comment">#\u671F\u671B\u7684\u526F\u672C\u6570</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u67E5\u770Bhpa\u7684\u521B\u5EFA\u662F\u5426\u6B63\u786E</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f hpa.yaml  </span>
horizontalpodautoscaler.autoscaling/hpa-nginx-deployment configured

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get hpa</span>
NAME                   REFERENCE                         TARGETS         MINPODS   MAXPODS   REPLICAS   AGE
frontend-scaler        ReplicaSet/frontend               <span class="token operator">&lt;</span>unknown<span class="token operator">&gt;</span>/50%   <span class="token number">3</span>         <span class="token number">10</span>        <span class="token number">0</span>          125m
hpa-nginx-deployment   Deployment/hpa-nginx-deployment   <span class="token operator">&lt;</span>unknown<span class="token operator">&gt;</span>/50%   <span class="token number">1</span>         <span class="token number">10</span>        <span class="token number">1</span>          93s
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u6A21\u62DF\u589E\u52A0\u8D1F\u8F7D" tabindex="-1"><a class="header-anchor" href="#\u6A21\u62DF\u589E\u52A0\u8D1F\u8F7D" aria-hidden="true">#</a> \u6A21\u62DF\u589E\u52A0\u8D1F\u8F7D</h3><ul><li>\u6253\u5F00\u4E00\u4E2A\u65B0\u7684Terminal\uFF0C\u521B\u5EFA\u4E00\u4E2A\u4E34\u65F6\u7684pod <code>load-generator</code>\uFF0C\u5E76\u5728\u8BE5pod\u4E2D\u5411<code>php-apache</code>\u670D\u52A1\u53D1\u8D77\u4E0D\u95F4\u65AD\u5FAA\u73AF\u8BF7\u6C42\uFF0C\u6A21\u62DF\u589E\u52A0<code>php-apache</code>\u7684\u8D1F\u8F7D\uFF08CPU\u4F7F\u7528\u7387\uFF09\u3002</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl run -i --tty load-generator --rm --image=busybox --restart=Never -- /bin/sh </span>
<span class="token comment">#/  while sleep 0.01; do wget -q -O- http://10.244.167.145; done</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u6A21\u62DF\u538B\u529B\u6D4B\u8BD5\u51E0\u5206\u949F\u540E\uFF0C\u89C2\u5BDFHPA\uFF1A</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get hpa php-apache</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>HPA\u60C5\u51B5\u7C7B\u4F3C\uFF1A</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>NAME         REFERENCE               TARGETS    MINPODS   MAXPODS   REPLICAS   AGE
php-apache   Deployment/php-apache   <span class="token number">250</span>%/50%   <span class="token number">1</span>         <span class="token number">10</span>        <span class="token number">5</span>          4m45s
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>\u53EF\u4EE5\u770B\u5230TARGETS\uFF08CPU\u4F7F\u7528\u7387\uFF09\u7684acutal\u503C\u5DF2\u5347\u9AD8\u5230250% (\u8D85\u8FC7\u4E86\u671F\u671B\u503C50%)\uFF0C\u526F\u672C\u6570REPLICAS\u4E5F\u4ECE1\u81EA\u52A8\u6269\u5BB9\u5230\u4E865\u3002</p></li><li><p>\u6CE8\u610F\uFF1A\u5982\u679CKubernetes\u96C6\u7FA4worker\u8282\u70B9\u7684CPU\u8D44\u6E90\u5DF2\u7ECF\u4E0D\u8DB3\uFF0CHPA\u81EA\u52A8\u6269\u5BB9\u4F1A\u5931\u8D25\uFF0C\u65B0\u6269\u5BB9\u7684pod\u4F1A\u4E00\u76F4\u5904\u5728Pending\u72B6\u6001\u3002\u901A\u8FC7kubectl describe\u547D\u4EE4\u67E5\u770Bpod\u8BE6\u7EC6\u4FE1\u606F\u65F6\uFF0C\u4F1A\u770B\u5230\u201CInsufficient cpu&quot;\u7684\u9519\u8BEF\u4FE1\u606F\u3002</p></li></ul><h2 id="job-\u548C-cronjob" tabindex="-1"><a class="header-anchor" href="#job-\u548C-cronjob" aria-hidden="true">#</a> Job \u548C Cronjob</h2><ul><li><strong>\u53E6\u5916\u2F00\u7C7B\u8D44\u6E90\u5BF9\u8C61\uFF1AJob\uFF0C\u6211\u4EEC\u5728\u2F47\u5E38\u7684\u2F2F\u4F5C\u4E2D\u7ECF\u5E38\u90FD \u4F1A\u9047\u5230\u2F00\u4E9B\u9700\u8981\u8FDB\u2F8F\u6279\u91CF\u6570\u636E\u5904\u7406\u548C\u5206\u6790\u7684\u9700\u6C42\uFF0C\u5F53\u7136\u4E5F\u4F1A\u6709\u6309\u65F6\u95F4\u6765\u8FDB\u2F8F\u8C03\u5EA6\u7684\u2F2F\u4F5C\uFF0C\u5728\u6211\u4EEC \u7684 Kubernetes \u96C6\u7FA4\u4E2D\u4E3A\u6211\u4EEC\u63D0\u4F9B\u4E86 Job \u548C CronJob \u4E24\u79CD\u8D44\u6E90\u5BF9\u8C61\u6765\u5E94\u5BF9\u6211\u4EEC\u7684\u8FD9\u79CD\u9700\u6C42\u3002</strong></li><li><strong>Job \u8D1F\u8D23\u5904\u7406\u4EFB\u52A1\uFF0C\u5373\u4EC5\u6267\u2F8F\u2F00\u6B21\u7684\u4EFB\u52A1\uFF0C\u5B83\u4FDD\u8BC1\u6279\u5904\u7406\u4EFB\u52A1\u7684\u2F00\u4E2A\u6216\u591A\u4E2A Pod \u6210\u529F\u7ED3\u675F\u3002 \u2F7D CronJob \u5219\u5C31\u662F\u5728 Job \u4E0A\u52A0\u4E0A\u4E86\u65F6\u95F4\u8C03\u5EA6\u3002</strong></li></ul><h3 id="job\u7684\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#job\u7684\u4F7F\u7528" aria-hidden="true">#</a> Job\u7684\u4F7F\u7528</h3><ul><li><p>\u6211\u4EEC\u2F64 Job \u8FD9\u4E2A\u8D44\u6E90\u5BF9\u8C61\u6765\u521B\u5EFA\u2F00\u4E2A\u4EFB\u52A1\uFF0C\u6211\u4EEC\u5B9A\u2F00\u4E2A Job \u6765\u6267\u2F8F\u2F00\u4E2A\u5012\u8BA1\u65F6\u7684\u4EFB\u52A1\uFF0C\u5B9A\u4E49 YAML \u2F42 \u4EF6\uFF1A</p></li><li><p>\u6CE8\u610F Job \u7684 <code>RestartPolicy \u4EC5\u2F40\u6301 Never \u548C OnFailure \u4E24\u79CD</code>\uFF0C\u4E0D\u2F40\u6301 Always \uFF0C\u6211\u4EEC\u77E5\u9053 Job \u5C31\u76F8 \u5F53\u4E8E\u6765\u6267\u2F8F\u2F00\u4E2A\u6279\u5904\u7406\u4EFB\u52A1\uFF0C\u6267\u2F8F\u5B8C\u5C31\u7ED3\u675F\u4E86\uFF0C\u5982\u679C\u2F40\u6301 Always \u7684\u8BDD\u5C31\u9677\u2F0A\u4E86\u6B7B\u5FAA\u73AF\u4E86</p></li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl create job job-demo --image=busybox --dry-run -o yaml &gt; job.yaml </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># cat job.yaml  </span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> batch/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Job
<span class="token key atrule">metadata</span><span class="token punctuation">:</span> 
  <span class="token key atrule">name</span><span class="token punctuation">:</span> job<span class="token punctuation">-</span>demo
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> busybox
        <span class="token key atrule">name</span><span class="token punctuation">:</span> job<span class="token punctuation">-</span>demo
        <span class="token key atrule">command</span><span class="token punctuation">:</span>  
        <span class="token punctuation">-</span> <span class="token string">&quot;/bin/sh&quot;</span> 
        <span class="token punctuation">-</span> <span class="token string">&quot;-c&quot;</span>
        <span class="token punctuation">-</span> <span class="token string">&quot;for i in 9 8 7 6 5 4 3 2 1; do echo $i; done&quot;</span>
      <span class="token key atrule">restartPolicy</span><span class="token punctuation">:</span> Never
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u7136\u540E\u6765\u521B\u5EFA\u8BE5 Job</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f job.yaml  </span>
job.batch/job-demo created.

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get job </span>
NAME       COMPLETIONS   DURATION   AGE
job-demo   <span class="token number">1</span>/1           17s        2m54s
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u6CE8\u610F\u67E5\u770B\u6211\u4EEC\u7684 Pod \u7684\u72B6\u6001\uFF0C\u540C\u6837\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7 kubectl logs \u6765\u67E5\u770B\u5F53\u524D\u4EFB\u52A1\u7684\u6267\u2F8F\u7ED3\u679C\u3002</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl logs job-demo-ntxgx job-demo </span>
<span class="token number">9</span>
<span class="token number">8</span>
<span class="token number">7</span>
<span class="token number">6</span>
<span class="token number">5</span>
<span class="token number">4</span>
<span class="token number">3</span>
<span class="token number">2</span>
<span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="cronjob\u7684\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#cronjob\u7684\u4F7F\u7528" aria-hidden="true">#</a> CronJob\u7684\u4F7F\u7528</h3><ul><li><p>CronJob \u5176\u5B9E\u5C31\u662F\u5728 Job \u7684\u57FA\u7840\u4E0A\u52A0\u4E0A\u4E86\u65F6\u95F4\u8C03\u5EA6\uFF0C\u6211\u4EEC\u53EF\u4EE5\uFF1A\u5728\u7ED9\u5B9A\u7684\u65F6\u95F4\u70B9\u8FD0\u2F8F\u2F00\u4E2A\u4EFB\u52A1\uFF0C\u4E5F\u53EF \u4EE5\u5468\u671F\u6027\u5730\u5728\u7ED9\u5B9A\u65F6\u95F4\u70B9\u8FD0\u2F8F\u3002\u8FD9\u4E2A\u5B9E\u9645\u4E0A\u548C\u6211\u4EEC Linux \u4E2D\u7684 crontab \u5C31\u2FAE\u5E38\u7C7B\u4F3C\u4E86\u3002</p></li><li><p>\u2F00\u4E2A CronJob \u5BF9\u8C61\u5176\u5B9E\u5C31\u5BF9\u5E94\u4E2D crontab \u2F42\u4EF6\u4E2D\u7684\u2F00\u2F8F\uFF0C\u5B83\u6839\u636E\u914D\u7F6E\u7684\u65F6\u95F4\u683C\u5F0F\u5468\u671F\u6027\u5730\u8FD0\u2F8F\u2F00 \u4E2A Job \uFF0C\u683C\u5F0F\u548C crontab \u4E5F\u662F\u2F00\u6837\u7684\u3002</p></li><li><p><code>crontab \u7684\u683C\u5F0F\u5982\u4E0B\uFF1A \u5206 \u65F6 \u2F47 \u2F49 \u661F\u671F \u8981\u8FD0\u2F8F\u7684\u547D\u4EE4 \u7B2C1\u5217\u5206\u949F0\uFF5E59 \u7B2C2\u5217\u2F29\u65F60\uFF5E23\uFF09 \u7B2C3\u5217\u2F471\uFF5E31 \u7B2C4\u5217\u2F491\uFF5E 12 \u7B2C5\u5217\u661F\u671F0\uFF5E7\uFF080\u548C7\u8868\u793A\u661F\u671F\u5929\uFF09 \u7B2C6\u5217\u8981\u8FD0\u2F8F\u7684\u547D\u4EE4</code></p></li></ul><h3 id="cron-\u65F6\u95F4\u8868\u8BED\u6CD5" tabindex="-1"><a class="header-anchor" href="#cron-\u65F6\u95F4\u8868\u8BED\u6CD5" aria-hidden="true">#</a> Cron \u65F6\u95F4\u8868\u8BED\u6CD5</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#      \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u65F6\u533A (\u53EF\u9009)</span>
<span class="token comment">#      |      \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u5206\u949F (0 - 59)</span>
<span class="token comment">#      |      \u2502 \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u5C0F\u65F6 (0 - 23)</span>
<span class="token comment">#      |      \u2502 \u2502 \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u6708\u7684\u67D0\u5929 (1 - 31)</span>
<span class="token comment">#      |      \u2502 \u2502 \u2502 \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 month (1 - 12)</span>
<span class="token comment">#      |      \u2502 \u2502 \u2502 \u2502 \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u5468\u7684\u67D0\u5929 (0 - 6)\uFF08\u5468\u65E5\u5230\u5468\u4E00\uFF1B\u5728\u67D0\u4E9B\u7CFB\u7EDF\u4E0A\uFF0C7 \u4E5F\u662F\u661F\u671F\u65E5\uFF09</span>
<span class="token comment">#      |      \u2502 \u2502 \u2502 \u2502 \u2502                                </span>
<span class="token comment">#      |      \u2502 \u2502 \u2502 \u2502 \u2502</span>
<span class="token comment">#      |      \u2502 \u2502 \u2502 \u2502 \u2502</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># CRON_TZ=UTC * * * * *</span>
<span class="token comment"># \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u5206\u949F (0 - 59)</span>
<span class="token comment"># \u2502 \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u5C0F\u65F6 (0 - 23)</span>
<span class="token comment"># \u2502 \u2502 \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u6708\u7684\u67D0\u5929 (1 - 31)</span>
<span class="token comment"># \u2502 \u2502 \u2502 \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u6708\u4EFD (1 - 12)</span>
<span class="token comment"># \u2502 \u2502 \u2502 \u2502 \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u5468\u7684\u67D0\u5929 (0 - 6) \uFF08\u5468\u65E5\u5230\u5468\u4E00\uFF1B\u5728\u67D0\u4E9B\u7CFB\u7EDF\u4E0A\uFF0C7 \u4E5F\u662F\u661F\u671F\u65E5\uFF09</span>
<span class="token comment"># \u2502 \u2502 \u2502 \u2502 \u2502                                   </span>
<span class="token comment"># \u2502 \u2502 \u2502 \u2502 \u2502</span>
<span class="token comment"># \u2502 \u2502 \u2502 \u2502 \u2502</span>
<span class="token comment"># * * * * *</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u73B0\u5728\uFF0C\u6211\u4EEC\u2F64 CronJob \u6765\u7BA1\u7406\u6211\u4EEC\u4E0A\u2FAF\u7684 Job \u4EFB\u52A1</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl create cronjob cronjob-demo --image=busybox   --schedule &quot;*/1 * * * *&quot;  --dry-run -o yaml &gt; cronjob.yaml </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># cat cronjob1.yaml </span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> batch/v1beta1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> CronJob
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> cronjob<span class="token punctuation">-</span>demo1
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">jobTemplate</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> cronjob<span class="token punctuation">-</span>demo1
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">template</span><span class="token punctuation">:</span>
        <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
        <span class="token key atrule">spec</span><span class="token punctuation">:</span>
          <span class="token key atrule">containers</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> busybox
            <span class="token key atrule">name</span><span class="token punctuation">:</span> cronjob<span class="token punctuation">-</span>demo1
            <span class="token key atrule">args</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token string">&quot;bin/sh&quot;</span>
            <span class="token punctuation">-</span> <span class="token string">&quot;-c&quot;</span>
            <span class="token punctuation">-</span> <span class="token string">&quot;for i in 9 8 7 6 5 4 3 2 1; do echo $i; done&quot;</span>
          <span class="token key atrule">restartPolicy</span><span class="token punctuation">:</span> OnFailure
  <span class="token key atrule">schedule</span><span class="token punctuation">:</span> <span class="token string">&#39;*/1 * * * *&#39;</span>
  
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f cronjob1.yaml </span>
cronjob.batch/cronjob<span class="token punctuation">-</span>demo1 created
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>\u8FD9\u2FA5\u7684 Kind \u662F CronJob \u4E86\uFF0C\u8981\u6CE8\u610F\u7684\u662F .spec.schedule \u5B57\u6BB5\u662F\u5FC5\u987B\u586B\u5199\u7684\uFF0C\u2F64\u6765\u6307\u5B9A\u4EFB\u52A1\u8FD0\u2F8F \u7684\u5468\u671F\uFF0C\u683C\u5F0F\u5C31\u548C <code>crontab</code> \u2F00\u6837\uFF0C\u53E6\u5916\u2F00\u4E2A\u5B57\u6BB5\u662F <code>.spec.jobTemplate</code> , \u2F64\u6765\u6307\u5B9A\u9700\u8981\u8FD0\u2F8F\u7684\u4EFB\u52A1\uFF0C\u683C \u5F0F\u5F53\u7136\u548C Job \u662F\u2F00\u81F4\u7684</p></li><li><p>\u6BB5 <code>.spec.successfulJobsHistoryLimit</code> \u548C <code>.spec.failedJobsHistoryLimit</code> \uFF0C\u8868\u793A\u5386\u53F2\u9650\u5236\uFF0C\u662F\u53EF\u9009\u7684 \u5B57\u6BB5\u3002\u5B83\u4EEC\u6307\u5B9A\u4E86\u53EF\u4EE5\u4FDD\u7559\u591A\u5C11\u5B8C\u6210\u548C\u5931\u8D25\u7684 Job \uFF0C\u9ED8\u8BA4\u6CA1\u6709\u9650\u5236\uFF0C\u6240\u6709\u6210\u529F\u548C\u5931\u8D25\u7684 Job \u90FD\u4F1A\u88AB\u4FDD \u7559\u3002\u7136\u2F7D\uFF0C\u5F53\u8FD0\u2F8F\u2F00\u4E2A Cron Job \u65F6\uFF0C Job \u53EF\u4EE5\u5F88\u5FEB\u5C31\u5806\u79EF\u5F88\u591A\uFF0C\u6240\u4EE5\u2F00\u822C\u63A8\u8350\u8BBE\u7F6E\u8FD9\u4E24\u4E2A\u5B57\u6BB5\u7684 \u503C\u3002\u5982\u679C\u8BBE\u7F6E\u9650\u5236\u7684\u503C\u4E3A 0\uFF0C\u90A3\u4E48\u76F8\u5173\u7C7B\u578B\u7684 Job \u5B8C\u6210\u540E\u5C06\u4E0D\u4F1A\u88AB\u4FDD\u7559\u3002</p></li><li><p>\u67E5\u770B\u5F53\u524D\u7684cronjob</p></li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get cronjobs.batch </span>
NAME            SCHEDULE      SUSPEND   ACTIVE   LAST SCHEDULE   AGE
cronjob-demo1   */1 * * * *   False     <span class="token number">1</span>        11s             11m

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get jobs </span>
NAME                       COMPLETIONS   DURATION   AGE
cronjob-demo1-1636527840   <span class="token number">1</span>/1           17s        3m
cronjob-demo1-1636527900   <span class="token number">1</span>/1           17s        2m
cronjob-demo1-1636527960   <span class="token number">1</span>/1           17s        60s
job-demo                   <span class="token number">1</span>/1           17s        49m
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u4E5F\u53EF\u4EE5\u2F64 kubectl run\u6765\u521B\u5EFA\u2F00\u4E2ACronJob\uFF1A</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl run hello --schedule=&quot;*/1 * * * *&quot; --restart=OnFailure --image=busybox -- /bin/sh -c &quot;date; echo Hello from the Kubernetes cluster&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>\u8FD9\u5C06\u4F1A\u7EC8\u2F4C\u6B63\u5728\u521B\u5EFA\u7684 Job\u3002\u7136\u2F7D\uFF0C\u8FD0\u2F8F\u4E2D\u7684 Job \u5C06\u4E0D\u4F1A\u88AB\u7EC8\u2F4C\uFF0C\u4E0D\u4F1A\u5220\u9664 Job \u6216 \u5B83\u4EEC\u7684 Pod\u3002\u4E3A\u4E86 \u6E05\u7406\u90A3\u4E9B Job \u548C Pod\uFF0C\u9700\u8981\u5217\u51FA\u8BE5 Cron Job \u521B\u5EFA\u7684\u5168\u90E8 Job\uFF0C\u7136\u540E\u5220\u9664\u5B83\u4EEC\uFF1A</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get job </span>
NAME                       COMPLETIONS   DURATION   AGE
cronjob-demo1-1636528440   <span class="token number">1</span>/1           16s        3m
cronjob-demo1-1636528500   <span class="token number">1</span>/1           17s        2m
cronjob-demo1-1636528560   <span class="token number">1</span>/1           18s        60s
job-demo                   <span class="token number">1</span>/1           17s        59m
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get jobs </span>
NAME                       COMPLETIONS   DURATION   AGE
cronjob-demo1-1636528500   <span class="token number">1</span>/1           17s        2m45s
cronjob-demo1-1636528560   <span class="token number">1</span>/1           18s        105s
cronjob-demo1-1636528620   <span class="token number">1</span>/1           17s        45s
job-demo                   <span class="token number">1</span>/1           17s        60m
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl delete cronjob --all</span>
cronjob.batch <span class="token string">&quot;cronjob-demo1&quot;</span> deleted
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,125);function us(ks,ms){const e=c("ExternalLinkIcon");return o(),i("div",null,[r,n("ul",null,[d,n("li",null,[u,s(" \uFF08\u5C31\u50CF\u5728\u9CB8\u9C7C\u835A\u6216\u8005\u8C4C\u8C46\u835A\u4E2D\uFF09\u662F\u4E00\u7EC4\uFF08\u4E00\u4E2A\u6216\u591A\u4E2A\uFF09 "),n("a",k,[s("\u5BB9\u5668"),a(e)]),s("\uFF1B \u8FD9\u4E9B\u5BB9\u5668\u5171\u4EAB\u5B58\u50A8\u3001\u7F51\u7EDC\u3001\u4EE5\u53CA\u600E\u6837\u8FD0\u884C\u8FD9\u4E9B\u5BB9\u5668\u7684\u58F0\u660E\u3002 Pod \u4E2D\u7684\u5185\u5BB9\u603B\u662F\u5E76\u7F6E\uFF08colocated\uFF09\u7684\u5E76\u4E14\u4E00\u540C\u8C03\u5EA6\uFF0C\u5728\u5171\u4EAB\u7684\u4E0A\u4E0B\u6587\u4E2D\u8FD0\u884C\u3002 Pod \u6240\u5EFA\u6A21\u7684\u662F\u7279\u5B9A\u4E8E\u5E94\u7528\u7684\u201C\u903B\u8F91\u4E3B\u673A\u201D\uFF0C\u5176\u4E2D\u5305\u542B\u4E00\u4E2A\u6216\u591A\u4E2A\u5E94\u7528\u5BB9\u5668\uFF0C \u8FD9\u4E9B\u5BB9\u5668\u662F\u76F8\u5BF9\u7D27\u5BC6\u7684\u8026\u5408\u5728\u4E00\u8D77\u7684\u3002 \u5728\u975E\u4E91\u73AF\u5883\u4E2D\uFF0C\u5728\u76F8\u540C\u7684\u7269\u7406\u673A\u6216\u865A\u62DF\u673A\u4E0A\u8FD0\u884C\u7684\u5E94\u7528\u7C7B\u4F3C\u4E8E \u5728\u540C\u4E00\u903B\u8F91\u4E3B\u673A\u4E0A\u8FD0\u884C\u7684\u4E91\u5E94\u7528\u3002")]),n("li",null,[s("\u9664\u4E86\u5E94\u7528\u5BB9\u5668\uFF0CPod \u8FD8\u53EF\u4EE5\u5305\u542B\u5728 Pod \u542F\u52A8\u671F\u95F4\u8FD0\u884C\u7684 "),n("a",m,[s("Init \u5BB9\u5668"),a(e)]),s("\u3002 \u4F60\u4E5F\u53EF\u4EE5\u5728\u96C6\u7FA4\u4E2D\u652F\u6301"),n("a",b,[s("\u4E34\u65F6\u6027\u5BB9\u5668"),a(e)]),s(" \u7684\u60C5\u51B5\u4E0B\uFF0C\u4E3A\u8C03\u8BD5\u7684\u76EE\u7684\u6CE8\u5165\u4E34\u65F6\u6027\u5BB9\u5668\u3002")]),v,n("li",null,[h,s(" \u4E00\u4E2A Pod \u53EF\u4EE5\u8BBE\u7F6E\u4E00\u7EC4\u5171\u4EAB\u7684\u5B58\u50A8"),n("a",g,[s("\u5377"),a(e)]),s("\u3002 Pod \u4E2D\u7684\u6240\u6709\u5BB9\u5668\u90FD\u53EF\u4EE5\u8BBF\u95EE\u8BE5\u5171\u4EAB\u5377\uFF0C\u4ECE\u800C\u5141\u8BB8\u8FD9\u4E9B\u5BB9\u5668\u5171\u4EAB\u6570\u636E\u3002 \u5377\u8FD8\u5141\u8BB8 Pod \u4E2D\u7684\u6301\u4E45\u6570\u636E\u4FDD\u7559\u4E0B\u6765\uFF0C\u5373\u4F7F\u5176\u4E2D\u7684\u5BB9\u5668\u9700\u8981\u91CD\u65B0\u542F\u52A8\u3002")])]),y,n("p",null,[s("\u901A\u5E38\u4F60\u4E0D\u9700\u8981\u76F4\u63A5\u521B\u5EFA Pod\uFF0C\u751A\u81F3\u5355\u5B9E\u4F8B Pod\u3002 \u76F8\u53CD\uFF0C\u4F60\u4F1A\u4F7F\u7528\u8BF8\u5982 "),n("a",P,[s("Deployment"),a(e)]),s(" \u6216 "),n("a",_,[s("Job"),a(e)]),s(" \u8FD9\u7C7B\u5DE5\u4F5C\u8D1F\u8F7D\u8D44\u6E90 \u6765\u521B\u5EFA Pod\u3002\u5982\u679C Pod \u9700\u8981\u8DDF\u8E2A\u72B6\u6001\uFF0C \u53EF\u4EE5\u8003\u8651 "),n("a",f,[s("StatefulSet"),a(e)]),s(" \u8D44\u6E90\u3002")]),n("p",null,[s("\u4F60\u5F88\u5C11\u5728 Kubernetes \u4E2D\u76F4\u63A5\u521B\u5EFA\u4E00\u4E2A\u4E2A\u7684 Pod\uFF0C\u751A\u81F3\u662F\u5355\u5B9E\u4F8B\uFF08Singleton\uFF09\u7684 Pod\u3002 \u8FD9\u662F\u56E0\u4E3A Pod \u88AB\u8BBE\u8BA1\u6210\u4E86\u76F8\u5BF9\u4E34\u65F6\u6027\u7684\u3001\u7528\u540E\u5373\u629B\u7684\u4E00\u6B21\u6027\u5B9E\u4F53\u3002 \u5F53 Pod \u7531\u4F60\u6216\u8005\u95F4\u63A5\u5730\u7531 "),n("a",x,[s("\u63A7\u5236\u5668"),a(e)]),s(" \u521B\u5EFA\u65F6\uFF0C\u5B83\u88AB\u8C03\u5EA6\u5728\u96C6\u7FA4\u4E2D\u7684"),n("a",A,[s("\u8282\u70B9"),a(e)]),s("\u4E0A\u8FD0\u884C\u3002 Pod \u4F1A\u4FDD\u6301\u5728\u8BE5\u8282\u70B9\u4E0A\u8FD0\u884C\uFF0C\u76F4\u5230 Pod \u7ED3\u675F\u6267\u884C\u3001Pod \u5BF9\u8C61\u88AB\u5220\u9664\u3001Pod \u56E0\u8D44\u6E90\u4E0D\u8DB3\u800C\u88AB "),R,s(" \u6216\u8005\u8282\u70B9\u5931\u6548\u4E3A\u6B62\u3002")]),E,w,S,n("ul",null,[T,n("li",null,[s("Pod \u5929\u751F\u5730\u4E3A\u5176\u6210\u5458\u5BB9\u5668\u63D0\u4F9B\u4E86\u4E24\u79CD\u5171\u4EAB\u8D44\u6E90\uFF1A"),n("a",q,[s("\u7F51\u7EDC"),a(e)]),s("\u548C "),n("a",C,[s("\u5B58\u50A8"),a(e)]),s("\u3002")])]),D,z,j,n("ul",null,[n("li",null,[n("a",N,[s("\u8D1F\u8F7D"),a(e)]),s("\u8D44\u6E90\u7684\u63A7\u5236\u5668\u901A\u5E38\u4F7F\u7528 "),I,s(" \u6765\u66FF\u4F60\u521B\u5EFA Pod \u5E76\u7BA1\u7406\u5B83\u4EEC\u3002")]),n("li",null,[s("Pod \u6A21\u677F\u662F\u5305\u542B\u5728\u5DE5\u4F5C\u8D1F\u8F7D\u5BF9\u8C61\u4E2D\u7684\u89C4\u8303\uFF0C\u7528\u6765\u521B\u5EFA Pod\u3002\u8FD9\u7C7B\u8D1F\u8F7D\u8D44\u6E90\u5305\u62EC "),n("a",M,[s("Deployment"),a(e)]),s("\u3001 "),n("a",U,[s("Job"),a(e)]),s(" \u548C "),n("a",L,[s("DaemonSets"),a(e)]),s("\u7B49\u3002")]),J]),O,n("ul",null,[n("li",null,[s("Pod \u9075\u5FAA\u4E00\u4E2A\u9884\u5B9A\u4E49\u7684\u751F\u547D\u5468\u671F\uFF0C\u8D77\u59CB\u4E8E "),G,s(),n("a",H,[s("\u9636\u6BB5"),a(e)]),s("\uFF0C\u5982\u679C\u81F3\u5C11 \u5176\u4E2D\u6709\u4E00\u4E2A\u4E3B\u8981\u5BB9\u5668\u6B63\u5E38\u542F\u52A8\uFF0C\u5219\u8FDB\u5165 "),K,s("\uFF0C\u4E4B\u540E\u53D6\u51B3\u4E8E Pod \u4E2D\u662F\u5426\u6709\u5BB9\u5668\u4EE5 \u5931\u8D25\u72B6\u6001\u7ED3\u675F\u800C\u8FDB\u5165 "),Y,s(" \u6216\u8005 "),V,s(" \u9636\u6BB5\u3002")]),n("li",null,[s("\u5728 Pod \u8FD0\u884C\u671F\u95F4\uFF0C"),F,s(" \u80FD\u591F\u91CD\u542F\u5BB9\u5668\u4EE5\u5904\u7406\u4E00\u4E9B\u5931\u6548\u573A\u666F\u3002 \u5728 Pod \u5185\u90E8\uFF0CKubernetes \u8DDF\u8E2A\u4E0D\u540C\u5BB9\u5668\u7684"),n("a",$,[s("\u72B6\u6001"),a(e)]),s(" \u5E76\u786E\u5B9A\u4F7F Pod \u91CD\u65B0\u53D8\u5F97\u5065\u5EB7\u6240\u9700\u8981\u91C7\u53D6\u7684\u52A8\u4F5C\u3002")]),n("li",null,[s("Pod \u5728\u5176\u751F\u547D\u5468\u671F\u4E2D\u53EA\u4F1A\u88AB"),n("a",B,[s("\u8C03\u5EA6"),a(e)]),s("\u4E00\u6B21\u3002 \u4E00\u65E6 Pod \u88AB\u8C03\u5EA6\uFF08\u5206\u6D3E\uFF09\u5230\u67D0\u4E2A\u8282\u70B9\uFF0CPod \u4F1A\u4E00\u76F4\u5728\u8BE5\u8282\u70B9\u8FD0\u884C\uFF0C\u76F4\u5230 Pod \u505C\u6B62\u6216\u8005 \u88AB"),n("a",X,[s("\u7EC8\u6B62"),a(e)]),s("\u3002")])]),W,n("ul",Z,[n("li",Q,[nn,n("label",sn,[s(" \u548C\u4E00\u4E2A\u4E2A\u72EC\u7ACB\u7684\u5E94\u7528\u5BB9\u5668\u4E00\u6837\uFF0CPod \u4E5F\u88AB\u8BA4\u4E3A\u662F\u76F8\u5BF9\u4E34\u65F6\u6027\uFF08\u800C\u4E0D\u662F\u957F\u671F\u5B58\u5728\uFF09\u7684\u5B9E\u4F53\u3002 Pod \u4F1A\u88AB\u521B\u5EFA\u3001\u8D4B\u4E88\u4E00\u4E2A\u552F\u4E00\u7684 ID\uFF08"),n("a",en,[s("UID"),a(e)]),s("\uFF09\uFF0C \u5E76\u88AB\u8C03\u5EA6\u5230\u8282\u70B9\uFF0C\u5E76\u5728\u7EC8\u6B62\uFF08\u6839\u636E\u91CD\u542F\u7B56\u7565\uFF09\u6216\u5220\u9664\u4E4B\u524D\u4E00\u76F4\u8FD0\u884C\u5728\u8BE5\u8282\u70B9\u3002")])]),n("li",an,[tn,n("label",ln,[s(" \u5982\u679C\u4E00\u4E2A"),n("a",on,[s("\u8282\u70B9"),a(e)]),s("\u6B7B\u6389\u4E86\uFF0C\u8C03\u5EA6\u5230\u8BE5\u8282\u70B9 \u7684 Pod \u4E5F\u88AB\u8BA1\u5212\u5728\u7ED9\u5B9A\u8D85\u65F6\u671F\u9650\u7ED3\u675F\u540E"),n("a",cn,[s("\u5220\u9664"),a(e)]),s("\u3002")])]),n("li",pn,[rn,n("label",dn,[s(" Pod \u81EA\u8EAB\u4E0D\u5177\u6709\u81EA\u6108\u80FD\u529B\u3002\u5982\u679C Pod \u88AB\u8C03\u5EA6\u5230\u67D0"),n("a",un,[s("\u8282\u70B9"),a(e)]),s(" \u800C\u8BE5\u8282\u70B9\u4E4B\u540E\u5931\u6548\uFF0CPod \u4F1A\u88AB\u5220\u9664\uFF1B\u7C7B\u4F3C\u5730\uFF0CPod \u65E0\u6CD5\u5728\u56E0\u8282\u70B9\u8D44\u6E90 \u8017\u5C3D\u6216\u8005\u8282\u70B9\u7EF4\u62A4\u800C\u88AB\u9A71\u9010\u671F\u95F4\u7EE7\u7EED\u5B58\u6D3B\u3002Kubernetes \u4F7F\u7528\u4E00\u79CD\u9AD8\u7EA7\u62BD\u8C61 \u6765\u7BA1\u7406\u8FD9\u4E9B\u76F8\u5BF9\u800C\u8A00\u53EF\u968F\u65F6\u4E22\u5F03\u7684 Pod \u5B9E\u4F8B\uFF0C\u79F0\u4F5C "),n("a",kn,[s("\u63A7\u5236\u5668"),a(e)]),s("\u3002")])]),mn,n("li",bn,[vn,n("label",hn,[s(" \u5982\u679C\u67D0\u7269\u58F0\u79F0\u5176\u751F\u547D\u671F\u4E0E\u67D0 Pod \u76F8\u540C\uFF0C\u4F8B\u5982\u5B58\u50A8"),n("a",gn,[s("\u5377"),a(e)]),s("\uFF0C \u8FD9\u5C31\u610F\u5473\u7740\u8BE5\u5BF9\u8C61\u5728\u6B64 Pod \uFF08UID \u4EA6\u76F8\u540C\uFF09\u5B58\u5728\u671F\u95F4\u4E5F\u4E00\u76F4\u5B58\u5728\u3002 \u5982\u679C Pod \u56E0\u4E3A\u4EFB\u4F55\u539F\u56E0\u88AB\u5220\u9664\uFF0C\u751A\u81F3\u67D0\u5B8C\u5168\u76F8\u540C\u7684\u66FF\u4EE3 Pod \u88AB\u521B\u5EFA\u65F6\uFF0C \u8FD9\u4E2A\u76F8\u5173\u7684\u5BF9\u8C61\uFF08\u4F8B\u5982\u8FD9\u91CC\u7684\u5377\uFF09\u4E5F\u4F1A\u88AB\u5220\u9664\u5E76\u91CD\u5EFA\u3002")])])]),yn,n("p",null,[s("Kubernetes \u4F1A\u8DDF\u8E2A Pod \u4E2D\u6BCF\u4E2A\u5BB9\u5668\u7684\u72B6\u6001\uFF0C\u5C31\u50CF\u5B83\u8DDF\u8E2A Pod \u603B\u4F53\u4E0A\u7684"),n("a",Pn,[s("\u9636\u6BB5"),a(e)]),s("\u4E00\u6837\u3002 \u4F60\u53EF\u4EE5\u4F7F\u7528"),n("a",_n,[s("\u5BB9\u5668\u751F\u547D\u5468\u671F\u56DE\u8C03"),a(e)]),s(" \u6765\u5728\u5BB9\u5668\u751F\u547D\u5468\u671F\u4E2D\u7684\u7279\u5B9A\u65F6\u95F4\u70B9\u89E6\u53D1\u4E8B\u4EF6\u3002")]),n("p",null,[s("\u4E00\u65E6"),n("a",fn,[s("\u8C03\u5EA6\u5668"),a(e)]),s("\u5C06 Pod \u5206\u6D3E\u7ED9\u67D0\u4E2A\u8282\u70B9\uFF0C"),xn,s(" \u5C31\u901A\u8FC7 "),n("a",An,[s("\u5BB9\u5668\u8FD0\u884C\u65F6"),a(e)]),s(" \u5F00\u59CB\u4E3A Pod \u521B\u5EFA\u5BB9\u5668\u3002")]),Rn,n("p",null,[s("Pod \u6709\u4E00\u4E2A PodStatus \u5BF9\u8C61\uFF0C\u5176\u4E2D\u5305\u542B\u4E00\u4E2A "),n("a",En,[s("PodConditions"),a(e)]),s(" \u6570\u7EC4\u3002Pod \u53EF\u80FD\u901A\u8FC7\u4E5F\u53EF\u80FD\u672A\u901A\u8FC7\u5176\u4E2D\u7684\u4E00\u4E9B\u72B6\u51B5\u6D4B\u8BD5\u3002")]),n("ul",null,[wn,Sn,n("li",null,[Tn,s("\uFF1A\u6240\u6709\u7684 "),n("a",qn,[s("Init \u5BB9\u5668"),a(e)]),s(" \u90FD\u5DF2\u6210\u529F\u542F\u52A8\uFF1B")]),Cn]),Dn,n("p",null,[n("a",zn,[s("Probe"),a(e)]),s(" \u662F\u7531 "),n("a",jn,[s("kubelet"),a(e)]),s(" \u5BF9\u5BB9\u5668\u6267\u884C\u7684\u5B9A\u671F\u8BCA\u65AD\u3002 \u8981\u6267\u884C\u8BCA\u65AD\uFF0Ckubelet \u8C03\u7528\u7531\u5BB9\u5668\u5B9E\u73B0\u7684 "),n("a",Nn,[s("Handler"),a(e)]),s(" \uFF08\u5904\u7406\u7A0B\u5E8F\uFF09\u3002\u6709\u4E09\u79CD\u7C7B\u578B\u7684\u5904\u7406\u7A0B\u5E8F\uFF1A")]),n("ul",null,[n("li",null,[n("a",In,[s("ExecAction"),a(e)]),s("\uFF1A \u5728\u5BB9\u5668\u5185\u6267\u884C\u6307\u5B9A\u547D\u4EE4\u3002\u5982\u679C\u547D\u4EE4\u9000\u51FA\u65F6\u8FD4\u56DE\u7801\u4E3A 0 \u5219\u8BA4\u4E3A\u8BCA\u65AD\u6210\u529F\u3002")]),n("li",null,[n("a",Mn,[s("TCPSocketAction"),a(e)]),s("\uFF1A \u5BF9\u5BB9\u5668\u7684 IP \u5730\u5740\u4E0A\u7684\u6307\u5B9A\u7AEF\u53E3\u6267\u884C TCP \u68C0\u67E5\u3002\u5982\u679C\u7AEF\u53E3\u6253\u5F00\uFF0C\u5219\u8BCA\u65AD\u88AB\u8BA4\u4E3A\u662F\u6210\u529F\u7684\u3002")]),n("li",null,[n("a",Un,[s("HTTPGetAction"),a(e)]),s("\uFF1A \u5BF9\u5BB9\u5668\u7684 IP \u5730\u5740\u4E0A\u6307\u5B9A\u7AEF\u53E3\u548C\u8DEF\u5F84\u6267\u884C HTTP Get \u8BF7\u6C42\u3002\u5982\u679C\u54CD\u5E94\u7684\u72B6\u6001\u7801\u5927\u4E8E\u7B49\u4E8E 200 \u4E14\u5C0F\u4E8E 400\uFF0C\u5219\u8BCA\u65AD\u88AB\u8BA4\u4E3A\u662F\u6210\u529F\u7684\u3002")])]),Ln,n("ul",null,[n("li",null,[n("p",null,[Jn,s("\uFF1A\u6307\u793A\u5BB9\u5668\u662F\u5426\u6B63\u5728\u8FD0\u884C\u3002\u5982\u679C\u5B58\u6D3B\u6001\u63A2\u6D4B\u5931\u8D25\uFF0C\u5219 kubelet \u4F1A\u6740\u6B7B\u5BB9\u5668\uFF0C \u5E76\u4E14\u5BB9\u5668\u5C06\u6839\u636E\u5176"),n("a",On,[s("\u91CD\u542F\u7B56\u7565"),a(e)]),s("\u51B3\u5B9A\u672A\u6765\u3002\u5982\u679C\u5BB9\u5668\u4E0D\u63D0\u4F9B\u5B58\u6D3B\u63A2\u9488\uFF0C \u5219\u9ED8\u8BA4\u72B6\u6001\u4E3A "),Gn,s("\u3002")])]),Hn,n("li",null,[n("p",null,[Kn,s(": \u6307\u793A\u5BB9\u5668\u4E2D\u7684\u5E94\u7528\u662F\u5426\u5DF2\u7ECF\u542F\u52A8\u3002\u5982\u679C\u63D0\u4F9B\u4E86\u542F\u52A8\u63A2\u9488\uFF0C\u5219\u6240\u6709\u5176\u4ED6\u63A2\u9488\u90FD\u4F1A\u88AB \u7981\u7528\uFF0C\u76F4\u5230\u6B64\u63A2\u9488\u6210\u529F\u4E3A\u6B62\u3002\u5982\u679C\u542F\u52A8\u63A2\u6D4B\u5931\u8D25\uFF0C"),Yn,s(" \u5C06\u6740\u6B7B\u5BB9\u5668\uFF0C\u800C\u5BB9\u5668\u4F9D\u5176 "),n("a",Vn,[s("\u91CD\u542F\u7B56\u7565"),a(e)]),s("\u8FDB\u884C\u91CD\u542F\u3002 \u5982\u679C\u5BB9\u5668\u6CA1\u6709\u63D0\u4F9B\u542F\u52A8\u63A2\u6D4B\uFF0C\u5219\u9ED8\u8BA4\u72B6\u6001\u4E3A "),Fn,s("\u3002")])]),$n]),Bn,n("ul",null,[n("li",null,[n("p",null,[Xn,s(" \u76F4\u63A5\u7531\u7279\u5B9A\u8282\u70B9\u4E0A\u7684 "),Wn,s(" \u5B88\u62A4\u8FDB\u7A0B\u7BA1\u7406\uFF0C \u4E0D\u9700\u8981"),n("a",Zn,[s("API \u670D\u52A1\u5668"),a(e)]),s("\u770B\u5230\u5B83\u4EEC\u3002 \u5C3D\u7BA1\u5927\u591A\u6570 Pod \u90FD\u662F\u901A\u8FC7\u63A7\u5236\u9762\uFF08\u4F8B\u5982\uFF0C"),n("a",Qn,[s("Deployment"),a(e)]),s("\uFF09 \u6765\u7BA1\u7406\u7684\uFF0C\u5BF9\u4E8E\u9759\u6001 Pod \u800C\u8A00\uFF0C"),ns,s(" \u76F4\u63A5\u76D1\u63A7\u6BCF\u4E2A Pod\uFF0C\u5E76\u5728\u5176\u5931\u6548\u65F6\u91CD\u542F\u4E4B\u3002")])]),n("li",null,[n("p",null,[s("\u9759\u6001 Pod \u901A\u5E38\u7ED1\u5B9A\u5230\u67D0\u4E2A\u8282\u70B9\u4E0A\u7684 "),n("a",ss,[s("kubelet"),a(e)]),s("\u3002 \u5176\u4E3B\u8981\u7528\u9014\u662F\u8FD0\u884C\u81EA\u6258\u7BA1\u7684\u63A7\u5236\u9762\u3002 \u5728\u81EA\u6258\u7BA1\u573A\u666F\u4E2D\uFF0C\u4F7F\u7528 "),es,s(" \u6765\u7BA1\u7406\u5404\u4E2A\u72EC\u7ACB\u7684 "),n("a",as,[s("\u63A7\u5236\u9762\u7EC4\u4EF6"),a(e)]),s("\u3002")])]),n("li",null,[n("p",null,[ts,s(" \u81EA\u52A8\u5C1D\u8BD5\u4E3A\u6BCF\u4E2A\u9759\u6001 Pod \u5728 Kubernetes API \u670D\u52A1\u5668\u4E0A\u521B\u5EFA\u4E00\u4E2A "),n("a",ls,[s("\u955C\u50CF Pod"),a(e)]),s("\u3002 \u8FD9\u610F\u5473\u7740\u5728\u8282\u70B9\u4E0A\u8FD0\u884C\u7684 Pod \u5728 API \u670D\u52A1\u5668\u4E0A\u662F\u53EF\u89C1\u7684\uFF0C\u4F46\u4E0D\u53EF\u4EE5\u901A\u8FC7 API \u670D\u52A1\u5668\u6765\u63A7\u5236\u3002")])]),n("li",null,[os,n("p",null,[s("\u9759\u6001 Pod \u7684 "),is,s(" \u4E0D\u80FD\u5F15\u7528\u5176\u4ED6\u7684 API \u5BF9\u8C61\uFF08\u4F8B\u5982\uFF1A"),n("a",cs,[s("ServiceAccount"),a(e)]),s("\u3001"),n("a",ps,[s("ConfigMap"),a(e)]),s("\u3001"),n("a",rs,[s("Secret"),a(e)]),s("\u7B49\uFF09\u3002")])])]),ds])}const hs=l(p,[["render",us],["__file","06.Kubernetes\u5E94\u7528\u7A0B\u5E8F\u751F\u547D\u5468\u671F\u7BA1\u7406.html.vue"]]);export{hs as default};
