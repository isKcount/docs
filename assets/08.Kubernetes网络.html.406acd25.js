import{_ as p}from"./_plugin-vue_export-helper.cdc0426e.js";import{o,c as l,a as n,b as s,d as e,f as t,r as c}from"./app.ca0279c0.js";const i={},r=t(`<h1 id="kubernetes\u7F51\u7EDC" tabindex="-1"><a class="header-anchor" href="#kubernetes\u7F51\u7EDC" aria-hidden="true">#</a> Kubernetes\u7F51\u7EDC</h1><h2 id="service" tabindex="-1"><a class="header-anchor" href="#service" aria-hidden="true">#</a> Service</h2><h3 id="service\u5B58\u5728\u7684\u610F\u4E49" tabindex="-1"><a class="header-anchor" href="#service\u5B58\u5728\u7684\u610F\u4E49" aria-hidden="true">#</a> Service\u5B58\u5728\u7684\u610F\u4E49</h3><ul><li><p>service\u662Fk8s\u4E2D\u7684\u4E00\u4E2A\u91CD\u8981\u6982\u5FF5\uFF0C\u4E3B\u8981\u662F\u63D0\u4F9B\u8D1F\u8F7D\u5747\u8861\u548C\u670D\u52A1</p></li><li><p>\u9632\u6B62Pod\u5931\u8054</p></li><li><p>\u5B9A\u4E49\u4E00\u7EC4Pod\u7684\u8BBF\u95EE\u7B56\u7565</p></li><li><p>\u4E3A\u4E86\u89E3\u51B3\u4EE5\u4E0B\u4E24\u4E2A\u95EE\u9898\uFF0CK8s\u5F15\u5165Service</p></li><li><p><strong>Pod\u7684IP\u4E0D\u56FA\u5B9A\uFF1A</strong></p><ul><li><strong>\u589E\u52A0\u4E00\u4E2A\u63A7\u5236\u5668\u8D1F\u8D23\u52A8\u6001\u83B7\u53D6Pod\u7684\u5217\u8868IP\uFF0C\u52A8\u6001\u66F4\u65B0\u5230\u8D1F\u8F7D\u5747\u8861\u5668\u914D\u7F6E\u3002</strong></li></ul></li><li><p><strong>Pod\u662F\u591A\u526F\u672C</strong></p><ul><li><strong>\u524D\u9762\u589E\u52A0\u4E00\u4E2A\u8D1F\u8F7D\u5747\u8861\u5668</strong></li></ul></li></ul><h3 id="pod\u4E0Eservice\u7684\u5173\u7CFB" tabindex="-1"><a class="header-anchor" href="#pod\u4E0Eservice\u7684\u5173\u7CFB" aria-hidden="true">#</a> Pod\u4E0EService\u7684\u5173\u7CFB</h3><ul><li><p>\u901A\u8FC7label-selector\u76F8\u5173\u8054</p></li><li><p>\u901A\u8FC7Service\u5B9E\u73B0Pod\u7684\u8D1F\u8F7D\u5747\u8861\uFF08TCP/UDP 4\u5C42\uFF09</p></li></ul><h3 id="service\u7684\u4E09\u79CD\u7C7B\u578B" tabindex="-1"><a class="header-anchor" href="#service\u7684\u4E09\u79CD\u7C7B\u578B" aria-hidden="true">#</a> Service\u7684\u4E09\u79CD\u7C7B\u578B</h3><ul><li><p><strong>ClusterIP\uFF1A\u96C6\u7FA4\u5185\u90E8\u4F7F\u7528</strong></p></li><li><p><strong>NodePort\uFF1A\u5BF9\u5916\u66B4\u9732\u5E94\u7528</strong></p></li><li><p><strong>LoadBalancer\uFF1A\u5BF9\u5916\u66B4\u9732\u5E94\u7528\uFF0C\u9002\u7528\u516C\u6709\u4E91</strong></p></li><li><p><code>ClusterIP</code>\uFF1A\u9ED8\u8BA4\uFF0C\u5206\u914D\u4E00\u4E2A\u7A33\u5B9A\u7684IP\u5730\u5740\uFF0C\u5373VIP\uFF0C\u53EA\u80FD\u5728\u96C6\u7FA4\u5185 \u90E8\u8BBF\u95EE\uFF08\u540CNamespace\u5185\u7684Pod\uFF09\u3002</p></li><li><p><code>NodePort</code>\uFF1A\u5728\u6BCF\u4E2A\u8282\u70B9\u4E0A\u542F\u7528\u4E00\u4E2A\u7AEF\u53E3\u6765\u66B4\u9732\u670D\u52A1\uFF0C\u53EF\u4EE5\u5728\u96C6\u7FA4 \u5916\u90E8\u8BBF\u95EE\u3002\u4E5F\u4F1A\u5206\u914D\u4E00\u4E2A\u7A33\u5B9A\u5185\u90E8\u96C6\u7FA4IP\u5730\u5740\u3002 \u8BBF\u95EE\u5730\u5740\uFF1A: \u7AEF\u53E3\u8303\u56F4\uFF1A30000-32767\u3002</p></li><li><p><code>LoadBalancer</code>\uFF1A\u4E0ENodePort\u7C7B\u4F3C\uFF0C\u5728\u6BCF\u4E2A\u8282\u70B9\u4E0A\u542F\u7528\u4E00\u4E2A\u7AEF\u53E3\u6765\u66B4 \u9732\u670D\u52A1\u3002\u9664\u6B64\u4E4B\u5916\uFF0CKubernetes\u4F1A\u8BF7\u6C42\u5E95\u5C42\u4E91\u5E73\u53F0\u4E0A\u7684\u8D1F\u8F7D\u5747\u8861\u5668\uFF0C \u5C06\u6BCF\u4E2ANode\uFF08[NodeIP]:[NodePort]\uFF09\u4F5C\u4E3A\u540E\u7AEF\u6DFB\u52A0\u8FDB\u53BB\u3002</p></li></ul><blockquote><p><strong>ClusterIP\u7684\u7528\u6CD5</strong></p></blockquote><ul><li><strong>\u67E5\u770Bdeployment</strong></li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get deployment</span>
NAME   READY   UP-TO-DATE   AVAILABLE   AGE
web    <span class="token number">1</span>/1     <span class="token number">1</span>            <span class="token number">1</span>           71s
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>\u5FEB\u901F\u751F\u6210\u4E00\u4E2A\u7ED1\u5B9Adeployment\u7684web\u7684service\u7AEF\u53E3\u5F00\u653E</strong></li></ul><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl expose deployment web --port=80 --target-port=80 --type=ClusterIP --dry-run -o yaml  &gt; service.yaml</span>
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># cat service.yaml</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> web
  <span class="token key atrule">name</span><span class="token punctuation">:</span> web
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">type</span><span class="token punctuation">:</span> ClusterIP			<span class="token comment">#\u8FD9\u91CC\u662F\u6307\u5B9A\u7C7B\u578B\uFF0C\u9ED8\u8BA4\u662FClusterIP</span>
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>				<span class="token comment">#service\uFF08\u8D1F\u8F7D\u5747\u8861\u5668\uFF09\u7AEF\u53E3\uFF0C\u53EA\u80FD\u518Dk8s\u96C6\u7FA4\u5185\u90E8\u8BBF\u95EE\uFF0C\uFF08node\u548CPod\uFF09</span>
    <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP			<span class="token comment">#\u7AEF\u53E3\u7684\u534F\u8BAE</span>
    <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">80</span>			<span class="token comment">#\u5BB9\u5668\u4E2D\u63D0\u4F9B\u670D\u52A1\u7684\u7AEF\u53E3</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>					<span class="token comment">#\u6807\u7B7E\u9009\u62E9\u5668\uFF0C\u7528\u6765\u5173\u8054pod</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> web
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>\u8FD0\u884Cservice\u7684yaml\u6587\u4EF6</strong></li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f service.yaml</span>
service/web created

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get service</span>
NAME         TYPE        CLUSTER-IP     EXTERNAL-IP   PORT<span class="token punctuation">(</span>S<span class="token punctuation">)</span>   AGE
kubernetes   ClusterIP   <span class="token number">10.96</span>.0.1      <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">443</span>/TCP   29h
web          ClusterIP   <span class="token number">10.107</span>.119.3   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">80</span>/TCP    5s
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>\u8BBF\u95EEservice\u7684\u5730\u5740</strong></li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># curl 10.107.119.3</span>
<span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>Welcome to nginx<span class="token operator">!</span><span class="token operator">&lt;</span>/title<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>
html <span class="token punctuation">{</span> color-scheme: light dark<span class="token punctuation">;</span> <span class="token punctuation">}</span>
body <span class="token punctuation">{</span> width: 35em<span class="token punctuation">;</span> margin: <span class="token number">0</span> auto<span class="token punctuation">;</span>
font-family: Tahoma, Verdana, Arial, sans-serif<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token operator">&lt;</span>/style<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/head<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>h<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>Welcome to nginx<span class="token operator">!</span><span class="token operator">&lt;</span>/h<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>
<span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.<span class="token operator">&lt;</span>/p<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>For online documentation and support please refer to
<span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;http://nginx.org/&quot;</span><span class="token operator">&gt;</span>nginx.org<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span>.<span class="token operator">&lt;</span>br/<span class="token operator">&gt;</span>
Commercial support is available at
<span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;http://nginx.com/&quot;</span><span class="token operator">&gt;</span>nginx.com<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span>.<span class="token operator">&lt;</span>/p<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token operator">&lt;</span>em<span class="token operator">&gt;</span>Thank you <span class="token keyword">for</span> using nginx.<span class="token operator">&lt;</span>/em<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/p<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/html<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>NodePort\u7684\u7528\u6CD5</strong></p></blockquote><ul><li><strong>\u4FEE\u6539service\u7684\u7AEF\u53E3\u7C7B\u578B</strong></li></ul><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># cat service.yaml</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> web
  <span class="token key atrule">name</span><span class="token punctuation">:</span> web
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">type</span><span class="token punctuation">:</span> NodePort		<span class="token comment">#\u66B4\u9732\u7AEF\u53E3\u7C7B\u578B\u7528NodePort </span>
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>
    <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
    <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
     <span class="token key atrule">nodePort</span><span class="token punctuation">:</span> <span class="token number">30002</span>     <span class="token comment">#\u53EF\u4EE5\u6307\u5B9A\u4E00\u4E2A\u66B4\u9732\u7AEF\u53E3\uFF0C\u4E5F\u53EF\u4EE5\u9ED8\u8BA4\u751F\u6210</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> web
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>\u67E5\u770Bservice\u66F4\u65B0\u7684\u7AEF\u53E3\u5E76\u4E14\u8BBF\u95EE</strong></li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get service</span>
NAME         TYPE        CLUSTER-IP      EXTERNAL-IP   PORT<span class="token punctuation">(</span>S<span class="token punctuation">)</span>        AGE
kubernetes   ClusterIP   <span class="token number">10.96</span>.0.1       <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">443</span>/TCP        29h
web          NodePort    <span class="token number">10.111</span>.240.72   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">80</span>:30002/TCP   8s

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># curl 192.168.1.104:30002</span>
<span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>Welcome to nginx<span class="token operator">!</span><span class="token operator">&lt;</span>/title<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>
html <span class="token punctuation">{</span> color-scheme: light dark<span class="token punctuation">;</span> <span class="token punctuation">}</span>
body <span class="token punctuation">{</span> width: 35em<span class="token punctuation">;</span> margin: <span class="token number">0</span> auto<span class="token punctuation">;</span>
font-family: Tahoma, Verdana, Arial, sans-serif<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token operator">&lt;</span>/style<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/head<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>h<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>Welcome to nginx<span class="token operator">!</span><span class="token operator">&lt;</span>/h<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>
<span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.<span class="token operator">&lt;</span>/p<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>For online documentation and support please refer to
<span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;http://nginx.org/&quot;</span><span class="token operator">&gt;</span>nginx.org<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span>.<span class="token operator">&lt;</span>br/<span class="token operator">&gt;</span>
Commercial support is available at
<span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;http://nginx.com/&quot;</span><span class="token operator">&gt;</span>nginx.com<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span>.<span class="token operator">&lt;</span>/p<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token operator">&lt;</span>em<span class="token operator">&gt;</span>Thank you <span class="token keyword">for</span> using nginx.<span class="token operator">&lt;</span>/em<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/p<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/html<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="service\u4EE3\u7406\u6A21\u5F0F" tabindex="-1"><a class="header-anchor" href="#service\u4EE3\u7406\u6A21\u5F0F" aria-hidden="true">#</a> Service\u4EE3\u7406\u6A21\u5F0F</h3><blockquote><p><strong>Service\u7684\u51E0\u79CD\u4EE3\u7406</strong></p></blockquote><ul><li><p><code>userspace</code></p></li><li><p><code>iptables \uFF08\u9ED8\u8BA4\uFF09</code></p></li><li><p><code>ipvs \uFF08lvs\uFF09</code></p></li></ul><blockquote><p><strong>iptables\u9ED8\u8BA4\u65B9\u5F0F</strong></p></blockquote><ul><li><strong>\u90E8\u7F72\u4E00\u4E2AClusterIP\u7684\u65B9\u5F0F\u66B4\u9732\u7AEF\u53E3\u7684Pod</strong></li></ul><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># cat service.yaml</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> web
  <span class="token key atrule">name</span><span class="token punctuation">:</span> web
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>
    <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
    <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> web
  <span class="token key atrule">type</span><span class="token punctuation">:</span> ClusterIP
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl apply  -f service.yaml</span>
service/web unchanged

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl  get service</span>
NAME         TYPE        CLUSTER<span class="token punctuation">-</span>IP      EXTERNAL<span class="token punctuation">-</span>IP   PORT(S)   AGE
kubernetes   ClusterIP   10.96.0.1       &lt;none<span class="token punctuation">&gt;</span>        443/TCP   4h20m
web          ClusterIP   10.101.63.199   &lt;none<span class="token punctuation">&gt;</span>        80/TCP    21m
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>\u67E5\u770B\u9ED8\u8BA4\u7684iptables\u4EE3\u7406\u662F\u600E\u4E48\u5B9E\u73B0\u8D1F\u8F7D\u5747\u8861\u7684\u673A\u5236</strong></li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># iptables-save  | grep 10.101.63.199</span>

<span class="token comment">#\u7B2C\u4E00\u6B65</span>
<span class="token parameter variable">-A</span> KUBE-SERVICES <span class="token operator">!</span> <span class="token parameter variable">-s</span> <span class="token number">10.244</span>.0.0/16 <span class="token parameter variable">-d</span> <span class="token number">10.101</span>.63.199/32 <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-m</span> comment <span class="token parameter variable">--comment</span> <span class="token string">&quot;default/web cluster IP&quot;</span> <span class="token parameter variable">-m</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">80</span> <span class="token parameter variable">-j</span> KUBE-MARK-MASQ

<span class="token comment">#\u7B2C\u4E8C\u6B65</span>
<span class="token parameter variable">-A</span> KUBE-SVC-LOLE4ISW44XBNF3G <span class="token parameter variable">-m</span> comment <span class="token parameter variable">--comment</span> <span class="token string">&quot;default/web&quot;</span> <span class="token parameter variable">-j</span> KUBE-SEP-NBPPORLROMQLLPIL

<span class="token comment">#\u7B2C\u4E09\u6B65</span>
<span class="token parameter variable">-A</span> KUBE-SERVICES <span class="token parameter variable">-d</span> <span class="token number">10.101</span>.63.199/32 <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">-m</span> comment <span class="token parameter variable">--comment</span> <span class="token string">&quot;default/web cluster IP&quot;</span> <span class="token parameter variable">-m</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">80</span> <span class="token parameter variable">-j</span> KUBE-SVC-LOLE4ISW44XBNF3G
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>ipvs\u6A21\u5F0F</p></blockquote><p><strong>\u4FEE\u6539\u4E3Aipvs\u6A21\u5F0F</strong></p><p><strong>kubeadm\u65B9\u5F0F\u4FEE\u6539ipvs\u6A21\u5F0F\uFF1A</strong></p><p><strong>\u6CE8\uFF1A</strong></p><ul><li><p><strong>kube-proxy\u914D\u7F6E\u6587\u4EF6\u4EE5configmap\u65B9\u5F0F\u5B58\u50A8</strong></p></li><li><p><strong>\u5982\u679C\u8BA9\u6240\u6709\u8282\u70B9\u751F\u6548\uFF0C\u9700\u8981\u91CD\u5EFA\u6240\u6709\u8282\u70B9kube-proxy pod</strong></p></li><li><p><strong>\u4FEE\u6539\u914D\u7F6E\u6587\u4EF6\u5220\u9664Pod</strong></p></li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl edit configmaps -n kube-system kube-proxy</span>
\xB7\xB7\xB7
    mode: <span class="token string">&quot;ipvs&quot;</span>
\xB7\xB7\xB7

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl delete pod -n kube-system kube-proxy-628k6 kube-proxy-7sbfn kube-proxy-jzrxz</span>
pod <span class="token string">&quot;kube-proxy-628k6&quot;</span> deleted
pod <span class="token string">&quot;kube-proxy-7sbfn&quot;</span> deleted
pod <span class="token string">&quot;kube-proxy-jzrxz&quot;</span> deleted
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>\u67E5\u770B\u5F53\u524D\u6A21\u5F0F</strong></li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl logs -n kube-system kube-proxy-c8vzr | grep ipvs</span>
I1103 09:20:08.747308       <span class="token number">1</span> server_others.go:258<span class="token punctuation">]</span> Using ipvs Proxier.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>\u5B89\u88C5ipvs\u5DE5\u5177</strong></li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># yum install -y  ipvsadm</span>
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># ipvsadm -L -n   </span>
\xB7 <span class="token parameter variable">-L</span> \u5217\u51FA\u6240\u6709\u89C4\u5219
\xB7 <span class="token parameter variable">-n</span> \u4EE5\u975E\u4E3B\u673A\u540D\u7684\u65B9\u5F0F\u53BB\u663E\u793A

IP Virtual Server version <span class="token number">1.2</span>.1 <span class="token punctuation">(</span>size<span class="token operator">=</span><span class="token number">4096</span><span class="token punctuation">)</span>
Prot LocalAddress:Port Scheduler Flags
  -<span class="token operator">&gt;</span> RemoteAddress:Port           Forward Weight ActiveConn InActConn
TCP  <span class="token number">192.168</span>.1.104:32238 rr
  -<span class="token operator">&gt;</span> <span class="token number">10.244</span>.104.1:80              Masq    <span class="token number">1</span>      <span class="token number">0</span>          <span class="token number">0</span>
TCP  <span class="token number">10.96</span>.0.1:443 rr
  -<span class="token operator">&gt;</span> <span class="token number">192.168</span>.1.104:6443           Masq    <span class="token number">1</span>      <span class="token number">0</span>          <span class="token number">0</span>
TCP  <span class="token number">10.96</span>.0.10:53 rr
  -<span class="token operator">&gt;</span> <span class="token number">10.244</span>.219.66:53             Masq    <span class="token number">1</span>      <span class="token number">0</span>          <span class="token number">0</span>
  -<span class="token operator">&gt;</span> <span class="token number">10.244</span>.219.67:53             Masq    <span class="token number">1</span>      <span class="token number">0</span>          <span class="token number">0</span>
TCP  <span class="token number">10.96</span>.0.10:9153 rr
  -<span class="token operator">&gt;</span> <span class="token number">10.244</span>.219.66:9153           Masq    <span class="token number">1</span>      <span class="token number">0</span>          <span class="token number">0</span>
  -<span class="token operator">&gt;</span> <span class="token number">10.244</span>.219.67:9153           Masq    <span class="token number">1</span>      <span class="token number">0</span>          <span class="token number">0</span>
TCP  <span class="token number">10.101</span>.63.199:80 rr
  -<span class="token operator">&gt;</span> <span class="token number">10.244</span>.104.1:80              Masq    <span class="token number">1</span>      <span class="token number">0</span>          <span class="token number">0</span>
TCP  <span class="token number">10.244</span>.219.64:32238 rr
  -<span class="token operator">&gt;</span> <span class="token number">10.244</span>.104.1:80              Masq    <span class="token number">1</span>      <span class="token number">0</span>          <span class="token number">0</span>
TCP  <span class="token number">127.0</span>.0.1:32238 rr
  -<span class="token operator">&gt;</span> <span class="token number">10.244</span>.104.1:80              Masq    <span class="token number">1</span>      <span class="token number">0</span>          <span class="token number">0</span>
TCP  <span class="token number">172.17</span>.0.1:32238 rr
  -<span class="token operator">&gt;</span> <span class="token number">10.244</span>.104.1:80              Masq    <span class="token number">1</span>      <span class="token number">0</span>          <span class="token number">0</span>
UDP  <span class="token number">10.96</span>.0.10:53 rr
  -<span class="token operator">&gt;</span> <span class="token number">10.244</span>.219.66:53             Masq    <span class="token number">1</span>      <span class="token number">0</span>          <span class="token number">0</span>
  -<span class="token operator">&gt;</span> <span class="token number">10.244</span>.219.67:53             Masq    <span class="token number">1</span>      <span class="token number">0</span>          <span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ipvs\u7684\u8BBF\u95EE\u6D41\u7A0B\uFF1A</strong></p><ul><li><strong><code>curl service ip &gt; kube-ipvs0(virtual server) &gt; pod(real server)</code></strong></li><li><code>\u901A\u8FC7\u5185\u7F6E\u7684ipvs\u7F51\u5361\u5B9E\u73B0\u8D1F\u8F7D\u7684\u529F\u80FD</code></li><li><strong><code>IPVS\u6A21\u5F0F\u4E0B\uFF0Cingress\u548Cservice\u4F7F\u7528\u76F8\u540C\u7684ELB\u5B9E\u4F8B\u65F6\uFF0C\u65E0\u6CD5\u5728\u96C6\u7FA4\u5185\u7684\u8282\u70B9\u548C\u5BB9\u5668\u4E2D\u8BBF\u95EEingress</code></strong></li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">9</span>: kube-ipvs0: <span class="token operator">&lt;</span>BROADCAST,NOARP<span class="token operator">&gt;</span> mtu <span class="token number">1500</span> qdisc noop state DOWN group default
    link/ether 2e:a3:33:75:1d:20 brd ff:ff:ff:ff:ff:ff
    inet <span class="token number">10.96</span>.0.1/32 scope global kube-ipvs0
       valid_lft forever preferred_lft forever
    inet <span class="token number">10.96</span>.0.10/32 scope global kube-ipvs0
       valid_lft forever preferred_lft forever
    inet <span class="token number">10.101</span>.63.199/32 scope global kube-ipvs0
       valid_lft forever preferred_lft forever
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>Iptables VS IPVS</strong></p></blockquote><p><strong>Iptables\uFF1A</strong></p><ul><li><p><code>\u7075\u6D3B\uFF0C\u529F\u80FD\u5F3A\u5927</code></p></li><li><p><code>\u89C4\u5219\u904D\u5386\u5339\u914D\u548C\u66F4\u65B0\uFF0C\u5448\u7EBF\u6027\u65F6\u5EF6</code></p></li></ul><p><strong>IPVS\uFF1A</strong></p><ul><li><p><code>\u5DE5\u4F5C\u5728\u5185\u6838\u6001\uFF0C\u6709\u66F4\u597D\u7684\u6027\u80FD</code></p></li><li><p><code>\u8C03\u5EA6\u7B97\u6CD5\u4E30\u5BCC\uFF1Arr\uFF0Cwrr\uFF0Clc\uFF0Cwlc\uFF0Cip hash..</code></p></li></ul><h3 id="service-dns\u540D\u79F0" tabindex="-1"><a class="header-anchor" href="#service-dns\u540D\u79F0" aria-hidden="true">#</a> Service DNS\u540D\u79F0</h3><blockquote><p><strong>CoreDNS\uFF1A</strong></p><p>\u662F\u4E00\u4E2ADNS\u670D\u52A1\u5668\uFF0CKubernetes\u9ED8\u8BA4\u91C7\u7528\uFF0C\u4EE5Pod\u90E8\u7F72\u5728\u96C6\u7FA4\u4E2D\uFF0CCoreDNS\u670D \u52A1\u76D1\u89C6Kubernetes API\uFF0C\u4E3A\u6BCF\u4E00\u4E2AService\u521B\u5EFADNS\u8BB0\u5F55\u7528\u4E8E\u57DF\u540D\u89E3\u6790\u3002</p></blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>CoreDNS YAML\u6587\u4EF6\uFF1A
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># wget https://github.com/kubernetes/kubernetes/tree/master/cluster/addons/dns/coredns  </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>ClusterIP A\u8BB0\u5F55\u683C\u5F0F\uFF1A<span class="token operator">&lt;</span>service-name<span class="token operator">&gt;</span>.<span class="token operator">&lt;</span>namespace-name<span class="token operator">&gt;</span>.svc.cluster.local
\u793A\u4F8B\uFF1Amy-svc.my-namespace.svc.cluster.local
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>\u8FD0\u884C\u4E00\u4E2A\u5BB9\u5668\u7528\u6765\u89E3\u6790k8s\u96C6\u7FA4\u7684\u57DF\u540D</strong></li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl run -it --rm --image=busybox:1.28.4 -- sh</span>

If you don&#39;t see a <span class="token builtin class-name">command</span> prompt, try pressing enter.

/ <span class="token comment"># nslookup</span>

<span class="token comment">#\u67E5\u770B\u4E00\u4E0Bservice\u7684custer\u2014ip</span>
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get service</span>
NAME         TYPE        CLUSTER-IP      EXTERNAL-IP   PORT<span class="token punctuation">(</span>S<span class="token punctuation">)</span>        AGE
kubernetes   ClusterIP   <span class="token number">10.96</span>.0.1       <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">443</span>/TCP        4h58m
web          NodePort    <span class="token number">10.101</span>.63.199   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">80</span>:32238/TCP   59m
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>\u89E3\u6790\u4E00\u4E0Bclusterip</strong></li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>BusyBox v1.28.4 <span class="token punctuation">(</span><span class="token number">2018</span>-05-22 <span class="token number">17</span>:00:17 UTC<span class="token punctuation">)</span> multi-call binary.
Usage: <span class="token function">nslookup</span> <span class="token punctuation">[</span>HOST<span class="token punctuation">]</span> <span class="token punctuation">[</span>SERVER<span class="token punctuation">]</span>

Query the nameserver <span class="token keyword">for</span> the IP address of the given HOST
optionally using a specified DNS server
/ <span class="token comment"># nslookup 10.101.63.199</span>
Server:    <span class="token number">10.96</span>.0.10
Address <span class="token number">1</span>: <span class="token number">10.96</span>.0.10 kube-dns.kube-system.svc.cluster.local

Name:      <span class="token number">10.101</span>.63.199
Address <span class="token number">1</span>: <span class="token number">10.101</span>.63.199 web.default.svc.cluster.local
/ <span class="token comment">#</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ingress" tabindex="-1"><a class="header-anchor" href="#ingress" aria-hidden="true">#</a> Ingress</h2><h3 id="ingress\u4E3A\u5F25\u8865nodeport\u4E0D\u8DB3\u800C\u751F" tabindex="-1"><a class="header-anchor" href="#ingress\u4E3A\u5F25\u8865nodeport\u4E0D\u8DB3\u800C\u751F" aria-hidden="true">#</a> Ingress\u4E3A\u5F25\u8865NodePort\u4E0D\u8DB3\u800C\u751F</h3><p><strong>NodePort\u5B58\u5728\u7684\u4E0D\u8DB3\uFF1A</strong></p><ul><li><p>\u4E00\u4E2A\u7AEF\u53E3\u53EA\u80FD\u4E00\u4E2A\u670D\u52A1\u4F7F\u7528\uFF0C\u7AEF\u53E3\u9700\u63D0\u524D\u89C4\u5212</p></li><li><p>\u53EA\u652F\u63014\u5C42\u8D1F\u8F7D\u5747\u8861</p></li></ul><blockquote><p><strong>Ingress\u662F\u4EC0\u4E48\uFF1F</strong></p><ul><li><p>Ingress\uFF1AIngress\u516C\u5F00\u4E86\u4ECE\u96C6\u7FA4\u5916\u90E8\u5230\u96C6\u7FA4\u5185\u670D\u52A1\u7684HTTP\u548CHTTPS\u8DEF\u7531\u7684\u89C4\u5219\u96C6\u5408\uFF0C\u800C\u5177\u4F53\u5B9E\u73B0\u6D41\u91CF\u8DEF \u7531\u5219\u662F\u7531Ingress Controller\u8D1F\u8D23\u3002</p></li><li><p>Ingress\uFF1AK8s\u4E2D\u7684\u4E00\u4E2A\u62BD\u8C61\u8D44\u6E90\uFF0C\u7ED9\u7BA1\u7406\u5458 \u63D0\u4F9B\u4E00\u4E2A\u66B4\u9732\u5E94\u7528\u7684\u5165\u53E3\u5B9A\u4E49\u65B9\u6CD5</p></li><li><p>Ingress Controller\uFF1A\u6839\u636EIngress\u751F\u6210\u5177\u4F53 \u7684\u8DEF\u7531\u89C4\u5219\uFF0C\u5E76\u5BF9Pod\u8D1F\u8F7D\u5747\u8861\u5668</p></li></ul><p><strong>Ingress\u662F\u6388\u6743\u5165\u7AD9\u8FDE\u63A5\u5230\u8FBE\u96C6\u7FA4\u670D\u52A1\u7684\u89C4\u5219\u96C6\u5408\u3002</strong></p><ul><li>\u4ECE\u5916\u90E8\u6D41\u91CF\u8C03\u5EA6\u5230nodeprot\u4E0A\u7684service</li><li>\u4ECEservice\u8C03\u5EA6\u5230ingress-controller</li><li>ingress-controller\u6839\u636Eingress\u4E2D\u7684\u5B9A\u4E49\uFF08\u865A\u62DF\u4E3B\u673A\u6216\u8005\u540E\u7AEF\u7684url\uFF09</li><li>\u6839\u636E\u865A\u62DF\u4E3B\u673A\u540D\u8C03\u5EA6\u5230\u540E\u7AEF\u7684\u4E00\u7EC4pod\u4E2D</li></ul></blockquote><blockquote><p><strong>Ingress Controller\u662F\u4EC0\u4E48\uFF1F</strong></p><p>Ingress\u7BA1\u7406\u7684\u8D1F\u8F7D\u5747\u8861\u5668\uFF0C\u4E3A\u96C6\u7FA4\u63D0\u4F9B\u5168\u5C40\u7684\u8D1F\u8F7D\u5747\u8861\u80FD\u529B\u3002</p><p><strong>\u4F7F\u7528\u6D41\u7A0B\uFF1A</strong></p><ol><li>\u90E8\u7F72Ingress Controller</li><li>\u521B\u5EFAIngress\u89C4\u5219</li></ol></blockquote><h3 id="ingress-controller" tabindex="-1"><a class="header-anchor" href="#ingress-controller" aria-hidden="true">#</a> Ingress Controller</h3>`,63),u={href:"https://kubernetes.io/zh/docs/concepts/services-networking/service/#nodeport",target:"_blank",rel:"noopener noreferrer"},k={href:"https://kubernetes.io/zh/docs/concepts/services-networking/service/#loadbalancer",target:"_blank",rel:"noopener noreferrer"},d=n("li",null,[n("p",null,"Ingress Controller\u6709\u5F88\u591A\u5B9E\u73B0\uFF0C\u6211\u4EEC\u8FD9\u91CC\u91C7\u7528\u5B98\u65B9\u7EF4\u62A4\u7684Nginx\u63A7\u5236\u5668\u3002")],-1),m={href:"https://github.com/kubernetes/ingress-nginx",target:"_blank",rel:"noopener noreferrer"},b=n("p",null,[n("strong",null,"\u4FEE\u6539YAML\uFF1A")],-1),v=n("ul",null,[n("li",null,[n("code",null,"\u955C\u50CF\u5730\u5740\u4FEE\u6539\u6210\u56FD\u5185\u7684\uFF1Alizhenliang/nginx-ingress-controller:0.30.0")]),n("li",null,[n("code",null,"\u5C06Ingress Controller\u66B4\u9732\uFF0C\u4E00\u822C\u4F7F\u7528\u5BBF\u4E3B\u673A\u7F51\u7EDC\uFF08hostNetwork: true\uFF09\u6216\u8005\u4F7F\u7528NodePort")])],-1),g=n("h3",{id:"\u73AF\u5883\u51C6\u5907",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u73AF\u5883\u51C6\u5907","aria-hidden":"true"},"#"),s(" \u73AF\u5883\u51C6\u5907")],-1),h={href:"https://kubernetes.io/zh/docs/concepts/services-networking/ingress-controllers",target:"_blank",rel:"noopener noreferrer"},y={href:"https://kubernetes.github.io/ingress-nginx/deploy/",target:"_blank",rel:"noopener noreferrer"},f={href:"https://kubernetes.io/zh/docs/concepts/services-networking/ingress-controllers",target:"_blank",rel:"noopener noreferrer"},x=n("li",null,[n("p",null,"\u7406\u60F3\u60C5\u51B5\u4E0B\uFF0C\u6240\u6709 Ingress \u63A7\u5236\u5668\u90FD\u5E94\u7B26\u5408\u53C2\u8003\u89C4\u8303\u3002\u4F46\u5B9E\u9645\u4E0A\uFF0C\u4E0D\u540C\u7684 Ingress \u63A7\u5236\u5668\u64CD\u4F5C\u7565\u6709\u4E0D\u540C\u3002")],-1),q=n("li",null,[n("p",null,[n("strong",null,"\u521D\u59CB\u5316Ingress\u7684\u63A7\u5236\u5668")])],-1),P=t(`<div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f  ingress-controller.yaml</span>
namespace/ingress-nginx unchanged
configmap/nginx-configuration unchanged
configmap/tcp-services unchanged
configmap/udp-services unchanged
serviceaccount/nginx-ingress-serviceaccount unchanged
Warning: rbac.authorization.k8s.io/v1beta1 ClusterRole is deprecated <span class="token keyword">in</span> v1.17+, unavailable <span class="token keyword">in</span> v1.22+<span class="token punctuation">;</span> use rbac.authorization.k8s.io/v1 ClusterRole
clusterrole.rbac.authorization.k8s.io/nginx-ingress-clusterrole unchanged
Warning: rbac.authorization.k8s.io/v1beta1 Role is deprecated <span class="token keyword">in</span> v1.17+, unavailable <span class="token keyword">in</span> v1.22+<span class="token punctuation">;</span> use rbac.authorization.k8s.io/v1 Role
role.rbac.authorization.k8s.io/nginx-ingress-role unchanged
Warning: rbac.authorization.k8s.io/v1beta1 RoleBinding is deprecated <span class="token keyword">in</span> v1.17+, unavailable <span class="token keyword">in</span> v1.22+<span class="token punctuation">;</span> use rbac.authorization.k8s.io/v1 RoleBinding
rolebinding.rbac.authorization.k8s.io/nginx-ingress-role-nisa-binding unchanged
Warning: rbac.authorization.k8s.io/v1beta1 ClusterRoleBinding is deprecated <span class="token keyword">in</span> v1.17+, unavailable <span class="token keyword">in</span> v1.22+<span class="token punctuation">;</span> use rbac.authorization.k8s.io/v1 ClusterRoleBinding
clusterrolebinding.rbac.authorization.k8s.io/nginx-ingress-clusterrole-nisa-binding unchanged
daemonset.apps/nginx-ingress-controller unchanged
limitrange/ingress-nginx configured
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>\u4F7F\u7528\u547D\u540D\u7A7A\u95F4\u9694\u79BB\u8D44\u6E90\uFF0C\u521B\u5EFAdeployment\u548Cservice</strong></li></ul><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># cat nginx.yaml</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Namespace
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> web<span class="token punctuation">-</span>test<span class="token punctuation">-</span>ns
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx
  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> web<span class="token punctuation">-</span>test<span class="token punctuation">-</span>ns
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">1</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx
        <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> web<span class="token punctuation">-</span>test<span class="token punctuation">-</span>ns
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>
    <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
    <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx
  <span class="token key atrule">type</span><span class="token punctuation">:</span> NodePort
  
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f  nginx.yaml</span>
namespace/web<span class="token punctuation">-</span>test<span class="token punctuation">-</span>ns created
deployment.apps/nginx created
service/nginx created

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get deployment -n web-test-ns</span>
NAME    READY   UP<span class="token punctuation">-</span>TO<span class="token punctuation">-</span>DATE   AVAILABLE   AGE
nginx   1/1     1            1           30m
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get service</span>
NAME         TYPE        CLUSTER<span class="token punctuation">-</span>IP    EXTERNAL<span class="token punctuation">-</span>IP   PORT(S)        AGE
kubernetes   ClusterIP   10.96.0.1     &lt;none<span class="token punctuation">&gt;</span>        443/TCP        8h
nginx        NodePort    10.106.56.3   &lt;none<span class="token punctuation">&gt;</span>        80<span class="token punctuation">:</span>31410/TCP   30m
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ingress-1" tabindex="-1"><a class="header-anchor" href="#ingress-1" aria-hidden="true">#</a> Ingress</h3><ul><li><p><strong>ingress\u53EF\u4EE5\u7ED9service\u63D0\u4F9B\u96C6\u7FA4\u5916\u90E8\u8BBF\u95EE\u7684url\u3001\u8D1F\u8F7D\u5747\u8861\u3001ssl\u7EC8\u6B62\u3001http\u8DEF\u7531\u7B49\u3002</strong></p></li><li><p><strong>\u4E3A\u4E86\u914D\u7F6E\u8FD9\u4E9Bingress\u89C4\u5219\uFF0C\u96C6\u7FA4\u7BA1\u7406\u5458\u9700\u8981\u90E8\u7F72\u4E00\u4E2Aingress controller\uFF0C\u5B83\u76D1\u542Cingress\u548Cservice\u7684\u53D8\u5316\uFF0C\u6839\u636E\u89C4\u5219\u914D\u7F6E\u8D1F\u8F7D\u5747\u8861\u5E76\u63D0\u4F9B\u8BBF\u95EE\u5165\u53E3</strong></p></li><li><p><strong>\u521B\u5EFA\u4E00\u4E2A\u6700\u5C0F\u8D44\u6E90\u5316\u7684Ingress</strong></p></li></ul><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span>$ kubectl create ingress ingsecret <span class="token punctuation">-</span><span class="token punctuation">-</span>class=default <span class="token punctuation">-</span><span class="token punctuation">-</span>rule=&quot;/<span class="token important">*=nginx:80&quot;</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>dry<span class="token punctuation">-</span>run <span class="token punctuation">-</span>o yaml <span class="token punctuation">&gt;</span> ingress.yaml
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># cat ingress2.yaml</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span>  networking.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Ingress
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> ingress<span class="token punctuation">-</span>web
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> web<span class="token punctuation">-</span>test<span class="token punctuation">-</span>ns  
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">rules</span><span class="token punctuation">:</span>					<span class="token comment">#\u521B\u5EFA\u4E00\u4E2A\u89C4\u5219</span>
  <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> test.com			<span class="token comment">#\u6307\u5B9A\u4E3B\u673A\u7684\u57DF\u540D</span>
    <span class="token key atrule">http</span><span class="token punctuation">:</span>					
      <span class="token key atrule">paths</span><span class="token punctuation">:</span>				<span class="token comment">#\u5C06\u8BF7\u6C42\u6620\u5C04\u5230\u540E\u7AEF\u7684\u8DEF\u5F84\u96C6\u5408</span>
      <span class="token punctuation">-</span> <span class="token key atrule">path</span><span class="token punctuation">:</span> /  
        <span class="token key atrule">pathType</span><span class="token punctuation">:</span> Prefix
        <span class="token key atrule">backend</span><span class="token punctuation">:</span>
          <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx		<span class="token comment">#service\u7684\u540D\u79F0</span>
          <span class="token key atrule">port</span><span class="token punctuation">:</span> 
            <span class="token key atrule">number</span><span class="token punctuation">:</span> <span class="token number">80</span>      <span class="token comment">#service\u7684\u7AEF\u53E3</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>\u521B\u5EFAingress\u67E5\u770Bingress\u7684\u72B6\u6001</strong></li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f  ingress2.yaml</span>
Warning: extensions/v1beta1 Ingress is deprecated <span class="token keyword">in</span> v1.14+, unavailable <span class="token keyword">in</span> v1.22+<span class="token punctuation">;</span> use networking.k8s.io/v1 Ingress
ingress.extensions/ingress-web configured

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get ingress -n web-test-ns</span>
NAME          CLASS    HOSTS      ADDRESS   PORTS   AGE
ingress-web   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>   test.com             <span class="token number">80</span>      28m
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>Ingress control\u7684\u5165\u53E3\u5730\u5740\u662F\u4EC0\u4E48\uFF1F\u600E\u4E48\u8BBF\u95EE\u5462\uFF1F</strong></li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get pods -A  -o wide   </span>
NAMESPACE       NAME                                       READY   STATUS    RESTARTS   AGE     IP              NODE     NOMINATED NODE   READINESS GATES
ingress-nginx   nginx-ingress-controller-26w7m             <span class="token number">1</span>/1     Running   <span class="token number">0</span>          3h25m   <span class="token number">192.168</span>.1.121   node2    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
ingress-nginx   nginx-ingress-controller-9bm8d             <span class="token number">1</span>/1     Running   <span class="token number">0</span>          3h25m   <span class="token number">192.168</span>.1.120   node1    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
\xB7\xB7\xB7
web-test-ns     nginx-7848d4b86f-v27pj                     <span class="token number">1</span>/1     Running   <span class="token number">0</span>          39m     <span class="token number">10.244</span>.104.2    node2    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>

<span class="token comment">#192.168.1.121\u5C31\u662F\u8BBF\u95EE\u5730\u5740</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>\u5728\u672C\u5730\u7684hosts\u914D\u7F6E\u6620\u5C04</strong></li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>C:<span class="token punctuation">\\</span>Windows<span class="token punctuation">\\</span>System32<span class="token punctuation">\\</span>drivers<span class="token punctuation">\\</span>etc

<span class="token number">192.168</span>.1.121 test.com


C:<span class="token punctuation">\\</span>Users<span class="token punctuation">\\</span>zyh<span class="token operator">&gt;</span>ping test.com

\u6B63\u5728 Ping test.com <span class="token punctuation">[</span><span class="token number">192.168</span>.1.121<span class="token punctuation">]</span> \u5177\u6709 <span class="token number">32</span> \u5B57\u8282\u7684\u6570\u636E:
\u6765\u81EA <span class="token number">192.168</span>.1.121 \u7684\u56DE\u590D: \u5B57\u8282<span class="token operator">=</span><span class="token number">32</span> \u65F6\u95F4<span class="token operator">&lt;</span>1ms <span class="token assign-left variable">TTL</span><span class="token operator">=</span><span class="token number">64</span>
\u6765\u81EA <span class="token number">192.168</span>.1.121 \u7684\u56DE\u590D: \u5B57\u8282<span class="token operator">=</span><span class="token number">32</span> \u65F6\u95F4<span class="token operator">&lt;</span>1ms <span class="token assign-left variable">TTL</span><span class="token operator">=</span><span class="token number">64</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><strong>\u7136\u540E\u53EF\u4EE5\u5728\u7F51\u7AD9\u4E0A\u7528\u57DF\u540D\u8BBF\u95EE\uFF0C\u53EF\u4EE5\u8BBF\u95EE\u5230\uFF0C\u7136\u540E\u67E5\u770B\u4E24\u4E2Anode\u8282\u70B9\u7684\u7AEF\u53E3\u5F00\u653E</strong></p></li><li><p><strong>masetr\u8282\u70B9\u7684\u7AEF\u53E3\u5E76\u6CA1\u53D1\u73B0\u670980\u548C443\u7AEF\u53E3</strong></p></li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># ss -anpt | grep 80</span>
LISTEN     <span class="token number">0</span>      <span class="token number">128</span>    <span class="token number">192.168</span>.1.104:2380                     *:*                   users:<span class="token variable"><span class="token punctuation">((</span>&quot;etcd&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">10511</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">))</span></span>
ESTAB      <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">127.0</span>.0.1:2379               <span class="token number">127.0</span>.0.1:47360               users:<span class="token variable"><span class="token punctuation">((</span>&quot;etcd&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">10511</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">))</span></span>
ESTAB      <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">127.0</span>.0.1:2379               <span class="token number">127.0</span>.0.1:47280               users:<span class="token variable"><span class="token punctuation">((</span>&quot;etcd&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">10511</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">))</span></span>
TIME-WAIT  <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">192.168</span>.1.104:46336              <span class="token number">10.244</span>.219.69:8080
ESTAB      <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">127.0</span>.0.1:47280              <span class="token number">127.0</span>.0.1:2379                users:<span class="token variable"><span class="token punctuation">((</span>&quot;kube<span class="token operator">-</span>apiserver&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">10492</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">34</span><span class="token punctuation">))</span></span>
TIME-WAIT  <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">192.168</span>.1.104:46254              <span class="token number">10.244</span>.219.69:8080
ESTAB      <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">127.0</span>.0.1:47376              <span class="token number">127.0</span>.0.1:2379                users:<span class="token variable"><span class="token punctuation">((</span>&quot;kube<span class="token operator">-</span>apiserver&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">10492</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">))</span></span>
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># ss -anpt | grep 443</span>
ESTAB      <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">192.168</span>.1.104:49890              <span class="token number">192.168</span>.1.104:6443                users:<span class="token variable"><span class="token punctuation">((</span>&quot;kubelet&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">906</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">45</span><span class="token punctuation">))</span></span>
ESTAB      <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">10.96</span>.0.1:33866              <span class="token number">10.96</span>.0.1:443                 users:<span class="token variable"><span class="token punctuation">((</span>&quot;calico<span class="token operator">-</span>node&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">13259</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">))</span></span>
ESTAB      <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">192.168</span>.1.104:50300              <span class="token number">192.168</span>.1.104:6443                users:<span class="token variable"><span class="token punctuation">((</span>&quot;kube<span class="token operator">-</span>controller&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">10462</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">))</span></span>
ESTAB      <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">192.168</span>.1.104:50150              <span class="token number">192.168</span>.1.104:6443                users:<span class="token variable"><span class="token punctuation">((</span>&quot;kube<span class="token operator">-</span>proxy&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">12370</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">))</span></span>
ESTAB      <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">10.96</span>.0.1:33860              <span class="token number">10.96</span>.0.1:443                 users:<span class="token variable"><span class="token punctuation">((</span>&quot;calico<span class="token operator">-</span>node&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">13257</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">))</span></span>
ESTAB      <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">192.168</span>.1.104:49906              <span class="token number">192.168</span>.1.104:6443                users:<span class="token variable"><span class="token punctuation">((</span>&quot;kube<span class="token operator">-</span>controller&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">10462</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">))</span></span>
ESTAB      <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">192.168</span>.1.104:50118              <span class="token number">192.168</span>.1.104:6443                users:<span class="token variable"><span class="token punctuation">((</span>&quot;kube<span class="token operator">-</span>scheduler&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">10479</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">))</span></span>
ESTAB      <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">10.96</span>.0.1:33864              <span class="token number">10.96</span>.0.1:443                 users:<span class="token variable"><span class="token punctuation">((</span>&quot;calico<span class="token operator">-</span>node&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">13261</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">))</span></span>
ESTAB      <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">192.168</span>.1.104:49888              <span class="token number">192.168</span>.1.104:6443                users:<span class="token variable"><span class="token punctuation">((</span>&quot;kube<span class="token operator">-</span>scheduler&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">10479</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">))</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><strong><code>\u6B64\u65F6\u67E5\u770B\u4E24\u4E2Anode\u8282\u70B9\u53D1\u73B080\u7AEF\u53E3\u548C443\u7AEF\u53E3\u5F00\u653E</code></strong></p></li><li><p><strong>\u8BF4\u660E\u8D1F\u8F7D\u7684\u4F5C\u7528\u6210\u529F\u4E86\uFF0Cingress\u6B63\u5E38</strong></p></li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@node1 ~<span class="token punctuation">]</span><span class="token comment"># ss -anpt  | grep 80</span>
LISTEN     <span class="token number">0</span>      <span class="token number">128</span>          *:80                       *:*                   users:<span class="token variable"><span class="token punctuation">((</span>&quot;nginx&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">20388</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>&quot;nginx&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">13765</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">33</span><span class="token punctuation">))</span></span>
LISTEN     <span class="token number">0</span>      <span class="token number">128</span>          *:80                       *:*                   users:<span class="token variable"><span class="token punctuation">((</span>&quot;nginx&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">20388</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>&quot;nginx&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">13764</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">))</span></span>
LISTEN     <span class="token number">0</span>      <span class="token number">128</span>          *:80                       *:*                   users:<span class="token variable"><span class="token punctuation">((</span>&quot;nginx&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">20388</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>&quot;nginx&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">13763</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">31</span><span class="token punctuation">))</span></span>
LISTEN     <span class="token number">0</span>      <span class="token number">128</span>          *:80                       *:*                   users:<span class="token variable"><span class="token punctuation">((</span>&quot;nginx&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">20388</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>&quot;nginx&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">13762</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">23</span><span class="token punctuation">))</span></span>
TIME-WAIT  <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">127.0</span>.0.1:36780              <span class="token number">127.0</span>.0.1:9099
TIME-WAIT  <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">127.0</span>.0.1:36804              <span class="token number">127.0</span>.0.1:9099
TIME-WAIT  <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">127.0</span>.0.1:36800              <span class="token number">127.0</span>.0.1:9099

<span class="token punctuation">[</span>root@node1 ~<span class="token punctuation">]</span><span class="token comment"># ss -anpt  | grep  443</span>
LISTEN     <span class="token number">0</span>      <span class="token number">128</span>          *:443                      *:*                   users:<span class="token variable"><span class="token punctuation">((</span>&quot;nginx&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">20388</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">39</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>&quot;nginx&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">13765</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">39</span><span class="token punctuation">))</span></span>
LISTEN     <span class="token number">0</span>      <span class="token number">128</span>          *:443                      *:*                   users:<span class="token variable"><span class="token punctuation">((</span>&quot;nginx&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">20388</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">38</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>&quot;nginx&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">13764</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">38</span><span class="token punctuation">))</span></span>
LISTEN     <span class="token number">0</span>      <span class="token number">128</span>          *:443                      *:*                   users:<span class="token variable"><span class="token punctuation">((</span>&quot;nginx&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">20388</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">37</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>&quot;nginx&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">13763</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">37</span><span class="token punctuation">))</span></span>
LISTEN     <span class="token number">0</span>      <span class="token number">128</span>          *:443                      *:*                   users:<span class="token variable"><span class="token punctuation">((</span>&quot;nginx&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">20388</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>&quot;nginx&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">13762</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">))</span></span>
ESTAB      <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">10.96</span>.0.1:54834              <span class="token number">10.96</span>.0.1:443                 users:<span class="token variable"><span class="token punctuation">((</span>&quot;calico<span class="token operator">-</span>node&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">14921</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">))</span></span>
ESTAB      <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">10.96</span>.0.1:54928              <span class="token number">10.96</span>.0.1:443                 users:<span class="token variable"><span class="token punctuation">((</span>&quot;nginx<span class="token operator">-</span>ingress<span class="token operator">-</span>c&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">20287</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">))</span></span>
ESTAB      <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">192.168</span>.1.120:44100              <span class="token number">192.168</span>.1.104:6443                users:<span class="token variable"><span class="token punctuation">((</span>&quot;kubelet&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">13313</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">))</span></span>
ESTAB      <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">10.96</span>.0.1:54820              <span class="token number">10.96</span>.0.1:443                 users:<span class="token variable"><span class="token punctuation">((</span>&quot;calico<span class="token operator">-</span>node&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">14916</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">))</span></span>
ESTAB      <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">10.96</span>.0.1:54822              <span class="token number">10.96</span>.0.1:443                 users:<span class="token variable"><span class="token punctuation">((</span>&quot;calico<span class="token operator">-</span>node&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">14918</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">))</span></span>
ESTAB      <span class="token number">0</span>      <span class="token number">0</span>      <span class="token number">192.168</span>.1.120:44166              <span class="token number">192.168</span>.1.104:6443                users:<span class="token variable"><span class="token punctuation">((</span>&quot;kube<span class="token operator">-</span>proxy&quot;<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">8637</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">))</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ingress\u914D\u7F6Ehttps\u7684\u52A0\u5BC6\u8BA4\u8BC1" tabindex="-1"><a class="header-anchor" href="#ingress\u914D\u7F6Ehttps\u7684\u52A0\u5BC6\u8BA4\u8BC1" aria-hidden="true">#</a> Ingress\u914D\u7F6Ehttps\u7684\u52A0\u5BC6\u8BA4\u8BC1</h3><blockquote><p><strong>Ingress | Https</strong></p></blockquote><ul><li><p><strong>\u914D\u7F6EHTTPS\u6B65\u9AA4\uFF1A</strong></p></li><li><p><strong>\u51C6\u5907\u57DF\u540D\u8BC1\u4E66\u6587\u4EF6\uFF08\u6765\u81EA\uFF1Aopenssl/cfssl\u5DE5\u5177\u81EA\u7B7E\u6216\u8005\u6743\u5A01\u673A\u6784\u9881\u53D1\uFF09</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># tar -zxvf cfssl.tar.gz  -C /usr/local/bin/</span>
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># chmod +x certs.sh </span>
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># ./certs.sh</span>
<span class="token number">2021</span>/11/04 <span class="token number">11</span>:21:17 <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> generating a new CA key and certificate from CSR
<span class="token number">2021</span>/11/04 <span class="token number">11</span>:21:17 <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> generate received request
<span class="token number">2021</span>/11/04 <span class="token number">11</span>:21:17 <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> received CSR
<span class="token number">2021</span>/11/04 <span class="token number">11</span>:21:17 <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> generating key: rsa-2048
<span class="token number">2021</span>/11/04 <span class="token number">11</span>:21:18 <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> encoded CSR
<span class="token number">2021</span>/11/04 <span class="token number">11</span>:21:18 <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> signed certificate with serial number <span class="token number">122465585755296665714458411579230792812069987507</span>
<span class="token number">2021</span>/11/04 <span class="token number">11</span>:21:18 <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> generate received request
<span class="token number">2021</span>/11/04 <span class="token number">11</span>:21:18 <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> received CSR
<span class="token number">2021</span>/11/04 <span class="token number">11</span>:21:18 <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> generating key: rsa-2048
<span class="token number">2021</span>/11/04 <span class="token number">11</span>:21:18 <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> encoded CSR
<span class="token number">2021</span>/11/04 <span class="token number">11</span>:21:18 <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> signed certificate with serial number <span class="token number">552651333045426922300417138573432468469848830218</span>
<span class="token number">2021</span>/11/04 <span class="token number">11</span>:21:18 <span class="token punctuation">[</span>WARNING<span class="token punctuation">]</span> This certificate lacks a <span class="token string">&quot;hosts&quot;</span> field. This makes it unsuitable <span class="token keyword">for</span>
websites. For <span class="token function">more</span> information see the Baseline Requirements <span class="token keyword">for</span> the Issuance and Management
of Publicly-Trusted Certificates, v.1.1.6, from the CA/Browser Forum <span class="token punctuation">(</span>https://cabforum.org<span class="token punctuation">)</span><span class="token punctuation">;</span>
specifically, section <span class="token number">10.2</span>.3 <span class="token punctuation">(</span><span class="token string">&quot;Information Requirements&quot;</span><span class="token punctuation">)</span>.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>\u5C06\u8BC1\u4E66\u6587\u4EF6\u4FDD\u5B58\u5230Secret kubectl create secret tls web-aliangedu-cn -- cert=web.aliangedu.cn.pem --key=web.aliangedu.cn-key.pem</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl create secret tls web-aliangedu-cn --cert=web.aliangedu.cn.pem --key=web.aliangedu.cn-key.pem</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p><strong>Ingress\u89C4\u5219\u914D\u7F6Etls</strong></p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># cat ingress.yaml</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> networking.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Ingress
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> aliangedu<span class="token punctuation">-</span>https
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> web<span class="token punctuation">-</span>test<span class="token punctuation">-</span>ns
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">tls</span><span class="token punctuation">:</span>							<span class="token comment">#TLS\u914D\u7F6E</span>
  <span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span>						<span class="token comment">#tls\u91CC\u5305\u542B\u7684\u4E3B\u673A\u5217\u8868</span>
    <span class="token punctuation">-</span> web.aliangedu.cn
    <span class="token key atrule">secretName</span><span class="token punctuation">:</span> web<span class="token punctuation">-</span>aliangedu<span class="token punctuation">-</span>cn	<span class="token comment">#TLS\u901A\u4FE1\u7684\u5BC6\u7801\u7684\u540D\u79F0</span>
  <span class="token key atrule">rules</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> web.aliangedu.cn
    <span class="token key atrule">http</span><span class="token punctuation">:</span>
      <span class="token key atrule">paths</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">path</span><span class="token punctuation">:</span> /
        <span class="token key atrule">pathType</span><span class="token punctuation">:</span> Prefix
        <span class="token key atrule">backend</span><span class="token punctuation">:</span>
          <span class="token key atrule">service</span><span class="token punctuation">:</span>
            <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
            <span class="token key atrule">port</span><span class="token punctuation">:</span>
              <span class="token key atrule">number</span><span class="token punctuation">:</span> <span class="token number">80</span>
              
<span class="token punctuation">[</span>root@master work<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f ingress.yaml</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>\u67E5\u770Bingress\uFF0C\u914D\u7F6E\u672C\u673A\u7684\u57DF\u540D\u6620\u5C04\u5C31\u53EF\u4EE5\u8BBF\u95EE</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master work<span class="token punctuation">]</span><span class="token comment"># kubectl get pods -A -o wide</span>
NAMESPACE       NAME                                       READY   STATUS    RESTARTS   AGE   IP               NODE     NOMINATED NODE   READINESS GATES
default         web-5b87848979-l6zjz                       <span class="token number">1</span>/1     Running   <span class="token number">0</span>          9h    <span class="token number">10.244</span>.104.10    node2    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
ingress-nginx   nginx-ingress-controller-26w7m             <span class="token number">1</span>/1     Running   <span class="token number">0</span>          17h   <span class="token number">192.168</span>.1.121    node2    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
ingress-nginx   nginx-ingress-controller-9bm8d             <span class="token number">1</span>/1     Running   <span class="token number">0</span>          17h   <span class="token number">192.168</span>.1.120    node1    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
\xB7\xB7\xB7
web-test-ns     nginx-6799fc88d8-6ccsk                     <span class="token number">1</span>/1     Running   <span class="token number">0</span>          24m   <span class="token number">10.244</span>.104.11    node2    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>

<span class="token punctuation">[</span>root@master work<span class="token punctuation">]</span><span class="token comment"># kubectl get ingress -n web-test-ns</span>
NAME              CLASS    HOSTS              ADDRESS   PORTS     AGE
aliangedu-https   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>   web.aliangedu.cn             <span class="token number">80</span>, <span class="token number">443</span>   24m
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul>`,19);function T(I,S){const a=c("ExternalLinkIcon");return o(),l("div",null,[r,n("ul",null,[n("li",null,[n("p",null,[n("strong",null,[s("Ingress \u4E0D\u4F1A\u516C\u5F00\u4EFB\u610F\u7AEF\u53E3\u6216\u534F\u8BAE\u3002 \u5C06 HTTP \u548C HTTPS \u4EE5\u5916\u7684\u670D\u52A1\u516C\u5F00\u5230 Internet \u65F6\uFF0C\u901A\u5E38\u4F7F\u7528 "),n("a",u,[s("Service.Type=NodePort"),e(a)]),s(" \u6216 "),n("a",k,[s("Service.Type=LoadBalancer"),e(a)]),s(" \u7C7B\u578B\u7684\u670D\u52A1\u3002")])])]),d,n("li",null,[n("p",null,[s("\u9879\u76EE\u5730\u5740\uFF1A"),n("a",m,[s("https://github.com/kubernetes/ingress-nginx"),e(a)])])])]),b,v,g,n("ul",null,[n("li",null,[n("p",null,[s("\u4F60\u5FC5\u987B\u5177\u6709 "),n("a",h,[s("Ingress \u63A7\u5236\u5668"),e(a)]),s(" \u624D\u80FD\u6EE1\u8DB3 Ingress \u7684\u8981\u6C42\u3002 \u4EC5\u521B\u5EFA Ingress \u8D44\u6E90\u672C\u8EAB\u6CA1\u6709\u4EFB\u4F55\u6548\u679C\u3002")])]),n("li",null,[n("p",null,[s("\u4F60\u53EF\u80FD\u9700\u8981\u90E8\u7F72 Ingress \u63A7\u5236\u5668\uFF0C\u4F8B\u5982 "),n("a",y,[s("ingress-nginx"),e(a)]),s("\u3002 \u4F60\u53EF\u4EE5\u4ECE\u8BB8\u591A "),n("a",f,[s("Ingress \u63A7\u5236\u5668"),e(a)]),s(" \u4E2D\u8FDB\u884C\u9009\u62E9\u3002")])]),x,q]),P])}const w=p(i,[["render",T],["__file","08.Kubernetes\u7F51\u7EDC.html.vue"]]);export{w as default};
