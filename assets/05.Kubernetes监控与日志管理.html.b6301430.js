import{_ as n}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as s,c as a,f as e}from"./app.ca0279c0.js";const t={},i=e(`<h1 id="kubernetes\u76D1\u63A7\u4E0E\u65E5\u5FD7\u7BA1\u7406" tabindex="-1"><a class="header-anchor" href="#kubernetes\u76D1\u63A7\u4E0E\u65E5\u5FD7\u7BA1\u7406" aria-hidden="true">#</a> Kubernetes\u76D1\u63A7\u4E0E\u65E5\u5FD7\u7BA1\u7406</h1><h2 id="\u67E5\u770B\u8D44\u6E90\u96C6\u7FA4\u72B6\u6001" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770B\u8D44\u6E90\u96C6\u7FA4\u72B6\u6001" aria-hidden="true">#</a> \u67E5\u770B\u8D44\u6E90\u96C6\u7FA4\u72B6\u6001</h2><h3 id="\u67E5\u770Bmaster\u7EC4\u4EF6\u72B6\u6001" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770Bmaster\u7EC4\u4EF6\u72B6\u6001" aria-hidden="true">#</a> \u67E5\u770Bmaster\u7EC4\u4EF6\u72B6\u6001</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment">#  kubectl get cs </span>
NAME                 STATUS    MESSAGE             ERROR
controller-manager   Healthy   ok                  
scheduler            Healthy   ok                  
etcd-0               Healthy   <span class="token punctuation">{</span><span class="token string">&quot;health&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">}</span>  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u67E5\u770Bnode\u72B6\u6001" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770Bnode\u72B6\u6001" aria-hidden="true">#</a> \u67E5\u770Bnode\u72B6\u6001</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment">#  kubectl get node</span>
NAME     STATUS   ROLES    AGE   VERSION
master   Ready    master   20h   v1.18.1
<span class="token function">node</span>     Ready    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>   20h   v1.18.1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u67E5\u770Bapiserver\u4EE3\u7406\u7684url" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770Bapiserver\u4EE3\u7406\u7684url" aria-hidden="true">#</a> \u67E5\u770BApiserver\u4EE3\u7406\u7684URL</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl cluster-info </span>
Kubernetes master is running at https://172.25.254.140:6443
KubeDNS is running at https://172.25.254.140:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy

To further debug and diagnose cluster problems, use <span class="token string">&#39;kubectl cluster-info dump&#39;</span><span class="token builtin class-name">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u67E5\u770B\u7FA4\u8BE6\u7EC6\u4FE1\u606F" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770B\u7FA4\u8BE6\u7EC6\u4FE1\u606F" aria-hidden="true">#</a> \u67E5\u770B\u7FA4\u8BE6\u7EC6\u4FE1\u606F</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl describe  &lt;\u8D44\u6E90&gt; &lt;\u540D\u79F0&gt;    </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="\u67E5\u770B\u8D44\u6E90\u4FE1\u606F" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770B\u8D44\u6E90\u4FE1\u606F" aria-hidden="true">#</a> \u67E5\u770B\u8D44\u6E90\u4FE1\u606F</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get pods </span>
NAME                     READY   STATUS              RESTARTS   AGE
pod-1-7cf5dd459b-fjpcb   <span class="token number">0</span>/1     ContainerCreating   <span class="token number">0</span>          5s

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl  get  pod pod-1-7cf5dd459b-fjpcb --watch  &quot;\u67E5\u770B\u521B\u5EFA\u72B6\u6001&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u96C6\u7FA4\u9519\u8BEF\u6392\u67E5" tabindex="-1"><a class="header-anchor" href="#\u96C6\u7FA4\u9519\u8BEF\u6392\u67E5" aria-hidden="true">#</a> \u96C6\u7FA4\u9519\u8BEF\u6392\u67E5</h3><p><strong>\u5F53\u6211\u4EEC\u4F7F\u7528kubectl\u5DE5\u5177\u6267\u884C\u51FA\u73B0\u9519\u8BEF\u7684\u65F6\u5019\uFF1F</strong></p><blockquote><p><strong>kubectl &gt; kube-apiserver &gt; etcd</strong></p></blockquote><p><strong>\u5F53get node\u7684\u65F6\u5019\u6709\u8282\u70B9\u663E\u793ANotReady\u72B6\u6001\uFF0C\u600E\u4E48\u53BB\u6392\u67E5\uFF1F</strong></p><blockquote><p><strong>kubectl &gt; runtime</strong></p></blockquote><h3 id="\u96C6\u7FA4\u4E0D\u5065\u5EB7" tabindex="-1"><a class="header-anchor" href="#\u96C6\u7FA4\u4E0D\u5065\u5EB7" aria-hidden="true">#</a> \u96C6\u7FA4\u4E0D\u5065\u5EB7</h3><p><strong>\u5F53\u6709\u4E00\u4E2A\u8282\u70B9\u51FA\u73B0\u4E0D\u662F\u5065\u5EB7\u7684\u65F6\u5019\u600E\u4E48\u529E\uFF1F</strong></p><blockquote></blockquote><p><strong>\u89E3\u51B3\u65B9\u6CD5\uFF1A</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>cd /etc/kubernetes/manifest
\u7136\u540E\u5C06\u4F60\u7684scheduler\u4EE5\u53CAcontroll manager.yaml\u4E2D\u90FDport=0\u6CE8\u91CA\u6389
containers:
  - command:
    - kube-scheduler
    - --authentication-kubeconfig=/etc/kubernetes/scheduler.conf
    - --authorization-kubeconfig=/etc/kubernetes/scheduler.conf
    - --bind-address=127.0.0.1
    - --kubeconfig=/etc/kubernetes/scheduler.conf
    - --leader-elect=true
#    - --port=0
    image: k8s.gcr.io/kube-sc
    
[root@master ~]# systemctl restart kubelet 
[root@master ~]# kubectl get cs 
Warning: v1 ComponentStatus is deprecated in v1.19+
NAME                 STATUS    MESSAGE                         ERROR
scheduler            Healthy   ok                              
controller-manager   Healthy   ok                              
etcd-0               Healthy   {&quot;health&quot;:&quot;true&quot;,&quot;reason&quot;:&quot;&quot;}   
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><h2 id="\u76D1\u63A7\u96C6\u7FA4\u8D44\u6E90\u5229\u7528\u7387" tabindex="-1"><a class="header-anchor" href="#\u76D1\u63A7\u96C6\u7FA4\u8D44\u6E90\u5229\u7528\u7387" aria-hidden="true">#</a> \u76D1\u63A7\u96C6\u7FA4\u8D44\u6E90\u5229\u7528\u7387</h2></blockquote><img src="https://pic.imgdb.cn/item/61ebeca92ab3f51d91139195.png" style="zoom:50%;"><h2 id="\u76D1\u63A7\u6570\u636E\u805A\u5408\u5668" tabindex="-1"><a class="header-anchor" href="#\u76D1\u63A7\u6570\u636E\u805A\u5408\u5668" aria-hidden="true">#</a> \u76D1\u63A7\u6570\u636E\u805A\u5408\u5668</h2><p>kubectl &gt; apiserver &gt; metrics-server &gt; kubelet(cadviisor)\uFF08https\uFF09</p><h3 id="metrics-server\u90E8\u7F72" tabindex="-1"><a class="header-anchor" href="#metrics-server\u90E8\u7F72" aria-hidden="true">#</a> Metrics Server\u90E8\u7F72\uFF1A</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># wget https://github.com/kubernetes-sigs/metrics-server/releases/download/v0.3.7/components.yaml</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># vim components.yaml</span>
<span class="token punctuation">..</span>.
containers:
- name: metrics-server
image: lizhenliang/metrics-server:v0.3.7 					<span class="token comment">#\u4FEE\u6539\u955C\u50CF</span>
imagePullPolicy: IfNotPresent
args:
- --cert-dir<span class="token operator">=</span>/tmp
- --secure-port<span class="token operator">=</span><span class="token number">4443</span>
- --kubelet-insecure-tls									<span class="token comment">#\u4E0D\u9A8C\u8BC1kubelet\u63D0\u4F9B\u7684https\u8BC1\u4E66</span>
- --kubelet-preferred-address-types<span class="token operator">=</span>InternalIP				<span class="token comment">#\u4F7F\u7528\u8282\u70B9IP\u8FDE\u63A5kubelet</span>
<span class="token punctuation">..</span>.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>\u521B\u5EFAyaml\u6587\u4EF6\u751F\u6548
[root@master ~]# kubectl apply -f components.yaml 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><h3 id="\u5982\u679C\u63D0\u793A\u62A5\u9519" tabindex="-1"><a class="header-anchor" href="#\u5982\u679C\u63D0\u793A\u62A5\u9519" aria-hidden="true">#</a> \u5982\u679C\u63D0\u793A\u62A5\u9519\uFF1A</h3></blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f metrics-server.yaml  </span>
\xB7
error: unable to recognize <span class="token string">&quot;metrics-server.yaml&quot;</span><span class="token builtin class-name">:</span> no matches <span class="token keyword">for</span> kind <span class="token string">&quot;APIService&quot;</span> <span class="token keyword">in</span> version <span class="token string">&quot;apiregistration.k8s.io/v1beta1&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u4FEE\u6539yaml\u6587\u4EF6</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>---
apiVersion: apiregistration.k8s.io/v1  <span class="token comment">#\u53BB\u6389bate</span>
kind: APIService
metadata:
  name: v1beta1.metrics.k8s.io
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u6267\u884Cyaml</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f metrics-server.yaml  </span>
clusterrole.rbac.authorization.k8s.io/system:aggregated-metrics-reader unchanged
clusterrolebinding.rbac.authorization.k8s.io/metrics-server:system:auth-delegator unchanged
rolebinding.rbac.authorization.k8s.io/metrics-server-auth-reader unchanged
apiservice.apiregistration.k8s.io/v1beta1.metrics.k8s.io created
serviceaccount/metrics-server unchanged
deployment.apps/metrics-server unchanged
service/metrics-server unchanged
clusterrole.rbac.authorization.k8s.io/system:metrics-server unchanged
clusterrolebinding.rbac.authorization.k8s.io/system:metrics-server unchanged
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u67E5\u770Bnode\u8D44\u6E90\u6D88\u8017" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770Bnode\u8D44\u6E90\u6D88\u8017" aria-hidden="true">#</a> \u67E5\u770BNode\u8D44\u6E90\u6D88\u8017</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubectl <span class="token function">top</span> <span class="token function">node</span> <span class="token operator">&lt;</span>node name<span class="token operator">&gt;</span>

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl top node </span>
NAME     CPU<span class="token punctuation">(</span>cores<span class="token punctuation">)</span>   CPU%   MEMORY<span class="token punctuation">(</span>bytes<span class="token punctuation">)</span>   MEMORY%   
master   146m         <span class="token number">7</span>%     1853Mi          <span class="token number">15</span>%       
<span class="token function">node</span>     61m          <span class="token number">3</span>%     945Mi           <span class="token number">12</span>%       

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># </span>
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl top node  master </span>
NAME     CPU<span class="token punctuation">(</span>cores<span class="token punctuation">)</span>   CPU%   MEMORY<span class="token punctuation">(</span>bytes<span class="token punctuation">)</span>   MEMORY%   
master   146m         <span class="token number">7</span>%     1853Mi          <span class="token number">15</span>%       
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u67E5\u770Bpod\u8D44\u6E90\u6D88\u8017" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770Bpod\u8D44\u6E90\u6D88\u8017" aria-hidden="true">#</a> \u67E5\u770BPod\u8D44\u6E90\u6D88\u8017</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubectl <span class="token function">top</span> pod <span class="token operator">&lt;</span>pod name<span class="token operator">&gt;</span>

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl top  pod calico-node-9w9tt -n kube-system </span>
NAME                CPU<span class="token punctuation">(</span>cores<span class="token punctuation">)</span>   MEMORY<span class="token punctuation">(</span>bytes<span class="token punctuation">)</span>   
calico-node-9w9tt   20m          113Mi     
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u7BA1\u7406k8s\u5E94\u7528\u65E5\u5FD7" tabindex="-1"><a class="header-anchor" href="#\u7BA1\u7406k8s\u5E94\u7528\u65E5\u5FD7" aria-hidden="true">#</a> \u7BA1\u7406K8s\u5E94\u7528\u65E5\u5FD7</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubectl logs <span class="token operator">&lt;</span>Pod\u540D\u79F0<span class="token operator">&gt;</span>
kubectl logs <span class="token parameter variable">-f</span> <span class="token operator">&lt;</span>Pod\u540D\u79F0<span class="token operator">&gt;</span>
kubectl logs <span class="token parameter variable">-f</span> <span class="token operator">&lt;</span>Pod\u540D\u79F0<span class="token operator">&gt;</span> <span class="token parameter variable">-c</span> <span class="token operator">&lt;</span>\u5BB9\u5668\u540D\u79F0<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>k8s\u67E5\u770B\u6807\u51C6\u8F93\u51FA\u65E5\u5FD7\u6D41\u7A0B</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubectl logs <span class="token operator">&gt;</span> apiserver <span class="token operator">&gt;</span> kubelet <span class="token operator">&gt;</span> docker<span class="token punctuation">(</span>\u63A5\u7BA1\u4E86\u5BB9\u5668\u6807\u51C6\u8F93\u51FA\u65E5\u5FD7\u5E76\u5199\u5230\u4E86/var/lib/docker/containers/<span class="token operator">&lt;</span>container_id<span class="token operator">&gt;</span>/<span class="token operator">&lt;</span>container_id<span class="token operator">&gt;</span>-json<span class="token punctuation">)</span>

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># cd /var/lib/docker/containers/0852da4a53a2ccbeff729fc48d6d3e96915f80e1ffcd0bd65240577d5a88176c</span>
<span class="token punctuation">[</span>root@master 0852da4a53a2ccbeff729fc48d6d3e96915f80e1ffcd0bd65240577d5a88176c<span class="token punctuation">]</span><span class="token comment"># ll</span>
-rw-r----- <span class="token number">1</span> root root  <span class="token number">108</span> Oct <span class="token number">20</span> <span class="token number">14</span>:23 0852da4a53a2ccbeff729fc48d6d3e96915f80e1ffcd0bd65240577d5a88176c-json.log
drwx------ <span class="token number">2</span> root root    <span class="token number">6</span> Oct <span class="token number">20</span> <span class="token number">14</span>:22 checkpoints
-rw------- <span class="token number">1</span> root root <span class="token number">3177</span> Oct <span class="token number">20</span> <span class="token number">14</span>:24 config.v2.json
-rw-r--r-- <span class="token number">1</span> root root <span class="token number">1553</span> Oct <span class="token number">20</span> <span class="token number">14</span>:24 hostconfig.json
-rw-r--r-- <span class="token number">1</span> root root    <span class="token number">7</span> Oct <span class="token number">20</span> <span class="token number">14</span>:22 <span class="token function">hostname</span>
-rw-r--r-- <span class="token number">1</span> root root  <span class="token number">201</span> Oct <span class="token number">20</span> <span class="token number">14</span>:22 hosts
drwx--x--- <span class="token number">3</span> root root   <span class="token number">17</span> Oct <span class="token number">20</span> <span class="token number">14</span>:22 mounts
-rw-r--r-- <span class="token number">1</span> root root  <span class="token number">114</span> Oct <span class="token number">20</span> <span class="token number">14</span>:22 resolv.conf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u8FDB\u5165\u6240\u6709\u5BB9\u5668\u7EC8\u7AEF</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl exec -it web-96d5df5c8-vwwlv -- bash </span>
root@web-96d5df5c8-vwwlv:~<span class="token comment"># cd /var/log/nginx/</span>
root@web-96d5df5c8-vwwlv:/var/log/nginx<span class="token comment"># ls -l </span>
total <span class="token number">0</span>
lrwxrwxrwx <span class="token number">1</span> root root <span class="token number">11</span> Oct <span class="token number">12</span> 02:03 access.log -<span class="token operator">&gt;</span> /dev/stdout
lrwxrwxrwx <span class="token number">1</span> root root <span class="token number">11</span> Oct <span class="token number">12</span> 02:03 error.log -<span class="token operator">&gt;</span> /dev/stderr
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u5BB9\u5668\u4E2D\u5E94\u7528\u65E5\u5FD7\u53EF\u4EE5\u4F7F\u7528emptyDir\u6570\u636E\u5377\u5C06\u65E5\u5FD7\u6587\u4EF6\u6301\u4E45\u5316\u5230\u5BBF\u4E3B\u673A\u4E0A\u3002</strong></p><p><strong>\u5BBF\u4E3B\u673A\u7684\u8DEF\u5F84\uFF1A</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>/var/lib/kubelet/pods/<span class="token operator">&lt;</span>pod-id<span class="token operator">&gt;</span>/volumes/kubernetes.io~empty-dir/logs/access.log 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><h3 id="pod\u521B\u5EFA\u4E00\u4E2A\u8FB9\u8F66\u5BB9\u5668\u8BFB\u53D6\u4E1A\u52A1\u5BB9\u5668\u65E5\u5FD7" tabindex="-1"><a class="header-anchor" href="#pod\u521B\u5EFA\u4E00\u4E2A\u8FB9\u8F66\u5BB9\u5668\u8BFB\u53D6\u4E1A\u52A1\u5BB9\u5668\u65E5\u5FD7" aria-hidden="true">#</a> Pod\u521B\u5EFA\u4E00\u4E2A\u8FB9\u8F66\u5BB9\u5668\u8BFB\u53D6\u4E1A\u52A1\u5BB9\u5668\u65E5\u5FD7</h3></blockquote><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># cat pod.yaml  </span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>pod
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> pod
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> web
    <span class="token key atrule">image</span><span class="token punctuation">:</span> lizhenliang/nginx<span class="token punctuation">-</span>php
    <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> logs
      <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> /usr/local/nginx/logs
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> log
    <span class="token key atrule">image</span><span class="token punctuation">:</span> busybox
    <span class="token key atrule">args</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>/bin/sh<span class="token punctuation">,</span> <span class="token punctuation">-</span>c<span class="token punctuation">,</span> <span class="token string">&#39;tail -f /opt/access.log&#39;</span><span class="token punctuation">]</span>
    <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> logs
      <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> /opt
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> logs
    <span class="token key atrule">emptyDir</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u6267\u884Cyaml\u5E76\u4E14\u68C0\u6D4B</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f pod.yaml </span>
pod/my-pod configured

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl logs my-pod  web </span>
Starting php-fpm  <span class="token keyword">done</span>
nginx: the configuration <span class="token function">file</span> /usr/local/nginx/conf/nginx.conf syntax is ok
nginx: configuration <span class="token function">file</span> /usr/local/nginx/conf/nginx.conf <span class="token builtin class-name">test</span> is successful
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u6536\u96C6k8s\u65E5\u5FD7\u601D\u8DEF" tabindex="-1"><a class="header-anchor" href="#\u6536\u96C6k8s\u65E5\u5FD7\u601D\u8DEF" aria-hidden="true">#</a> \u6536\u96C6K8s\u65E5\u5FD7\u601D\u8DEF</h3><p><strong><code>\u65E5\u5FD7\u5E73\u53F0\u642D\u5EFA\u54EA\u4E2A\u6280\u672F\u7528\u7684\u591A\uFF1F</code></strong></p><ul><li><strong>ELK\uFF1A\u91CD\u91CF\u7EA7 Elasticsearch+Logstash\uFF08\u65E5\u5FD7\u91C7\u96C6\u5668\uFF0C\u4F7F\u7528go\u5199\u4E86filebeat\u66FF\u4EE3\u65E5\u5FD7\u91C7\u96C6\u529F\u80FD\uFF09+Kibana</strong></li><li><strong>Graylog\u3001Loki\uFF1A\u8F7B\u91CF\u7EA7</strong></li><li><strong>\u5B98\u65B9\u63A8\u8350\u7684EFK\u65E5\u5FD7\u7CFB\u7EDF\u662F\u5565\uFF1F Elasticsearch+Flunend\uFF08\u65E5\u5FD7\u91C7\u96C6\u5668\uFF09+Kibana</strong></li></ul><img src="https://pic.imgdb.cn/item/61ebeca92ab3f51d91139199.png" style="zoom:67%;">`,57),l=[i];function o(c,r){return s(),a("div",null,l)}const u=n(t,[["render",o],["__file","05.Kubernetes\u76D1\u63A7\u4E0E\u65E5\u5FD7\u7BA1\u7406.html.vue"]]);export{u as default};
