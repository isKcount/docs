<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.51" />
    <meta name="theme" content="VuePress Theme Hope" />
    <link rel="icon" href="/docs/favicon.ico"><link rel="icon" href="/docs/assets/icon/chrome-mask-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/docs/assets/icon/chrome-mask-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/docs/assets/icon/chrome-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/docs/assets/icon/chrome-192.png" type="image/png" sizes="192x192"><link rel="manifest" href="/docs/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#46bd87"><link rel="apple-touch-icon" href="/docs/assets/icon/apple-icon-152.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="msapplication-TileImage" content="/docs/assets/icon/ms-icon-144.png"><meta name="msapplication-TileColor" content="#ffffff"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"><title>一文搞懂Containerd | 文档</title><meta name="description" content="个人知识库">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/docs/assets/style.737193c6.css">
    <link rel="modulepreload" href="/docs/assets/app.ca0279c0.js"><link rel="modulepreload" href="/docs/assets/07.一文搞懂containerd.html.fe88496f.js"><link rel="modulepreload" href="/docs/assets/_plugin-vue_export-helper.cdc0426e.js"><link rel="modulepreload" href="/docs/assets/07.一文搞懂containerd.html.771b3e53.js"><link rel="prefetch" href="/docs/assets/index.html.8473212f.js"><link rel="prefetch" href="/docs/assets/slides.html.2891796f.js"><link rel="prefetch" href="/docs/assets/disable.html.67dd1591.js"><link rel="prefetch" href="/docs/assets/encrypt.html.f5a75447.js"><link rel="prefetch" href="/docs/assets/markdown.html.6892c1e4.js"><link rel="prefetch" href="/docs/assets/page.html.8749d940.js"><link rel="prefetch" href="/docs/assets/index.html.e8d21891.js"><link rel="prefetch" href="/docs/assets/index.html.567e3006.js"><link rel="prefetch" href="/docs/assets/index.html.3888991b.js"><link rel="prefetch" href="/docs/assets/slides.html.6fa8549b.js"><link rel="prefetch" href="/docs/assets/baz.html.eff7bc1f.js"><link rel="prefetch" href="/docs/assets/index.html.bf470a8e.js"><link rel="prefetch" href="/docs/assets/ray.html.ab4d4d47.js"><link rel="prefetch" href="/docs/assets/index.html.398bdbd5.js"><link rel="prefetch" href="/docs/assets/disable.html.67b6b72d.js"><link rel="prefetch" href="/docs/assets/encrypt.html.14fba031.js"><link rel="prefetch" href="/docs/assets/markdown.html.8674e0c5.js"><link rel="prefetch" href="/docs/assets/page.html.266bf470.js"><link rel="prefetch" href="/docs/assets/index.html.5da7f899.js"><link rel="prefetch" href="/docs/assets/index.html.52d7fb2c.js"><link rel="prefetch" href="/docs/assets/index.html.6c969872.js"><link rel="prefetch" href="/docs/assets/index.html.b71381de.js"><link rel="prefetch" href="/docs/assets/index.html.cdacec6d.js"><link rel="prefetch" href="/docs/assets/index.html.49869ca7.js"><link rel="prefetch" href="/docs/assets/baz.html.fb0944a3.js"><link rel="prefetch" href="/docs/assets/index.html.1ce677c5.js"><link rel="prefetch" href="/docs/assets/ray.html.a251e01e.js"><link rel="prefetch" href="/docs/assets/index.html.120c630c.js"><link rel="prefetch" href="/docs/assets/kaifa.html.60c45165.js"><link rel="prefetch" href="/docs/assets/qukuailian.html.8de96e30.js"><link rel="prefetch" href="/docs/assets/CKA.html.5567b8cc.js"><link rel="prefetch" href="/docs/assets/CKS.html.87c6ef47.js"><link rel="prefetch" href="/docs/assets/index.html.b4d26096.js"><link rel="prefetch" href="/docs/assets/软件设计师.html.5fd855ec.js"><link rel="prefetch" href="/docs/assets/index.html.68da839b.js"><link rel="prefetch" href="/docs/assets/Go开发.html.bf42d178.js"><link rel="prefetch" href="/docs/assets/JavaPDF.html.f8737487.js"><link rel="prefetch" href="/docs/assets/Java开发.html.8628863a.js"><link rel="prefetch" href="/docs/assets/index.html.bbb5b4ac.js"><link rel="prefetch" href="/docs/assets/index.html.a0dc6170.js"><link rel="prefetch" href="/docs/assets/Ajax.html.4f3fb0f7.js"><link rel="prefetch" href="/docs/assets/CSS3.html.ee5d20b2.js"><link rel="prefetch" href="/docs/assets/HTML5.html.e8c40b69.js"><link rel="prefetch" href="/docs/assets/JavaScript DOM.html.bacb240a.js"><link rel="prefetch" href="/docs/assets/JavaScript开篇.html.cdbbd0bb.js"><link rel="prefetch" href="/docs/assets/JavaScript面向对象.html.3062e9bd.js"><link rel="prefetch" href="/docs/assets/JQuery.html.c43215a9.js"><link rel="prefetch" href="/docs/assets/index.html.d640bee3.js"><link rel="prefetch" href="/docs/assets/Vue.html.b256a928.js"><link rel="prefetch" href="/docs/assets/1.Gitlab-CI入门配置.html.a6a68d37.js"><link rel="prefetch" href="/docs/assets/2.Gitlab-Runer连接K8S.html.dace6002.js"><link rel="prefetch" href="/docs/assets/3.GitLab-CI _ Harbor _ Kubernetes.html.8e0614ce.js"><link rel="prefetch" href="/docs/assets/4.Gitea_K8s-Jenkins-master-slave(webhook钩子).html.0bf84552.js"><link rel="prefetch" href="/docs/assets/index.html.9eccf68b.js"><link rel="prefetch" href="/docs/assets/01.Docker基础.html.d1bad972.js"><link rel="prefetch" href="/docs/assets/02.Docker服务安装.html.1caffb35.js"><link rel="prefetch" href="/docs/assets/03.Dockerfile详解.html.9b0ebbbc.js"><link rel="prefetch" href="/docs/assets/04.Docker-compose.html.f1e746e0.js"><link rel="prefetch" href="/docs/assets/05.Docker swarm.html.4facdfb6.js"><link rel="prefetch" href="/docs/assets/06.Apache_PHP_MySQL架构访问PHP服务.html.1c7ad19c.js"><link rel="prefetch" href="/docs/assets/1.常用Git命令清单.html.ed6a343c.js"><link rel="prefetch" href="/docs/assets/10.Git分支-变基.html.b673b46b.js"><link rel="prefetch" href="/docs/assets/11.Git工具-查看修订版本.html.7444bad2.js"><link rel="prefetch" href="/docs/assets/12.Git工具-交互式暂存.html.3e7ff352.js"><link rel="prefetch" href="/docs/assets/13.Git工具-重置揭密.html.03139516.js"><link rel="prefetch" href="/docs/assets/2.Git变基合并.html.29112858.js"><link rel="prefetch" href="/docs/assets/3.Git命令思维导图.html.6745739c.js"><link rel="prefetch" href="/docs/assets/4.Git基础与命令.html.efe500fd.js"><link rel="prefetch" href="/docs/assets/5.Git分支-分支原理.html.9f00e4cd.js"><link rel="prefetch" href="/docs/assets/6.Git分支的新建与合并-分支操作.html.60919e30.js"><link rel="prefetch" href="/docs/assets/7.Git分支管理-查看分支.html.f1e782fe.js"><link rel="prefetch" href="/docs/assets/8.Git分支开发工作流.html.195a49b1.js"><link rel="prefetch" href="/docs/assets/9.Git分支-远程分支.html.0fd9d015.js"><link rel="prefetch" href="/docs/assets/index.html.93398f90.js"><link rel="prefetch" href="/docs/assets/1.Istio概述.html.5c02c272.js"><link rel="prefetch" href="/docs/assets/2.Istio安装.html.0778ccef.js"><link rel="prefetch" href="/docs/assets/3.Istio的深入浅.html.dc29aaa9.js"><link rel="prefetch" href="/docs/assets/4.Istio练习题.html.1f04fd50.js"><link rel="prefetch" href="/docs/assets/index.html.17ef071c.js"><link rel="prefetch" href="/docs/assets/1.深入理解Operator.html.a3c1b0b3.js"><link rel="prefetch" href="/docs/assets/2.RESTclient原理.html.c1a3fabe.js"><link rel="prefetch" href="/docs/assets/3.访问Kubernetes API.html.ba5db241.js"><link rel="prefetch" href="/docs/assets/4.一文搞懂CRD.html.832cc325.js"><link rel="prefetch" href="/docs/assets/index.html.0537e50e.js"><link rel="prefetch" href="/docs/assets/index.html.c47fbb54.js"><link rel="prefetch" href="/docs/assets/01.搭建Fisco的联盟链(WeBase版).html.4eeda8b1.js"><link rel="prefetch" href="/docs/assets/02.FISCO BCOS Air搭建.html.8e3764e3.js"><link rel="prefetch" href="/docs/assets/03.FISCO BCOS Pro搭建.html.a68fa0d4.js"><link rel="prefetch" href="/docs/assets/04.FISCO BCOS Max搭建.html.eef81f9f.js"><link rel="prefetch" href="/docs/assets/index.html.e5d8ac6d.js"><link rel="prefetch" href="/docs/assets/01.Solidity基础.html.14773c23.js"><link rel="prefetch" href="/docs/assets/02.Solidity数据类型.html.90ff2848.js"><link rel="prefetch" href="/docs/assets/03.Solidity关系运算符.html.f5374b1d.js"><link rel="prefetch" href="/docs/assets/04.Solidity数组.html.d3f4e157.js"><link rel="prefetch" href="/docs/assets/05.Solidity条件判断.html.5b9698ac.js"><link rel="prefetch" href="/docs/assets/index.html.bf4e4aec.js"><link rel="prefetch" href="/docs/assets/index.html.338a7930.js"><link rel="prefetch" href="/docs/assets/01.初识Kubernetes.html.7e390b1a.js"><link rel="prefetch" href="/docs/assets/02.Kubernetes部署.html.93d077cf.js"><link rel="prefetch" href="/docs/assets/03.Containerd搭建Kubernets.html.8647ad6e.js"><link rel="prefetch" href="/docs/assets/04.kubernetes基本操作.html.fe795c52.js"><link rel="prefetch" href="/docs/assets/05.Kubernetes监控与日志管理.html.ab340c8d.js"><link rel="prefetch" href="/docs/assets/06.Kubernetes应用程序生命周期管理.html.0781ccab.js"><link rel="prefetch" href="/docs/assets/07.Kubernetes调度.html.bc466f6f.js"><link rel="prefetch" href="/docs/assets/08.Kubernetes网络.html.fd7f4e4e.js"><link rel="prefetch" href="/docs/assets/09.Kubernetes存储.html.b22ffdf1.js"><link rel="prefetch" href="/docs/assets/10.Kubernetes安全.html.85d40a57.js"><link rel="prefetch" href="/docs/assets/11.Kubernetes集群维护.html.2c0fef95.js"><link rel="prefetch" href="/docs/assets/12.Kubernetes集群故障排查.html.284ce0ad.js"><link rel="prefetch" href="/docs/assets/13.Helm.html.e46d8f58.js"><link rel="prefetch" href="/docs/assets/14.高级运维.html.578a23be.js"><link rel="prefetch" href="/docs/assets/15.NFS做K8S后端存储.html.20733821.js"><link rel="prefetch" href="/docs/assets/16.Glusterfs对接K8S.html.42a01891.js"><link rel="prefetch" href="/docs/assets/17.Ceph对接K8S存储(RBD).html.dd45a301.js"><link rel="prefetch" href="/docs/assets/18.Rook构建Ceph云原生存储.html.7e85914d.js"><link rel="prefetch" href="/docs/assets/19.Kubectl多集群配置.html.5ec76913.js"><link rel="prefetch" href="/docs/assets/20.系统守护进程预留计算资源.html.4dcd7b67.js"><link rel="prefetch" href="/docs/assets/21.Helm搭建EFK日志系统.html.0d3ba677.js"><link rel="prefetch" href="/docs/assets/22.Kubernetes的client-Python.html.020fef07.js"><link rel="prefetch" href="/docs/assets/01.集群部署与安全配置.html.322ba17c.js"><link rel="prefetch" href="/docs/assets/02.集群强化.html.c4217891.js"><link rel="prefetch" href="/docs/assets/03.容器运行环境安全加固.html.3ce5f30b.js"><link rel="prefetch" href="/docs/assets/04.最小化微服务漏洞.html.60cf3e99.js"><link rel="prefetch" href="/docs/assets/05.供应链安全.html.74156ff7.js"><link rel="prefetch" href="/docs/assets/06.监控、审计和运行时安全.html.f014d6cb.js"><link rel="prefetch" href="/docs/assets/01.计算机组成与体系结构.html.370a1be8.js"><link rel="prefetch" href="/docs/assets/02.操作系统基本原理.html.4fe3ac38.js"><link rel="prefetch" href="/docs/assets/03.数据库系统.html.e50999b4.js"><link rel="prefetch" href="/docs/assets/04.计算机网络.html.c838cc4a.js"><link rel="prefetch" href="/docs/assets/05.网络信息安全.html.9e7be8eb.js"><link rel="prefetch" href="/docs/assets/06.考试常用公式.html.886dbaf9.js"><link rel="prefetch" href="/docs/assets/10.软件设计师复习大纲.html.b82af843.js"><link rel="prefetch" href="/docs/assets/11.数据结构与算法复习大纲.html.f1e2e266.js"><link rel="prefetch" href="/docs/assets/21.计算机结构思维导图.html.19ddec9f.js"><link rel="prefetch" href="/docs/assets/22.程序设计语言思维导图.html.7d4167fb.js"><link rel="prefetch" href="/docs/assets/23.知识产权思维导图.html.5ae40862.js"><link rel="prefetch" href="/docs/assets/01.Ceph部署.html.3003e904.js"><link rel="prefetch" href="/docs/assets/01.Elasticsearch教程.html.fe1d10c4.js"><link rel="prefetch" href="/docs/assets/02.SpringBoot整合ES.html.61676afe.js"><link rel="prefetch" href="/docs/assets/01.MySQL安装.html.79f20e89.js"><link rel="prefetch" href="/docs/assets/02.MySQL概述.html.301afc7b.js"><link rel="prefetch" href="/docs/assets/03.MySQL的SQL详解.html.fcf5135e.js"><link rel="prefetch" href="/docs/assets/04.MySQL的函数.html.28aba038.js"><link rel="prefetch" href="/docs/assets/05.MySQL的约束.html.043af394.js"><link rel="prefetch" href="/docs/assets/06.MySQL多表查询.html.df92057c.js"><link rel="prefetch" href="/docs/assets/07.MySQL的事务.html.62475b0e.js"><link rel="prefetch" href="/docs/assets/08.MySQL索引.html.317dfa1a.js"><link rel="prefetch" href="/docs/assets/01.Nginx基础.html.fa00903a.js"><link rel="prefetch" href="/docs/assets/02.Nginx反向代理.html.2ddf6cb1.js"><link rel="prefetch" href="/docs/assets/03.Nginx负载均衡.html.99aba11a.js"><link rel="prefetch" href="/docs/assets/04.Nginx动静分离.html.00e2e22b.js"><link rel="prefetch" href="/docs/assets/05.Nginx高可用.html.1db67ed2.js"><link rel="prefetch" href="/docs/assets/01.Redis详解.html.a1a517b4.js"><link rel="prefetch" href="/docs/assets/02.SpringBoot整合Redis.html.60faacff.js"><link rel="prefetch" href="/docs/assets/01.Vue基础.html.b6d7d71d.js"><link rel="prefetch" href="/docs/assets/02.Vue的事件和表单绑定.html.fd755ddf.js"><link rel="prefetch" href="/docs/assets/03.Vue的计算属性和侦听器.html.e22a51a9.js"><link rel="prefetch" href="/docs/assets/04.Webpack打包TS.html.2c7f7de4.js"><link rel="prefetch" href="/docs/assets/05.vue2脚手架组件化开发.html.1d58ecb8.js"><link rel="prefetch" href="/docs/assets/06.Vue3安装Element-plus.html.f60517f3.js"><link rel="prefetch" href="/docs/assets/1.html.4dc29448.js"><link rel="prefetch" href="/docs/assets/2.html.b8715214.js"><link rel="prefetch" href="/docs/assets/3.html.ddd25a21.js"><link rel="prefetch" href="/docs/assets/4.html.0ad26d78.js"><link rel="prefetch" href="/docs/assets/5.html.e98ecab4.js"><link rel="prefetch" href="/docs/assets/6.html.ee938092.js"><link rel="prefetch" href="/docs/assets/7.html.f0a39229.js"><link rel="prefetch" href="/docs/assets/8.html.27df4e94.js"><link rel="prefetch" href="/docs/assets/9.html.af449031.js"><link rel="prefetch" href="/docs/assets/1.html.7e2f26f4.js"><link rel="prefetch" href="/docs/assets/10.html.f8b1c95e.js"><link rel="prefetch" href="/docs/assets/2.html.beae2264.js"><link rel="prefetch" href="/docs/assets/3.html.dabd6c15.js"><link rel="prefetch" href="/docs/assets/4.html.cccf6516.js"><link rel="prefetch" href="/docs/assets/5.html.6ed02ef5.js"><link rel="prefetch" href="/docs/assets/6.html.1524d989.js"><link rel="prefetch" href="/docs/assets/7.html.e067b1c2.js"><link rel="prefetch" href="/docs/assets/8.html.322e7535.js"><link rel="prefetch" href="/docs/assets/9.html.3fbe64b2.js"><link rel="prefetch" href="/docs/assets/10.html.05272cc2.js"><link rel="prefetch" href="/docs/assets/11.html.66027a12.js"><link rel="prefetch" href="/docs/assets/2.html.ababf87a.js"><link rel="prefetch" href="/docs/assets/3.html.93dae1b5.js"><link rel="prefetch" href="/docs/assets/4.html.5c681e8a.js"><link rel="prefetch" href="/docs/assets/5.html.6a938324.js"><link rel="prefetch" href="/docs/assets/6.html.825b8bff.js"><link rel="prefetch" href="/docs/assets/7.html.7fee9bb3.js"><link rel="prefetch" href="/docs/assets/8.html.e37d7f38.js"><link rel="prefetch" href="/docs/assets/9.html.16dd4da7.js"><link rel="prefetch" href="/docs/assets/awk.html.c4b57f20.js"><link rel="prefetch" href="/docs/assets/01.Java环境配置.html.c437e343.js"><link rel="prefetch" href="/docs/assets/02.Java基础概念.html.f3d75539.js"><link rel="prefetch" href="/docs/assets/03.Java运算符.html.ab3bc524.js"><link rel="prefetch" href="/docs/assets/04.Java循环和判断.html.f73c3ead.js"><link rel="prefetch" href="/docs/assets/05.Java循环高级和数组.html.d075a39e.js"><link rel="prefetch" href="/docs/assets/06.Java方法.html.49b0d306.js"><link rel="prefetch" href="/docs/assets/07.Java面向对象.html.96e489c9.js"><link rel="prefetch" href="/docs/assets/08.Java字符串.html.fa08b014.js"><link rel="prefetch" href="/docs/assets/00.Java面对对象进阶.html.5df6b2ef.js"><link rel="prefetch" href="/docs/assets/01.日期和时间.html.6a931c00.js"><link rel="prefetch" href="/docs/assets/02.正则表达式.html.d08c30df.js"><link rel="prefetch" href="/docs/assets/03.集合.html.f963f147.js"><link rel="prefetch" href="/docs/assets/04.Stream流.html.95642ff9.js"><link rel="prefetch" href="/docs/assets/05.异常处理.html.27dbe528.js"><link rel="prefetch" href="/docs/assets/06.日志框架.html.c8737796.js"><link rel="prefetch" href="/docs/assets/07.File类、IO流.html.6d05432b.js"><link rel="prefetch" href="/docs/assets/08.IO流进阶.html.aa1d4a79.js"><link rel="prefetch" href="/docs/assets/09.多线程.html.a743f4a5.js"><link rel="prefetch" href="/docs/assets/10.网络编程.html.5981e8ac.js"><link rel="prefetch" href="/docs/assets/11.单元测试和反射.html.ba16e90e.js"><link rel="prefetch" href="/docs/assets/12.注解和动态代理.html.1ffb92ce.js"><link rel="prefetch" href="/docs/assets/13.XML和设计模式.html.de62738d.js"><link rel="prefetch" href="/docs/assets/01.SpringBoot快速入门.html.6e6720bb.js"><link rel="prefetch" href="/docs/assets/02.SpringBoot配置文件.html.b7415c01.js"><link rel="prefetch" href="/docs/assets/03.整合Junit和Mybatis.html.b7e4a3a5.js"><link rel="prefetch" href="/docs/assets/04.SpringBoot日志.html.d277b9a7.js"><link rel="prefetch" href="/docs/assets/05.SpringBoot常用注解.html.d4d77a5b.js"><link rel="prefetch" href="/docs/assets/06.SpringBoot开发配置.html.99072422.js"><link rel="prefetch" href="/docs/assets/07.SpringBoot数据层方案.html.5057d815.js"><link rel="prefetch" href="/docs/assets/08.SpringBoot整合第三方技术.html.419e1993.js"><link rel="prefetch" href="/docs/assets/01.Spring的IoC和DI.html.b64e631e.js"><link rel="prefetch" href="/docs/assets/02.IoC和DI注解开发.html.df4b3571.js"><link rel="prefetch" href="/docs/assets/03.Spring的MVC入门.html.8d8b4216.js"><link rel="prefetch" href="/docs/assets/04.SpringMVC的请求和响应.html.24f8b4a6.js"><link rel="prefetch" href="/docs/assets/05.Spring整合Jdbc.html.91cd371f.js"><link rel="prefetch" href="/docs/assets/06.SpringMVC项目的常用配置.html.31f04ad3.js"><link rel="prefetch" href="/docs/assets/07.SpringMVC拦截器.html.347c9643.js"><link rel="prefetch" href="/docs/assets/08.Spring的异常处理.html.9deb2a65.js"><link rel="prefetch" href="/docs/assets/09.Spring的AOP.html.a0d716fc.js"><link rel="prefetch" href="/docs/assets/10.Spring的事务管理.html.0fa2dfd1.js"><link rel="prefetch" href="/docs/assets/11.Mybatis入门.html.8ef5d3fa.js"><link rel="prefetch" href="/docs/assets/12.Mybatis多表查询.html.f4efe22a.js"><link rel="prefetch" href="/docs/assets/13.Mybatis注解开发.html.cb796ee2.js"><link rel="prefetch" href="/docs/assets/14.MyBatisPlus.html.934b7932.js"><link rel="prefetch" href="/docs/assets/404.html.a611e975.js"><link rel="prefetch" href="/docs/assets/index.html.a753c66d.js"><link rel="prefetch" href="/docs/assets/slides.html.75c46d79.js"><link rel="prefetch" href="/docs/assets/disable.html.bb8f2744.js"><link rel="prefetch" href="/docs/assets/encrypt.html.434477d8.js"><link rel="prefetch" href="/docs/assets/markdown.html.40bc98a0.js"><link rel="prefetch" href="/docs/assets/page.html.1b4b866e.js"><link rel="prefetch" href="/docs/assets/index.html.1f7fb53e.js"><link rel="prefetch" href="/docs/assets/index.html.55f76e53.js"><link rel="prefetch" href="/docs/assets/index.html.d747cee9.js"><link rel="prefetch" href="/docs/assets/slides.html.24bef075.js"><link rel="prefetch" href="/docs/assets/baz.html.4512d4e3.js"><link rel="prefetch" href="/docs/assets/index.html.4c704a52.js"><link rel="prefetch" href="/docs/assets/ray.html.be23661e.js"><link rel="prefetch" href="/docs/assets/index.html.f41350de.js"><link rel="prefetch" href="/docs/assets/disable.html.625d1aae.js"><link rel="prefetch" href="/docs/assets/encrypt.html.6428a095.js"><link rel="prefetch" href="/docs/assets/markdown.html.0258b243.js"><link rel="prefetch" href="/docs/assets/page.html.19cf4e7f.js"><link rel="prefetch" href="/docs/assets/index.html.6f428cb6.js"><link rel="prefetch" href="/docs/assets/index.html.087ab0b5.js"><link rel="prefetch" href="/docs/assets/index.html.18499161.js"><link rel="prefetch" href="/docs/assets/index.html.30812cf4.js"><link rel="prefetch" href="/docs/assets/index.html.2577a4c8.js"><link rel="prefetch" href="/docs/assets/index.html.2232a9c4.js"><link rel="prefetch" href="/docs/assets/baz.html.442d59a3.js"><link rel="prefetch" href="/docs/assets/index.html.8e303911.js"><link rel="prefetch" href="/docs/assets/ray.html.08c04131.js"><link rel="prefetch" href="/docs/assets/index.html.7d226bad.js"><link rel="prefetch" href="/docs/assets/kaifa.html.5d317d66.js"><link rel="prefetch" href="/docs/assets/qukuailian.html.ad64adea.js"><link rel="prefetch" href="/docs/assets/CKA.html.56961fd2.js"><link rel="prefetch" href="/docs/assets/CKS.html.72ac5667.js"><link rel="prefetch" href="/docs/assets/index.html.6174df04.js"><link rel="prefetch" href="/docs/assets/软件设计师.html.061132f3.js"><link rel="prefetch" href="/docs/assets/index.html.c136315a.js"><link rel="prefetch" href="/docs/assets/Go开发.html.84143e11.js"><link rel="prefetch" href="/docs/assets/JavaPDF.html.cbccdab6.js"><link rel="prefetch" href="/docs/assets/Java开发.html.13ff4c12.js"><link rel="prefetch" href="/docs/assets/index.html.a5138bc6.js"><link rel="prefetch" href="/docs/assets/index.html.a4f69797.js"><link rel="prefetch" href="/docs/assets/Ajax.html.be36fc57.js"><link rel="prefetch" href="/docs/assets/CSS3.html.5645adc5.js"><link rel="prefetch" href="/docs/assets/HTML5.html.a431804d.js"><link rel="prefetch" href="/docs/assets/JavaScript DOM.html.32bf78b6.js"><link rel="prefetch" href="/docs/assets/JavaScript开篇.html.24c1f67d.js"><link rel="prefetch" href="/docs/assets/JavaScript面向对象.html.944f50c2.js"><link rel="prefetch" href="/docs/assets/JQuery.html.88b1a790.js"><link rel="prefetch" href="/docs/assets/index.html.5aed65e0.js"><link rel="prefetch" href="/docs/assets/Vue.html.1c4a7f92.js"><link rel="prefetch" href="/docs/assets/1.Gitlab-CI入门配置.html.10b512d0.js"><link rel="prefetch" href="/docs/assets/2.Gitlab-Runer连接K8S.html.da996606.js"><link rel="prefetch" href="/docs/assets/3.GitLab-CI _ Harbor _ Kubernetes.html.3afdab73.js"><link rel="prefetch" href="/docs/assets/4.Gitea_K8s-Jenkins-master-slave(webhook钩子).html.1c0c6ee5.js"><link rel="prefetch" href="/docs/assets/index.html.cd64c39c.js"><link rel="prefetch" href="/docs/assets/01.Docker基础.html.9325ec49.js"><link rel="prefetch" href="/docs/assets/02.Docker服务安装.html.b8e8696e.js"><link rel="prefetch" href="/docs/assets/03.Dockerfile详解.html.93f73f10.js"><link rel="prefetch" href="/docs/assets/04.Docker-compose.html.489e9787.js"><link rel="prefetch" href="/docs/assets/05.Docker swarm.html.cc6c871b.js"><link rel="prefetch" href="/docs/assets/06.Apache_PHP_MySQL架构访问PHP服务.html.09b97454.js"><link rel="prefetch" href="/docs/assets/1.常用Git命令清单.html.fbabdd2b.js"><link rel="prefetch" href="/docs/assets/10.Git分支-变基.html.36ced610.js"><link rel="prefetch" href="/docs/assets/11.Git工具-查看修订版本.html.fb0e4699.js"><link rel="prefetch" href="/docs/assets/12.Git工具-交互式暂存.html.65681e5e.js"><link rel="prefetch" href="/docs/assets/13.Git工具-重置揭密.html.cbbc9a61.js"><link rel="prefetch" href="/docs/assets/2.Git变基合并.html.9d51f623.js"><link rel="prefetch" href="/docs/assets/3.Git命令思维导图.html.4e07cffc.js"><link rel="prefetch" href="/docs/assets/4.Git基础与命令.html.0fb9c3ad.js"><link rel="prefetch" href="/docs/assets/5.Git分支-分支原理.html.4d5a5c3d.js"><link rel="prefetch" href="/docs/assets/6.Git分支的新建与合并-分支操作.html.5389c1c3.js"><link rel="prefetch" href="/docs/assets/7.Git分支管理-查看分支.html.0fad3c09.js"><link rel="prefetch" href="/docs/assets/8.Git分支开发工作流.html.330684eb.js"><link rel="prefetch" href="/docs/assets/9.Git分支-远程分支.html.96693989.js"><link rel="prefetch" href="/docs/assets/index.html.ecf7077d.js"><link rel="prefetch" href="/docs/assets/1.Istio概述.html.5f2dfbea.js"><link rel="prefetch" href="/docs/assets/2.Istio安装.html.68817be3.js"><link rel="prefetch" href="/docs/assets/3.Istio的深入浅.html.d77f2f53.js"><link rel="prefetch" href="/docs/assets/4.Istio练习题.html.5a2b7b94.js"><link rel="prefetch" href="/docs/assets/index.html.762e496b.js"><link rel="prefetch" href="/docs/assets/1.深入理解Operator.html.0800af2b.js"><link rel="prefetch" href="/docs/assets/2.RESTclient原理.html.e0cdbeb9.js"><link rel="prefetch" href="/docs/assets/3.访问Kubernetes API.html.88d92c38.js"><link rel="prefetch" href="/docs/assets/4.一文搞懂CRD.html.a718d225.js"><link rel="prefetch" href="/docs/assets/index.html.c122ce3f.js"><link rel="prefetch" href="/docs/assets/index.html.0c94044a.js"><link rel="prefetch" href="/docs/assets/01.搭建Fisco的联盟链(WeBase版).html.6786c4f6.js"><link rel="prefetch" href="/docs/assets/02.FISCO BCOS Air搭建.html.1b067dc7.js"><link rel="prefetch" href="/docs/assets/03.FISCO BCOS Pro搭建.html.67fb8aaf.js"><link rel="prefetch" href="/docs/assets/04.FISCO BCOS Max搭建.html.f64d1c4f.js"><link rel="prefetch" href="/docs/assets/index.html.cca0e45f.js"><link rel="prefetch" href="/docs/assets/01.Solidity基础.html.8e4315b0.js"><link rel="prefetch" href="/docs/assets/02.Solidity数据类型.html.cd26001f.js"><link rel="prefetch" href="/docs/assets/03.Solidity关系运算符.html.e35ddf84.js"><link rel="prefetch" href="/docs/assets/04.Solidity数组.html.45a06584.js"><link rel="prefetch" href="/docs/assets/05.Solidity条件判断.html.72e608cb.js"><link rel="prefetch" href="/docs/assets/index.html.14acd37d.js"><link rel="prefetch" href="/docs/assets/index.html.f93bb6f2.js"><link rel="prefetch" href="/docs/assets/01.初识Kubernetes.html.630656bc.js"><link rel="prefetch" href="/docs/assets/02.Kubernetes部署.html.5ed32e89.js"><link rel="prefetch" href="/docs/assets/03.Containerd搭建Kubernets.html.3ff27450.js"><link rel="prefetch" href="/docs/assets/04.kubernetes基本操作.html.4e5f4081.js"><link rel="prefetch" href="/docs/assets/05.Kubernetes监控与日志管理.html.b6301430.js"><link rel="prefetch" href="/docs/assets/06.Kubernetes应用程序生命周期管理.html.8b2d8a7b.js"><link rel="prefetch" href="/docs/assets/07.Kubernetes调度.html.96c17e45.js"><link rel="prefetch" href="/docs/assets/08.Kubernetes网络.html.406acd25.js"><link rel="prefetch" href="/docs/assets/09.Kubernetes存储.html.4aef8c14.js"><link rel="prefetch" href="/docs/assets/10.Kubernetes安全.html.c4104c3a.js"><link rel="prefetch" href="/docs/assets/11.Kubernetes集群维护.html.75ee0781.js"><link rel="prefetch" href="/docs/assets/12.Kubernetes集群故障排查.html.ce56b99d.js"><link rel="prefetch" href="/docs/assets/13.Helm.html.1812ed02.js"><link rel="prefetch" href="/docs/assets/14.高级运维.html.de16428a.js"><link rel="prefetch" href="/docs/assets/15.NFS做K8S后端存储.html.7f1d76aa.js"><link rel="prefetch" href="/docs/assets/16.Glusterfs对接K8S.html.3f7c1431.js"><link rel="prefetch" href="/docs/assets/17.Ceph对接K8S存储(RBD).html.236d50e8.js"><link rel="prefetch" href="/docs/assets/18.Rook构建Ceph云原生存储.html.2f639789.js"><link rel="prefetch" href="/docs/assets/19.Kubectl多集群配置.html.19deeb7f.js"><link rel="prefetch" href="/docs/assets/20.系统守护进程预留计算资源.html.d835e221.js"><link rel="prefetch" href="/docs/assets/21.Helm搭建EFK日志系统.html.db68c03f.js"><link rel="prefetch" href="/docs/assets/22.Kubernetes的client-Python.html.83fc8101.js"><link rel="prefetch" href="/docs/assets/01.集群部署与安全配置.html.13f8a8df.js"><link rel="prefetch" href="/docs/assets/02.集群强化.html.bcc25fc3.js"><link rel="prefetch" href="/docs/assets/03.容器运行环境安全加固.html.20039fa4.js"><link rel="prefetch" href="/docs/assets/04.最小化微服务漏洞.html.8d586d29.js"><link rel="prefetch" href="/docs/assets/05.供应链安全.html.cfd54fba.js"><link rel="prefetch" href="/docs/assets/06.监控、审计和运行时安全.html.b218b618.js"><link rel="prefetch" href="/docs/assets/01.计算机组成与体系结构.html.585e8a71.js"><link rel="prefetch" href="/docs/assets/02.操作系统基本原理.html.6f6c114a.js"><link rel="prefetch" href="/docs/assets/03.数据库系统.html.b49eaaa4.js"><link rel="prefetch" href="/docs/assets/04.计算机网络.html.87cf9a10.js"><link rel="prefetch" href="/docs/assets/05.网络信息安全.html.31de5b98.js"><link rel="prefetch" href="/docs/assets/06.考试常用公式.html.0bb57f18.js"><link rel="prefetch" href="/docs/assets/10.软件设计师复习大纲.html.99b8382b.js"><link rel="prefetch" href="/docs/assets/11.数据结构与算法复习大纲.html.efc4102c.js"><link rel="prefetch" href="/docs/assets/21.计算机结构思维导图.html.a0e188f3.js"><link rel="prefetch" href="/docs/assets/22.程序设计语言思维导图.html.a6361232.js"><link rel="prefetch" href="/docs/assets/23.知识产权思维导图.html.69e73bda.js"><link rel="prefetch" href="/docs/assets/01.Ceph部署.html.6d8e8353.js"><link rel="prefetch" href="/docs/assets/01.Elasticsearch教程.html.0cdd7af1.js"><link rel="prefetch" href="/docs/assets/02.SpringBoot整合ES.html.9b608be8.js"><link rel="prefetch" href="/docs/assets/01.MySQL安装.html.262b64c8.js"><link rel="prefetch" href="/docs/assets/02.MySQL概述.html.285f3e32.js"><link rel="prefetch" href="/docs/assets/03.MySQL的SQL详解.html.b47ee35b.js"><link rel="prefetch" href="/docs/assets/04.MySQL的函数.html.06cb3eb0.js"><link rel="prefetch" href="/docs/assets/05.MySQL的约束.html.7ea5ea0b.js"><link rel="prefetch" href="/docs/assets/06.MySQL多表查询.html.ec8d57c8.js"><link rel="prefetch" href="/docs/assets/07.MySQL的事务.html.d1ec22a1.js"><link rel="prefetch" href="/docs/assets/08.MySQL索引.html.989a1482.js"><link rel="prefetch" href="/docs/assets/01.Nginx基础.html.9d7a6fd0.js"><link rel="prefetch" href="/docs/assets/02.Nginx反向代理.html.48438ee4.js"><link rel="prefetch" href="/docs/assets/03.Nginx负载均衡.html.11d81f87.js"><link rel="prefetch" href="/docs/assets/04.Nginx动静分离.html.4c0159d0.js"><link rel="prefetch" href="/docs/assets/05.Nginx高可用.html.ef7f51ca.js"><link rel="prefetch" href="/docs/assets/01.Redis详解.html.f0e6eb24.js"><link rel="prefetch" href="/docs/assets/02.SpringBoot整合Redis.html.4810d8ec.js"><link rel="prefetch" href="/docs/assets/01.Vue基础.html.ff481b6f.js"><link rel="prefetch" href="/docs/assets/02.Vue的事件和表单绑定.html.a578138c.js"><link rel="prefetch" href="/docs/assets/03.Vue的计算属性和侦听器.html.d2419e5d.js"><link rel="prefetch" href="/docs/assets/04.Webpack打包TS.html.a8e33ad9.js"><link rel="prefetch" href="/docs/assets/05.vue2脚手架组件化开发.html.cc279f24.js"><link rel="prefetch" href="/docs/assets/06.Vue3安装Element-plus.html.e100e69c.js"><link rel="prefetch" href="/docs/assets/1.html.102ab651.js"><link rel="prefetch" href="/docs/assets/2.html.c00ae202.js"><link rel="prefetch" href="/docs/assets/3.html.5f59847f.js"><link rel="prefetch" href="/docs/assets/4.html.1bbd8fff.js"><link rel="prefetch" href="/docs/assets/5.html.e5221603.js"><link rel="prefetch" href="/docs/assets/6.html.31287294.js"><link rel="prefetch" href="/docs/assets/7.html.36100821.js"><link rel="prefetch" href="/docs/assets/8.html.ef0352c2.js"><link rel="prefetch" href="/docs/assets/9.html.daaf4834.js"><link rel="prefetch" href="/docs/assets/1.html.c5f2c8d5.js"><link rel="prefetch" href="/docs/assets/10.html.fcaad621.js"><link rel="prefetch" href="/docs/assets/2.html.7dfde917.js"><link rel="prefetch" href="/docs/assets/3.html.8ddd080c.js"><link rel="prefetch" href="/docs/assets/4.html.f7ec4ddf.js"><link rel="prefetch" href="/docs/assets/5.html.7358cfb7.js"><link rel="prefetch" href="/docs/assets/6.html.536ac081.js"><link rel="prefetch" href="/docs/assets/7.html.74ca6217.js"><link rel="prefetch" href="/docs/assets/8.html.bd753e55.js"><link rel="prefetch" href="/docs/assets/9.html.07244166.js"><link rel="prefetch" href="/docs/assets/10.html.68b054a6.js"><link rel="prefetch" href="/docs/assets/11.html.83b7618e.js"><link rel="prefetch" href="/docs/assets/2.html.78af693a.js"><link rel="prefetch" href="/docs/assets/3.html.8281510c.js"><link rel="prefetch" href="/docs/assets/4.html.ec309ebc.js"><link rel="prefetch" href="/docs/assets/5.html.a8e534cb.js"><link rel="prefetch" href="/docs/assets/6.html.e9fdea2b.js"><link rel="prefetch" href="/docs/assets/7.html.ac95a4e6.js"><link rel="prefetch" href="/docs/assets/8.html.61a54551.js"><link rel="prefetch" href="/docs/assets/9.html.55a19e82.js"><link rel="prefetch" href="/docs/assets/awk.html.d5cb43b0.js"><link rel="prefetch" href="/docs/assets/01.Java环境配置.html.2a0f06bc.js"><link rel="prefetch" href="/docs/assets/02.Java基础概念.html.3a91af0e.js"><link rel="prefetch" href="/docs/assets/03.Java运算符.html.7f0a66aa.js"><link rel="prefetch" href="/docs/assets/04.Java循环和判断.html.b0367dc8.js"><link rel="prefetch" href="/docs/assets/05.Java循环高级和数组.html.7e83555a.js"><link rel="prefetch" href="/docs/assets/06.Java方法.html.ee9c987f.js"><link rel="prefetch" href="/docs/assets/07.Java面向对象.html.f730259d.js"><link rel="prefetch" href="/docs/assets/08.Java字符串.html.f985dc09.js"><link rel="prefetch" href="/docs/assets/00.Java面对对象进阶.html.e21dc5ba.js"><link rel="prefetch" href="/docs/assets/01.日期和时间.html.b20ef7b7.js"><link rel="prefetch" href="/docs/assets/02.正则表达式.html.008360b4.js"><link rel="prefetch" href="/docs/assets/03.集合.html.79199561.js"><link rel="prefetch" href="/docs/assets/04.Stream流.html.83a42680.js"><link rel="prefetch" href="/docs/assets/05.异常处理.html.7f2ec2a6.js"><link rel="prefetch" href="/docs/assets/06.日志框架.html.04d65ec5.js"><link rel="prefetch" href="/docs/assets/07.File类、IO流.html.307c3f88.js"><link rel="prefetch" href="/docs/assets/08.IO流进阶.html.05091a2e.js"><link rel="prefetch" href="/docs/assets/09.多线程.html.94daca19.js"><link rel="prefetch" href="/docs/assets/10.网络编程.html.0c2b4d85.js"><link rel="prefetch" href="/docs/assets/11.单元测试和反射.html.3125e735.js"><link rel="prefetch" href="/docs/assets/12.注解和动态代理.html.49da253b.js"><link rel="prefetch" href="/docs/assets/13.XML和设计模式.html.04865674.js"><link rel="prefetch" href="/docs/assets/01.SpringBoot快速入门.html.d7a1ebe1.js"><link rel="prefetch" href="/docs/assets/02.SpringBoot配置文件.html.d491c7fe.js"><link rel="prefetch" href="/docs/assets/03.整合Junit和Mybatis.html.8d1316d3.js"><link rel="prefetch" href="/docs/assets/04.SpringBoot日志.html.d736b75c.js"><link rel="prefetch" href="/docs/assets/05.SpringBoot常用注解.html.62366a9a.js"><link rel="prefetch" href="/docs/assets/06.SpringBoot开发配置.html.e7f03692.js"><link rel="prefetch" href="/docs/assets/07.SpringBoot数据层方案.html.dacceb7b.js"><link rel="prefetch" href="/docs/assets/08.SpringBoot整合第三方技术.html.703aeb91.js"><link rel="prefetch" href="/docs/assets/01.Spring的IoC和DI.html.3db59ecd.js"><link rel="prefetch" href="/docs/assets/02.IoC和DI注解开发.html.f358bc49.js"><link rel="prefetch" href="/docs/assets/03.Spring的MVC入门.html.3952f0d3.js"><link rel="prefetch" href="/docs/assets/04.SpringMVC的请求和响应.html.73e617d0.js"><link rel="prefetch" href="/docs/assets/05.Spring整合Jdbc.html.53a1d90b.js"><link rel="prefetch" href="/docs/assets/06.SpringMVC项目的常用配置.html.32e80789.js"><link rel="prefetch" href="/docs/assets/07.SpringMVC拦截器.html.a0caa3ce.js"><link rel="prefetch" href="/docs/assets/08.Spring的异常处理.html.475feb47.js"><link rel="prefetch" href="/docs/assets/09.Spring的AOP.html.867f4d9c.js"><link rel="prefetch" href="/docs/assets/10.Spring的事务管理.html.50e3508a.js"><link rel="prefetch" href="/docs/assets/11.Mybatis入门.html.0228d329.js"><link rel="prefetch" href="/docs/assets/12.Mybatis多表查询.html.6d0aa5ad.js"><link rel="prefetch" href="/docs/assets/13.Mybatis注解开发.html.c2591ccb.js"><link rel="prefetch" href="/docs/assets/14.MyBatisPlus.html.11df3aa3.js"><link rel="prefetch" href="/docs/assets/404.html.8311a4d5.js"><link rel="prefetch" href="/docs/assets/waline-meta.8c8f8f9e.js"><link rel="prefetch" href="/docs/assets/auto.264f6c8c.js"><link rel="prefetch" href="/docs/assets/index.cac02f97.js"><link rel="prefetch" href="/docs/assets/flowchart.parse.ee90d7e0.js"><link rel="prefetch" href="/docs/assets/mermaid.esm.min.e3b5d21d.js"><link rel="prefetch" href="/docs/assets/highlight.esm.d982e650.js"><link rel="prefetch" href="/docs/assets/markdown.esm.832a189d.js"><link rel="prefetch" href="/docs/assets/math.esm.a3f84b6f.js"><link rel="prefetch" href="/docs/assets/notes.esm.3c361cb7.js"><link rel="prefetch" href="/docs/assets/reveal.esm.b96f05d8.js"><link rel="prefetch" href="/docs/assets/search.esm.80da4a02.js"><link rel="prefetch" href="/docs/assets/zoom.esm.8514a202.js"><link rel="prefetch" href="/docs/assets/VuePlayground.093ac045.js"><link rel="prefetch" href="/docs/assets/photoswipe.esm.382b1873.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/docs/zh/" class="brand"><img class="logo" src="/docs/logo.svg" alt="文档"><!----><span class="site-name hide-in-pad">文档</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/docs/zh" class="nav-link active" aria-label="isKcount"><span class="icon iconfont icon-home"></span>isKcount<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="分类"><span class="title"><span class="icon iconfont icon-interact"></span>分类</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/docs/zh/isKcount/1/kaifa.html" class="nav-link" aria-label="学习路线规划"><span class="icon iconfont icon-ability"></span>学习路线规划<!----></a></li><li class="dropdown-item"><a href="/docs/zh/isKcount/2/" class="nav-link" aria-label="考证"><span class="icon iconfont icon-relation"></span>考证<!----></a></li><li class="dropdown-item"><a href="/docs/zh/isKcount/3/" class="nav-link" aria-label="运维笔记"><span class="icon iconfont icon-linux"></span>运维笔记<!----></a></li><li class="dropdown-item"><a href="/docs/zh/isKcount/4/" class="nav-link" aria-label="后端开发笔记"><span class="icon iconfont icon-note"></span>后端开发笔记<!----></a></li><li class="dropdown-item"><a href="/docs/zh/isKcount/5/" class="nav-link" aria-label="前端开发笔记"><span class="icon iconfont icon-like"></span>前端开发笔记<!----></a></li><li class="dropdown-item"><a href="/docs/zh/isKcount/6/" class="nav-link" aria-label="中间件服务笔记"><span class="icon iconfont icon-api"></span>中间件服务笔记<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Devops"><span class="title"><span class="icon iconfont icon-select"></span>Devops</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/docs/zh/pip/git/" class="nav-link" aria-label="Git开发手册"><span class="icon iconfont icon-git"></span>Git开发手册<!----></a></li><li class="dropdown-item"><a href="/docs/zh/pip/ci/" class="nav-link" aria-label="CICD"><span class="icon iconfont icon-ci"></span>CICD<!----></a></li><li class="dropdown-item"><a href="/docs/zh/pip/istio/1.Istio%E6%A6%82%E8%BF%B0.html" class="nav-link" aria-label="Istio"><span class="icon iconfont icon-material"></span>Istio<!----></a></li><li class="dropdown-item"><a href="/docs/zh/pip/operator/1.%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Operator.html" class="nav-link" aria-label="Operator"><span class="icon iconfont icon-proxy"></span>Operator<!----></a></li><li class="dropdown-item"><a aria-current="page" href="/docs/zh/pip/docker/07.%E4%B8%80%E6%96%87%E6%90%9E%E6%87%82containerd.html" class="router-link-active router-link-exact-active nav-link active" aria-label="Docker"><span class="icon iconfont icon-bitbucket"></span>Docker<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Web3"><span class="title"><span class="icon iconfont icon-mount"></span>Web3</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/docs/zh/web3/fabric/" class="nav-link" aria-label="Fabric"><span class="icon iconfont icon-safe"></span>Fabric<!----></a></li><li class="dropdown-item"><a href="/docs/zh/web3/fisco/" class="nav-link" aria-label="FISCO"><span class="icon iconfont icon-safari"></span>FISCO<!----></a></li><li class="dropdown-item"><a href="/docs/zh/web3/solidity/01.Solidity%E5%9F%BA%E7%A1%80.html" class="nav-link" aria-label="智能合约"><span class="icon iconfont icon-license"></span>智能合约<!----></a></li><li class="dropdown-item"><a href="/docs/zh/web3/Web3/" class="nav-link" aria-label="Web3.0"><span class="icon iconfont icon-repo"></span>Web3.0<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="https://wallhaven.cc/" rel="noopener noreferrer" target="_blank" aria-label="Wallhaven" class="nav-link"><span class="icon iconfont icon-autumn"></span>Wallhaven<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-right"><!--[--><!----><!--]--><div class="nav-item"><div class="dropdown-wrapper i18n-dropdown"><button class="dropdown-title" type="button" aria-label="选择语言"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon i18n-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="i18n icon" style="width:1rem;height:1rem;vertical-align:middle;"><path d="M379.392 460.8 494.08 575.488l-42.496 102.4L307.2 532.48 138.24 701.44l-71.68-72.704L234.496 460.8l-45.056-45.056c-27.136-27.136-51.2-66.56-66.56-108.544h112.64c7.68 14.336 16.896 27.136 26.112 35.84l45.568 46.08 45.056-45.056C382.976 312.32 409.6 247.808 409.6 204.8H0V102.4h256V0h102.4v102.4h256v102.4H512c0 70.144-37.888 161.28-87.04 210.944L378.88 460.8zM576 870.4 512 1024H409.6l256-614.4H768l256 614.4H921.6l-64-153.6H576zM618.496 768h196.608L716.8 532.48 618.496 768z"></path></svg><!--]--><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/docs/" class="nav-link" aria-label="English"><!---->English<!----></a></li><li class="dropdown-item"><a aria-current="page" href="/docs/zh/pip/docker/07.%E4%B8%80%E6%96%87%E6%90%9E%E6%87%82containerd.html" class="router-link-active router-link-exact-active nav-link active" aria-label="简体中文"><!---->简体中文<!----></a></li></ul></button></div></div><div class="nav-item"><a class="repo-link" href="https://github.com/vuepress-theme-hope/vuepress-theme-hope" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/docs/zh/pip/" class="nav-link sidebar-link sidebar-page" aria-label="Devops生态"><!---->Devops生态<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-github"></span><span class="title">Git手册</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-ci"></span><span class="title">CICD</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-material"></span><span class="title">Istio</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-proxy"></span><span class="title">Operator</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><span class="icon iconfont icon-animation"></span><span class="title">Docker</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a aria-current="page" href="/docs/zh/pip/docker/07.%E4%B8%80%E6%96%87%E6%90%9E%E6%87%82containerd.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="一文搞懂Containerd"><!---->一文搞懂Containerd<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/zh/pip/docker/07.%E4%B8%80%E6%96%87%E6%90%9E%E6%87%82containerd.html#docker" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Docker"><!---->Docker<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/zh/pip/docker/07.%E4%B8%80%E6%96%87%E6%90%9E%E6%87%82containerd.html#cri" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="CRI"><!---->CRI<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/zh/pip/docker/07.%E4%B8%80%E6%96%87%E6%90%9E%E6%87%82containerd.html#containerd" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Containerd"><!---->Containerd<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/zh/pip/docker/07.%E4%B8%80%E6%96%87%E6%90%9E%E6%87%82containerd.html#架构" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="架构"><!---->架构<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/zh/pip/docker/07.%E4%B8%80%E6%96%87%E6%90%9E%E6%87%82containerd.html#安装" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="安装"><!---->安装<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/zh/pip/docker/07.%E4%B8%80%E6%96%87%E6%90%9E%E6%87%82containerd.html#配置" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="配置"><!---->配置<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/zh/pip/docker/07.%E4%B8%80%E6%96%87%E6%90%9E%E6%87%82containerd.html#使用" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="使用"><!---->使用<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a href="/docs/zh/pip/docker/01.Docker%E5%9F%BA%E7%A1%80.html" class="nav-link sidebar-link sidebar-page" aria-label="Docker基础"><!---->Docker基础<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/zh/pip/docker/02.Docker%E6%9C%8D%E5%8A%A1%E5%AE%89%E8%A3%85.html" class="nav-link sidebar-link sidebar-page" aria-label="Docker服务安装"><!---->Docker服务安装<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/zh/pip/docker/03.Dockerfile%E8%AF%A6%E8%A7%A3.html" class="nav-link sidebar-link sidebar-page" aria-label="Dockerfile详解"><!---->Dockerfile详解<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/zh/pip/docker/04.Docker-compose.html" class="nav-link sidebar-link sidebar-page" aria-label="Docker-Compose详解"><!---->Docker-Compose详解<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/zh/pip/docker/05.Docker%20swarm.html" class="nav-link sidebar-link sidebar-page" aria-label="Docker Swarm集群"><!---->Docker Swarm集群<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/zh/pip/docker/06.Apache+PHP+MySQL%E6%9E%B6%E6%9E%84%E8%AE%BF%E9%97%AEPHP%E6%9C%8D%E5%8A%A1.html" class="nav-link sidebar-link sidebar-page" aria-label="Apache+PHP+MySQL"><!---->Apache+PHP+MySQL<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->一文搞懂Containerd</h1><div class="page-info"><span class="author-info" aria-label="作者🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="https://www.github.isicman" target="_blank" rel="noopener noreferrer">isKcount</a></span><span property="author" content="isKcount"></span></span><!----><span class="date-info" aria-label="写作日期📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>2022年4月16日</span><meta property="datePublished" content="2022-04-15T16:13:20.000Z"></span><!----><!----><span class="reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 24 分钟</span><meta property="timeRequired" content="PT24M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">此页内容</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/zh/pip/docker/07.%E4%B8%80%E6%96%87%E6%90%9E%E6%87%82containerd.html#docker" class="router-link-active router-link-exact-active toc-link level2">Docker</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/zh/pip/docker/07.%E4%B8%80%E6%96%87%E6%90%9E%E6%87%82containerd.html#cri" class="router-link-active router-link-exact-active toc-link level2">CRI</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/zh/pip/docker/07.%E4%B8%80%E6%96%87%E6%90%9E%E6%87%82containerd.html#containerd" class="router-link-active router-link-exact-active toc-link level2">Containerd</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/zh/pip/docker/07.%E4%B8%80%E6%96%87%E6%90%9E%E6%87%82containerd.html#架构" class="router-link-active router-link-exact-active toc-link level3">架构</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/zh/pip/docker/07.%E4%B8%80%E6%96%87%E6%90%9E%E6%87%82containerd.html#安装" class="router-link-active router-link-exact-active toc-link level3">安装</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/zh/pip/docker/07.%E4%B8%80%E6%96%87%E6%90%9E%E6%87%82containerd.html#配置" class="router-link-active router-link-exact-active toc-link level3">配置</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/zh/pip/docker/07.%E4%B8%80%E6%96%87%E6%90%9E%E6%87%82containerd.html#使用" class="router-link-active router-link-exact-active toc-link level3">使用</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><p>在学习 Containerd 之前我们有必要对 Docker 的发展历史做一个简单的回顾，因为这里面牵涉到的组件实战是有点多，有很多我们会经常听到，但是不清楚这些组件到底是干什么用的，比如 <code>libcontainer</code>、<code>runc</code>、<code>containerd</code>、<code>CRI</code>、<code>OCI</code> 等等。</p><h2 id="docker" tabindex="-1"><a class="header-anchor" href="#docker" aria-hidden="true">#</a> Docker</h2><p>从 Docker 1.11 版本开始，Docker 容器运行就不是简单通过 Docker Daemon 来启动了，而是通过集成 containerd、runc 等多个组件来完成的。虽然 Docker Daemon 守护进程模块在不停的重构，但是基本功能和定位没有太大的变化，一直都是 CS 架构，守护进程负责和 Docker Client 端交互，并管理 Docker 镜像和容器。现在的架构中组件 containerd 就会负责集群节点上容器的生命周期管理，并向上为 Docker Daemon 提供 gRPC 接口。</p><p><img src="https://bxdc-static.oss-cn-beijing.aliyuncs.com/images/20210809154608.png" alt="docker 架构" loading="lazy">docker 架构</p><p>当我们要创建一个容器的时候，现在 Docker Daemon 并不能直接帮我们创建了，而是请求 <code>containerd</code> 来创建一个容器，containerd 收到请求后，也并不会直接去操作容器，而是创建一个叫做 <code>containerd-shim</code> 的进程，让这个进程去操作容器，我们指定容器进程是需要一个父进程来做状态收集、维持 stdin 等 fd 打开等工作的，假如这个父进程就是 containerd，那如果 containerd 挂掉的话，整个宿主机上所有的容器都得退出了，而引入 <code>containerd-shim</code> 这个垫片就可以来规避这个问题了。</p><p>然后创建容器需要做一些 namespaces 和 cgroups 的配置，以及挂载 root 文件系统等操作，这些操作其实已经有了标准的规范，那就是 OCI（开放容器标准），<code>runc</code> 就是它的一个参考实现（Docker 被逼无耐将 <code>libcontainer</code> 捐献出来改名为 <code>runc</code> 的），这个标准其实就是一个文档，主要规定了容器镜像的结构、以及容器需要接收哪些操作指令，比如 create、start、stop、delete 等这些命令。<code>runc</code> 就可以按照这个 OCI 文档来创建一个符合规范的容器，既然是标准肯定就有其他 OCI 实现，比如 Kata、gVisor 这些容器运行时都是符合 OCI 标准的。</p><p>所以真正启动容器是通过 <code>containerd-shim</code> 去调用 <code>runc</code> 来启动容器的，<code>runc</code> 启动完容器后本身会直接退出，<code>containerd-shim</code> 则会成为容器进程的父进程, 负责收集容器进程的状态, 上报给 containerd, 并在容器中 pid 为 1 的进程退出后接管容器中的子进程进行清理, 确保不会出现僵尸进程。</p><p>而 Docker 将容器操作都迁移到 <code>containerd</code> 中去是因为当前做 Swarm，想要进军 PaaS 市场，做了这个架构切分，让 Docker Daemon 专门去负责上层的封装编排，当然后面的结果我们知道 Swarm 在 Kubernetes 面前是惨败，然后 Docker 公司就把 <code>containerd</code> 项目捐献给了 CNCF 基金会，这个也是现在的 Docker 架构。</p><h2 id="cri" tabindex="-1"><a class="header-anchor" href="#cri" aria-hidden="true">#</a> CRI</h2><p>我们知道 Kubernetes 提供了一个 CRI 的容器运行时接口，那么这个 CRI 到底是什么呢？这个其实也和 Docker 的发展密切相关的。</p><p>在 Kubernetes 早期的时候，当时 Docker 实在是太火了，Kubernetes 当然会先选择支持 Docker，而且是通过硬编码的方式直接调用 Docker API，后面随着 Docker 的不断发展以及 Google 的主导，出现了更多容器运行时，Kubernetes 为了支持更多更精简的容器运行时，Google 就和红帽主导推出了 CRI 标准，用于将 Kubernetes 平台和特定的容器运行时（当然主要是为了干掉 Docker）解耦。</p><p><code>CRI</code>（Container Runtime Interface 容器运行时接口）本质上就是 Kubernetes 定义的一组与容器运行时进行交互的接口，所以只要实现了这套接口的容器运行时都可以对接到 Kubernetes 平台上来。不过 Kubernetes 推出 CRI 这套标准的时候还没有现在的统治地位，所以有一些容器运行时可能不会自身就去实现 CRI 接口，于是就有了 <code>shim（垫片）</code>， 一个 shim 的职责就是作为适配器将各种容器运行时本身的接口适配到 Kubernetes 的 CRI 接口上，其中 <code>dockershim</code> 就是 Kubernetes 对接 Docker 到 CRI 接口上的一个垫片实现。</p><p><img src="https://bxdc-static.oss-cn-beijing.aliyuncs.com/images/20210809172030.png" alt="cri shim" loading="lazy">cri shim</p><p>Kubelet 通过 gRPC 框架与容器运行时或 shim 进行通信，其中 kubelet 作为客户端，CRI shim（也可能是容器运行时本身）作为服务器。</p><p>CRI 定义的 API(<a href="https://github.com/kubernetes/kubernetes/blob/release-1.5/pkg/kubelet/api/v1alpha1/runtime/api.proto" target="_blank" rel="noopener noreferrer">https://github.com/kubernetes/kubernetes/blob/release-1.5/pkg/kubelet/api/v1alpha1/runtime/api.proto<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>) 主要包括两个 gRPC 服务，<code>ImageService</code> 和 <code>RuntimeService</code>，<code>ImageService</code> 服务主要是拉取镜像、查看和删除镜像等操作，<code>RuntimeService</code> 则是用来管理 Pod 和容器的生命周期，以及与容器交互的调用（exec/attach/port-forward）等操作，可以通过 kubelet 中的标志 <code>--container-runtime-endpoint</code> 和 <code>--image-service-endpoint</code> 来配置这两个服务的套接字。</p><p><img src="https://bxdc-static.oss-cn-beijing.aliyuncs.com/images/20210809173134.png" alt="kubelet cri" loading="lazy">kubelet cri</p><p>不过这里同样也有一个例外，那就是 Docker，由于 Docker 当时的江湖地位很高，Kubernetes 是直接内置了 <code>dockershim</code> 在 kubelet 中的，所以如果你使用的是 Docker 这种容器运行时的话是不需要单独去安装配置适配器之类的，当然这个举动似乎也麻痹了 Docker 公司。</p><p><img src="https://bxdc-static.oss-cn-beijing.aliyuncs.com/images/20210809173555.png" alt="dockershim" loading="lazy">dockershim</p><p>现在如果我们使用的是 Docker 的话，当我们在 Kubernetes 中创建一个 Pod 的时候，首先就是 kubelet 通过 CRI 接口调用 <code>dockershim</code>，请求创建一个容器，kubelet 可以视作一个简单的 CRI Client, 而 dockershim 就是接收请求的 Server，不过他们都是在 kubelet 内置的。</p><p><code>dockershim</code> 收到请求后, 转化成 Docker Daemon 能识别的请求, 发到 Docker Daemon 上请求创建一个容器，请求到了 Docker Daemon 后续就是 Docker 创建容器的流程了，去调用 <code>containerd</code>，然后创建 <code>containerd-shim</code> 进程，通过该进程去调用 <code>runc</code> 去真正创建容器。</p><p>其实我们仔细观察也不难发现使用 Docker 的话其实是调用链比较长的，真正容器相关的操作其实 containerd 就完全足够了，Docker 太过于复杂笨重了，当然 Docker 深受欢迎的很大一个原因就是提供了很多对用户操作比较友好的功能，但是对于 Kubernetes 来说压根不需要这些功能，因为都是通过接口去操作容器的，所以自然也就可以将容器运行时切换到 containerd 来。</p><p><img src="https://bxdc-static.oss-cn-beijing.aliyuncs.com/images/20210810094948.png" alt="切换到containerd" loading="lazy">切换到containerd</p><p>切换到 containerd 可以消除掉中间环节，操作体验也和以前一样，但是由于直接用容器运行时调度容器，所以它们对 Docker 来说是不可见的。 因此，你以前用来检查这些容器的 Docker 工具就不能使用了。</p><p>你不能再使用 <code>docker ps</code> 或 <code>docker inspect</code> 命令来获取容器信息。由于不能列出容器，因此也不能获取日志、停止容器，甚至不能通过 <code>docker exec</code> 在容器中执行命令。</p><p>当然我们仍然可以下载镜像，或者用 <code>docker build</code> 命令构建镜像，但用 Docker 构建、下载的镜像，对于容器运行时和 Kubernetes，均不可见。为了在 Kubernetes 中使用，需要把镜像推送到镜像仓库中去。</p><p>从上图可以看出在 containerd 1.0 中，对 CRI 的适配是通过一个单独的 <code>CRI-Containerd</code> 进程来完成的，这是因为最开始 containerd 还会去适配其他的系统（比如 swarm），所以没有直接实现 CRI，所以这个对接工作就交给 <code>CRI-Containerd</code> 这个 shim 了。</p><p>然后到了 containerd 1.1 版本后就去掉了 <code>CRI-Containerd</code> 这个 shim，直接把适配逻辑作为插件的方式集成到了 containerd 主进程中，现在这样的调用就更加简洁了。</p><p><img src="https://bxdc-static.oss-cn-beijing.aliyuncs.com/images/20210810095546.png" alt="containerd cri" loading="lazy">containerd cri</p><p>与此同时 Kubernetes 社区也做了一个专门用于 Kubernetes 的 CRI 运行时 <a href="https://cri-o.io/" target="_blank" rel="noopener noreferrer">CRI-O<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>，直接兼容 CRI 和 OCI 规范。</p><p><img src="https://bxdc-static.oss-cn-beijing.aliyuncs.com/images/20210810100752.png" alt="cri-o" loading="lazy">cri-o</p><p>这个方案和 containerd 的方案显然比默认的 dockershim 简洁很多，不过由于大部分用户都比较习惯使用 Docker，所以大家还是更喜欢使用 <code>dockershim</code> 方案。</p><p>但是随着 CRI 方案的发展，以及其他容器运行时对 CRI 的支持越来越完善，Kubernetes 社区在2020年7月份就开始着手移除 dockershim 方案了：<a href="https://github.com/kubernetes/enhancements/tree/master/keps/sig-node/2221-remove-dockershim%EF%BC%8C%E7%8E%B0%E5%9C%A8%E7%9A%84%E7%A7%BB%E9%99%A4%E8%AE%A1%E5%88%92%E6%98%AF%E5%9C%A8" target="_blank" rel="noopener noreferrer">https://github.com/kubernetes/enhancements/tree/master/keps/sig-node/2221-remove-dockershim，现在的移除计划是在<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 1.20 版本中将 kubelet 中内置的 dockershim 代码分离，将内置的 dockershim 标记为<code>维护模式</code>，当然这个时候仍然还可以使用 dockershim，目标是在 1.23⁄1.24 版本发布没有 dockershim 的版本（代码还在，但是要默认支持开箱即用的 docker 需要自己构建 kubelet，会在某个宽限期过后从 kubelet 中删除内置的 dockershim 代码）。那么这是否就意味这 Kubernetes 不再支持 Docker 了呢？当然不是的，这只是废弃了内置的 <code>dockershim</code> 功能而已，Docker 和其他容器运行时将一视同仁，不会单独对待内置支持，如果我们还想直接使用 Docker 这种容器运行时应该怎么办呢？可以将 dockershim 的功能单独提取出来独立维护一个 <code>cri-dockerd</code> 即可，就类似于 containerd 1.0 版本中提供的 <code>CRI-Containerd</code>，当然还有一种办法就是 Docker 官方社区将 CRI 接口内置到 Dockerd 中去实现。</p><p>但是我们也清楚 Dockerd 也是去直接调用的 Containerd，而 containerd 1.1 版本后就内置实现了 CRI，所以 Docker 也没必要再去单独实现 CRI 了，当 Kubernetes 不再内置支持开箱即用的 Docker 的以后，最好的方式当然也就是直接使用 Containerd 这种容器运行时，而且该容器运行时也已经经过了生产环境实践的，接下来我们就来学习下 Containerd 的使用。</p><h2 id="containerd" tabindex="-1"><a class="header-anchor" href="#containerd" aria-hidden="true">#</a> Containerd</h2><p>我们知道很早之前的 Docker Engine 中就有了 containerd，只不过现在是将 containerd 从 Docker Engine 里分离出来，作为一个独立的开源项目，目标是提供一个更加开放、稳定的容器运行基础设施。分离出来的 containerd 将具有更多的功能，涵盖整个容器运行时管理的所有需求，提供更强大的支持。</p><p>containerd 是一个工业级标准的容器运行时，它强调<strong>简单性</strong>、<strong>健壮性</strong>和<strong>可移植性</strong>，containerd 可以负责干下面这些事情：</p><ul><li>管理容器的生命周期（从创建容器到销毁容器）</li><li>拉取/推送容器镜像</li><li>存储管理（管理镜像及容器数据的存储）</li><li>调用 runc 运行容器（与 runc 等容器运行时交互）</li><li>管理容器网络接口及网络</li></ul><h3 id="架构" tabindex="-1"><a class="header-anchor" href="#架构" aria-hidden="true">#</a> 架构</h3><p>containerd 可用作 Linux 和 Windows 的守护程序，它管理其主机系统完整的容器生命周期，从镜像传输和存储到容器执行和监测，再到底层存储到网络附件等等。</p><p><img src="https://bxdc-static.oss-cn-beijing.aliyuncs.com/images/20210810134700.png" alt="containerd 架构" loading="lazy">containerd 架构</p><p>上图是 containerd 官方提供的架构图，可以看出 containerd 采用的也是 C/S 架构，服务端通过 unix domain socket 暴露低层的 gRPC API 接口出去，客户端通过这些 API 管理节点上的容器，每个 containerd 只负责一台机器，Pull 镜像，对容器的操作（启动、停止等），网络，存储都是由 containerd 完成。具体运行容器由 runc 负责，实际上只要是符合 OCI 规范的容器都可以支持。</p><p>为了解耦，containerd 将系统划分成了不同的组件，每个组件都由一个或多个模块协作完成（Core 部分），每一种类型的模块都以插件的形式集成到 Containerd 中，而且插件之间是相互依赖的，例如，上图中的每一个长虚线的方框都表示一种类型的插件，包括 Service Plugin、Metadata Plugin、GC Plugin、Runtime Plugin 等，其中 Service Plugin 又会依赖 Metadata Plugin、GC Plugin 和 Runtime Plugin。每一个小方框都表示一个细分的插件，例如 Metadata Plugin 依赖 Containers Plugin、Content Plugin 等。比如:</p><ul><li><code>Content Plugin</code>: 提供对镜像中可寻址内容的访问，所有不可变的内容都被存储在这里。</li><li><code>Snapshot Plugin</code>: 用来管理容器镜像的文件系统快照，镜像中的每一层都会被解压成文件系统快照，类似于 Docker 中的 graphdriver。</li></ul><p>总体来看 containerd 可以分为三个大块：Storage、Metadata 和 Runtime。</p><p><img src="https://bxdc-static.oss-cn-beijing.aliyuncs.com/images/20210810145929.png" alt="containerd 架构2" loading="lazy">containerd 架构2</p><h3 id="安装" tabindex="-1"><a class="header-anchor" href="#安装" aria-hidden="true">#</a> 安装</h3><p>这里我使用的系统是 <code>Linux Mint 20.2</code>，首先需要安装 <code>seccomp</code> 依赖：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ <span class="token function">apt-get</span> update
➜  ~ <span class="token function">apt-get</span> <span class="token function">install</span> libseccomp2 <span class="token parameter variable">-y</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>由于 containerd 需要调用 runc，所以我们也需要先安装 runc，不过 containerd 提供了一个包含相关依赖的压缩包 <code>cri-containerd-cni-${VERSION}.${OS}-${ARCH}.tar.gz</code>，可以直接使用这个包来进行安装。首先从 <a href="https://github.com/containerd/containerd/releases" target="_blank" rel="noopener noreferrer">release 页面<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>下载最新版本的压缩包，当前为 1.5.5 版本：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ <span class="token function">wget</span> https://github.com/containerd/containerd/releases/download/v1.5.5/cri-containerd-cni-1.5.5-linux-amd64.tar.gz
<span class="token comment"># 如果有限制，也可以替换成下面的 URL 加速下载</span>
<span class="token comment"># wget https://download.fastgit.org/containerd/containerd/releases/download/v1.5.5/cri-containerd-cni-1.5.5-linux-amd64.tar.gz</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以通过 tar 的 <code>-t</code> 选项直接看到压缩包中包含哪些文件：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ <span class="token function">tar</span> <span class="token parameter variable">-tf</span> cri-containerd-cni-1.4.3-linux-amd64.tar.gz
etc/
etc/cni/
etc/cni/net.d/
etc/cni/net.d/10-containerd-net.conflist
etc/crictl.yaml
etc/systemd/
etc/systemd/system/
etc/systemd/system/containerd.service
usr/
usr/local/
usr/local/bin/
usr/local/bin/containerd-shim-runc-v2
usr/local/bin/ctr
usr/local/bin/containerd-shim
usr/local/bin/containerd-shim-runc-v1
usr/local/bin/crictl
usr/local/bin/critest
usr/local/bin/containerd
usr/local/sbin/
usr/local/sbin/runc
opt/
opt/cni/
opt/cni/bin/
opt/cni/bin/vlan
opt/cni/bin/host-local
opt/cni/bin/flannel
opt/cni/bin/bridge
opt/cni/bin/host-device
opt/cni/bin/tuning
opt/cni/bin/firewall
opt/cni/bin/bandwidth
opt/cni/bin/ipvlan
opt/cni/bin/sbr
opt/cni/bin/dhcp
opt/cni/bin/portmap
opt/cni/bin/ptp
opt/cni/bin/static
opt/cni/bin/macvlan
opt/cni/bin/loopback
opt/containerd/
opt/containerd/cluster/
opt/containerd/cluster/version
opt/containerd/cluster/gce/
opt/containerd/cluster/gce/cni.template
opt/containerd/cluster/gce/configure.sh
opt/containerd/cluster/gce/cloud-init/
opt/containerd/cluster/gce/cloud-init/master.yaml
opt/containerd/cluster/gce/cloud-init/node.yaml
opt/containerd/cluster/gce/env
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>直接将压缩包解压到系统的各个目录中：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ <span class="token function">tar</span> <span class="token parameter variable">-C</span> / <span class="token parameter variable">-xzf</span> cri-containerd-cni-1.5.5-linux-amd64.tar.gz
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>当然要记得将 <code>/usr/local/bin</code> 和 <code>/usr/local/sbin</code> 追加到 <code>~/.bashrc</code> 文件的 <code>PATH</code> 环境变量中：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token environment constant">$PATH</span>:/usr/local/bin:/usr/local/sbin
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>然后执行下面的命令使其立即生效：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ <span class="token builtin class-name">source</span> ~/.bashrc
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>containerd 的默认配置文件为 <code>/etc/containerd/config.toml</code>，我们可以通过如下所示的命令生成一个默认的配置：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ <span class="token function">mkdir</span> /etc/containerd
➜  ~ containerd config default <span class="token operator">&gt;</span> /etc/containerd/config.toml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>由于上面我们下在的 containerd 压缩包中包含一个 <code>etc/systemd/system/containerd.service</code> 的文件，这样我们就可以通过 systemd 来配置 containerd 作为守护进程运行了，内容如下所示：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ <span class="token function">cat</span> /etc/systemd/system/containerd.service
<span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>containerd container runtime
<span class="token assign-left variable">Documentation</span><span class="token operator">=</span>https://containerd.io
<span class="token assign-left variable">After</span><span class="token operator">=</span>network.target local-fs.target

<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token assign-left variable">ExecStartPre</span><span class="token operator">=</span>-/sbin/modprobe overlay
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/usr/local/bin/containerd

<span class="token assign-left variable">Type</span><span class="token operator">=</span>notify
<span class="token assign-left variable">Delegate</span><span class="token operator">=</span>yes
<span class="token assign-left variable">KillMode</span><span class="token operator">=</span>process
<span class="token assign-left variable">Restart</span><span class="token operator">=</span>always
<span class="token assign-left variable">RestartSec</span><span class="token operator">=</span><span class="token number">5</span>
<span class="token comment"># Having non-zero Limit*s causes performance problems due to accounting overhead</span>
<span class="token comment"># in the kernel. We recommend using cgroups to do container-local accounting.</span>
<span class="token assign-left variable">LimitNPROC</span><span class="token operator">=</span>infinity
<span class="token assign-left variable">LimitCORE</span><span class="token operator">=</span>infinity
<span class="token assign-left variable">LimitNOFILE</span><span class="token operator">=</span><span class="token number">1048576</span>
<span class="token comment"># Comment TasksMax if your systemd version does not supports it.</span>
<span class="token comment"># Only systemd 226 and above support this version.</span>
<span class="token assign-left variable">TasksMax</span><span class="token operator">=</span>infinity
<span class="token assign-left variable">OOMScoreAdjust</span><span class="token operator">=</span>-999

<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>
<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这里有两个重要的参数：</p><ul><li><code>Delegate</code>: 这个选项允许 containerd 以及运行时自己管理自己创建容器的 cgroups。如果不设置这个选项，systemd 就会将进程移到自己的 cgroups 中，从而导致 containerd 无法正确获取容器的资源使用情况。</li><li><code>KillMode</code>: 这个选项用来处理 containerd 进程被杀死的方式。默认情况下，systemd 会在进程的 cgroup 中查找并杀死 containerd 的所有子进程。KillMode 字段可以设置的值如下。 <ul><li><code>control-group</code>（默认值）：当前控制组里面的所有子进程，都会被杀掉</li><li><code>process</code>：只杀主进程</li><li><code>mixed</code>：主进程将收到 SIGTERM 信号，子进程收到 SIGKILL 信号</li><li><code>none</code>：没有进程会被杀掉，只是执行服务的 stop 命令</li></ul></li></ul><p>我们需要将 KillMode 的值设置为 process，这样可以确保升级或重启 containerd 时不杀死现有的容器。</p><p>现在我们就可以启动 containerd 了，直接执行下面的命令即可：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ systemctl <span class="token builtin class-name">enable</span> containerd <span class="token parameter variable">--now</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>启动完成后就可以使用 containerd 的本地 CLI 工具 <code>ctr</code> 了，比如查看版本：</p><p><img src="https://bxdc-static.oss-cn-beijing.aliyuncs.com/images/20210810164519.png" alt="ctr version" loading="lazy">ctr version</p><h3 id="配置" tabindex="-1"><a class="header-anchor" href="#配置" aria-hidden="true">#</a> 配置</h3><p>我们首先来查看下上面默认生成的配置文件 <code>/etc/containerd/config.toml</code>：</p><div class="language-toml ext-toml line-numbers-mode"><pre class="language-toml"><code><span class="token key property">disabled_plugins</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token key property">imports</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token key property">oom_score</span> <span class="token punctuation">=</span> <span class="token number">0</span>
<span class="token key property">plugin_dir</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
<span class="token key property">required_plugins</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token key property">root</span> <span class="token punctuation">=</span> <span class="token string">&quot;/var/lib/containerd&quot;</span>
<span class="token key property">state</span> <span class="token punctuation">=</span> <span class="token string">&quot;/run/containerd&quot;</span>
<span class="token key property">version</span> <span class="token punctuation">=</span> <span class="token number">2</span>

<span class="token punctuation">[</span><span class="token table class-name">cgroup</span><span class="token punctuation">]</span>
  <span class="token key property">path</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>

<span class="token punctuation">[</span><span class="token table class-name">debug</span><span class="token punctuation">]</span>
  <span class="token key property">address</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
  <span class="token key property">format</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
  <span class="token key property">gid</span> <span class="token punctuation">=</span> <span class="token number">0</span>
  <span class="token key property">level</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
  <span class="token key property">uid</span> <span class="token punctuation">=</span> <span class="token number">0</span>

<span class="token punctuation">[</span><span class="token table class-name">grpc</span><span class="token punctuation">]</span>
  <span class="token key property">address</span> <span class="token punctuation">=</span> <span class="token string">&quot;/run/containerd/containerd.sock&quot;</span>
  <span class="token key property">gid</span> <span class="token punctuation">=</span> <span class="token number">0</span>
  <span class="token key property">max_recv_message_size</span> <span class="token punctuation">=</span> <span class="token number">16777216</span>
  <span class="token key property">max_send_message_size</span> <span class="token punctuation">=</span> <span class="token number">16777216</span>
  <span class="token key property">tcp_address</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
  <span class="token key property">tcp_tls_cert</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
  <span class="token key property">tcp_tls_key</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
  <span class="token key property">uid</span> <span class="token punctuation">=</span> <span class="token number">0</span>

<span class="token punctuation">[</span><span class="token table class-name">metrics</span><span class="token punctuation">]</span>
  <span class="token key property">address</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
  <span class="token key property">grpc_histogram</span> <span class="token punctuation">=</span> <span class="token boolean">false</span>

<span class="token punctuation">[</span><span class="token table class-name">plugins</span><span class="token punctuation">]</span>

  <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.gc.v1.scheduler&quot;</span><span class="token punctuation">]</span>
    <span class="token key property">deletion_threshold</span> <span class="token punctuation">=</span> <span class="token number">0</span>
    <span class="token key property">mutation_threshold</span> <span class="token punctuation">=</span> <span class="token number">100</span>
    <span class="token key property">pause_threshold</span> <span class="token punctuation">=</span> <span class="token number">0.02</span>
    <span class="token key property">schedule_delay</span> <span class="token punctuation">=</span> <span class="token string">&quot;0s&quot;</span>
    <span class="token key property">startup_delay</span> <span class="token punctuation">=</span> <span class="token string">&quot;100ms&quot;</span>

  <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.grpc.v1.cri&quot;</span><span class="token punctuation">]</span>
    <span class="token key property">disable_apparmor</span> <span class="token punctuation">=</span> <span class="token boolean">false</span>
    <span class="token key property">disable_cgroup</span> <span class="token punctuation">=</span> <span class="token boolean">false</span>
    <span class="token key property">disable_hugetlb_controller</span> <span class="token punctuation">=</span> <span class="token boolean">true</span>
    <span class="token key property">disable_proc_mount</span> <span class="token punctuation">=</span> <span class="token boolean">false</span>
    <span class="token key property">disable_tcp_service</span> <span class="token punctuation">=</span> <span class="token boolean">true</span>
    <span class="token key property">enable_selinux</span> <span class="token punctuation">=</span> <span class="token boolean">false</span>
    <span class="token key property">enable_tls_streaming</span> <span class="token punctuation">=</span> <span class="token boolean">false</span>
    <span class="token key property">ignore_image_defined_volumes</span> <span class="token punctuation">=</span> <span class="token boolean">false</span>
    <span class="token key property">max_concurrent_downloads</span> <span class="token punctuation">=</span> <span class="token number">3</span>
    <span class="token key property">max_container_log_line_size</span> <span class="token punctuation">=</span> <span class="token number">16384</span>
    <span class="token key property">netns_mounts_under_state_dir</span> <span class="token punctuation">=</span> <span class="token boolean">false</span>
    <span class="token key property">restrict_oom_score_adj</span> <span class="token punctuation">=</span> <span class="token boolean">false</span>
    <span class="token key property">sandbox_image</span> <span class="token punctuation">=</span> <span class="token string">&quot;k8s.gcr.io/pause:3.5&quot;</span>
    <span class="token key property">selinux_category_range</span> <span class="token punctuation">=</span> <span class="token number">1024</span>
    <span class="token key property">stats_collect_period</span> <span class="token punctuation">=</span> <span class="token number">10</span>
    <span class="token key property">stream_idle_timeout</span> <span class="token punctuation">=</span> <span class="token string">&quot;4h0m0s&quot;</span>
    <span class="token key property">stream_server_address</span> <span class="token punctuation">=</span> <span class="token string">&quot;127.0.0.1&quot;</span>
    <span class="token key property">stream_server_port</span> <span class="token punctuation">=</span> <span class="token string">&quot;0&quot;</span>
    <span class="token key property">systemd_cgroup</span> <span class="token punctuation">=</span> <span class="token boolean">false</span>
    <span class="token key property">tolerate_missing_hugetlb_controller</span> <span class="token punctuation">=</span> <span class="token boolean">true</span>
    <span class="token key property">unset_seccomp_profile</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>

    <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.grpc.v1.cri&quot;.cni</span><span class="token punctuation">]</span>
      <span class="token key property">bin_dir</span> <span class="token punctuation">=</span> <span class="token string">&quot;/opt/cni/bin&quot;</span>
      <span class="token key property">conf_dir</span> <span class="token punctuation">=</span> <span class="token string">&quot;/etc/cni/net.d&quot;</span>
      <span class="token key property">conf_template</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
      <span class="token key property">max_conf_num</span> <span class="token punctuation">=</span> <span class="token number">1</span>

    <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd</span><span class="token punctuation">]</span>
      <span class="token key property">default_runtime_name</span> <span class="token punctuation">=</span> <span class="token string">&quot;runc&quot;</span>
      <span class="token key property">disable_snapshot_annotations</span> <span class="token punctuation">=</span> <span class="token boolean">true</span>
      <span class="token key property">discard_unpacked_layers</span> <span class="token punctuation">=</span> <span class="token boolean">false</span>
      <span class="token key property">no_pivot</span> <span class="token punctuation">=</span> <span class="token boolean">false</span>
      <span class="token key property">snapshotter</span> <span class="token punctuation">=</span> <span class="token string">&quot;overlayfs&quot;</span>

      <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.default_runtime</span><span class="token punctuation">]</span>
        <span class="token key property">base_runtime_spec</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
        <span class="token key property">container_annotations</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token key property">pod_annotations</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token key property">privileged_without_host_devices</span> <span class="token punctuation">=</span> <span class="token boolean">false</span>
        <span class="token key property">runtime_engine</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
        <span class="token key property">runtime_root</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
        <span class="token key property">runtime_type</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>

        <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.default_runtime.options</span><span class="token punctuation">]</span>

      <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.runtimes</span><span class="token punctuation">]</span>

        <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.runtimes.runc</span><span class="token punctuation">]</span>
          <span class="token key property">base_runtime_spec</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
          <span class="token key property">container_annotations</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
          <span class="token key property">pod_annotations</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
          <span class="token key property">privileged_without_host_devices</span> <span class="token punctuation">=</span> <span class="token boolean">false</span>
          <span class="token key property">runtime_engine</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
          <span class="token key property">runtime_root</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
          <span class="token key property">runtime_type</span> <span class="token punctuation">=</span> <span class="token string">&quot;io.containerd.runc.v2&quot;</span>

          <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.runtimes.runc.options</span><span class="token punctuation">]</span>
            <span class="token key property">BinaryName</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
            <span class="token key property">CriuImagePath</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
            <span class="token key property">CriuPath</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
            <span class="token key property">CriuWorkPath</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
            <span class="token key property">IoGid</span> <span class="token punctuation">=</span> <span class="token number">0</span>
            <span class="token key property">IoUid</span> <span class="token punctuation">=</span> <span class="token number">0</span>
            <span class="token key property">NoNewKeyring</span> <span class="token punctuation">=</span> <span class="token boolean">false</span>
            <span class="token key property">NoPivotRoot</span> <span class="token punctuation">=</span> <span class="token boolean">false</span>
            <span class="token key property">Root</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
            <span class="token key property">ShimCgroup</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
            <span class="token key property">SystemdCgroup</span> <span class="token punctuation">=</span> <span class="token boolean">false</span>

      <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.untrusted_workload_runtime</span><span class="token punctuation">]</span>
        <span class="token key property">base_runtime_spec</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
        <span class="token key property">container_annotations</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token key property">pod_annotations</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token key property">privileged_without_host_devices</span> <span class="token punctuation">=</span> <span class="token boolean">false</span>
        <span class="token key property">runtime_engine</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
        <span class="token key property">runtime_root</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
        <span class="token key property">runtime_type</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>

        <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.untrusted_workload_runtime.options</span><span class="token punctuation">]</span>

    <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.grpc.v1.cri&quot;.image_decryption</span><span class="token punctuation">]</span>
      <span class="token key property">key_model</span> <span class="token punctuation">=</span> <span class="token string">&quot;node&quot;</span>

    <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.grpc.v1.cri&quot;.registry</span><span class="token punctuation">]</span>
      <span class="token key property">config_path</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>

      <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.grpc.v1.cri&quot;.registry.auths</span><span class="token punctuation">]</span>

      <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.grpc.v1.cri&quot;.registry.configs</span><span class="token punctuation">]</span>

      <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.grpc.v1.cri&quot;.registry.headers</span><span class="token punctuation">]</span>

      <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.grpc.v1.cri&quot;.registry.mirrors</span><span class="token punctuation">]</span>

    <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.grpc.v1.cri&quot;.x509_key_pair_streaming</span><span class="token punctuation">]</span>
      <span class="token key property">tls_cert_file</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
      <span class="token key property">tls_key_file</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>

  <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.internal.v1.opt&quot;</span><span class="token punctuation">]</span>
    <span class="token key property">path</span> <span class="token punctuation">=</span> <span class="token string">&quot;/opt/containerd&quot;</span>

  <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.internal.v1.restart&quot;</span><span class="token punctuation">]</span>
    <span class="token key property">interval</span> <span class="token punctuation">=</span> <span class="token string">&quot;10s&quot;</span>

  <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.metadata.v1.bolt&quot;</span><span class="token punctuation">]</span>
    <span class="token key property">content_sharing_policy</span> <span class="token punctuation">=</span> <span class="token string">&quot;shared&quot;</span>

  <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.monitor.v1.cgroups&quot;</span><span class="token punctuation">]</span>
    <span class="token key property">no_prometheus</span> <span class="token punctuation">=</span> <span class="token boolean">false</span>

  <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.runtime.v1.linux&quot;</span><span class="token punctuation">]</span>
    <span class="token key property">no_shim</span> <span class="token punctuation">=</span> <span class="token boolean">false</span>
    <span class="token key property">runtime</span> <span class="token punctuation">=</span> <span class="token string">&quot;runc&quot;</span>
    <span class="token key property">runtime_root</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
    <span class="token key property">shim</span> <span class="token punctuation">=</span> <span class="token string">&quot;containerd-shim&quot;</span>
    <span class="token key property">shim_debug</span> <span class="token punctuation">=</span> <span class="token boolean">false</span>

  <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.runtime.v2.task&quot;</span><span class="token punctuation">]</span>
    <span class="token key property">platforms</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;linux/amd64&quot;</span><span class="token punctuation">]</span>

  <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.service.v1.diff-service&quot;</span><span class="token punctuation">]</span>
    <span class="token key property">default</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;walking&quot;</span><span class="token punctuation">]</span>

  <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.snapshotter.v1.aufs&quot;</span><span class="token punctuation">]</span>
    <span class="token key property">root_path</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>

  <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.snapshotter.v1.btrfs&quot;</span><span class="token punctuation">]</span>
    <span class="token key property">root_path</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>

  <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.snapshotter.v1.devmapper&quot;</span><span class="token punctuation">]</span>
    <span class="token key property">async_remove</span> <span class="token punctuation">=</span> <span class="token boolean">false</span>
    <span class="token key property">base_image_size</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
    <span class="token key property">pool_name</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
    <span class="token key property">root_path</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>

  <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.snapshotter.v1.native&quot;</span><span class="token punctuation">]</span>
    <span class="token key property">root_path</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>

  <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.snapshotter.v1.overlayfs&quot;</span><span class="token punctuation">]</span>
    <span class="token key property">root_path</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>

  <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.snapshotter.v1.zfs&quot;</span><span class="token punctuation">]</span>
    <span class="token key property">root_path</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>

<span class="token punctuation">[</span><span class="token table class-name">proxy_plugins</span><span class="token punctuation">]</span>

<span class="token punctuation">[</span><span class="token table class-name">stream_processors</span><span class="token punctuation">]</span>

  <span class="token punctuation">[</span><span class="token table class-name">stream_processors.&quot;io.containerd.ocicrypt.decoder.v1.tar&quot;</span><span class="token punctuation">]</span>
    <span class="token key property">accepts</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;application/vnd.oci.image.layer.v1.tar+encrypted&quot;</span><span class="token punctuation">]</span>
    <span class="token key property">args</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;--decryption-keys-path&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/etc/containerd/ocicrypt/keys&quot;</span><span class="token punctuation">]</span>
    <span class="token key property">env</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;OCICRYPT_KEYPROVIDER_CONFIG=/etc/containerd/ocicrypt/ocicrypt_keyprovider.conf&quot;</span><span class="token punctuation">]</span>
    <span class="token key property">path</span> <span class="token punctuation">=</span> <span class="token string">&quot;ctd-decoder&quot;</span>
    <span class="token key property">returns</span> <span class="token punctuation">=</span> <span class="token string">&quot;application/vnd.oci.image.layer.v1.tar&quot;</span>

  <span class="token punctuation">[</span><span class="token table class-name">stream_processors.&quot;io.containerd.ocicrypt.decoder.v1.tar.gzip&quot;</span><span class="token punctuation">]</span>
    <span class="token key property">accepts</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;application/vnd.oci.image.layer.v1.tar+gzip+encrypted&quot;</span><span class="token punctuation">]</span>
    <span class="token key property">args</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;--decryption-keys-path&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/etc/containerd/ocicrypt/keys&quot;</span><span class="token punctuation">]</span>
    <span class="token key property">env</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;OCICRYPT_KEYPROVIDER_CONFIG=/etc/containerd/ocicrypt/ocicrypt_keyprovider.conf&quot;</span><span class="token punctuation">]</span>
    <span class="token key property">path</span> <span class="token punctuation">=</span> <span class="token string">&quot;ctd-decoder&quot;</span>
    <span class="token key property">returns</span> <span class="token punctuation">=</span> <span class="token string">&quot;application/vnd.oci.image.layer.v1.tar+gzip&quot;</span>

<span class="token punctuation">[</span><span class="token table class-name">timeouts</span><span class="token punctuation">]</span>
  <span class="token key property">&quot;io.containerd.timeout.shim.cleanup&quot;</span> <span class="token punctuation">=</span> <span class="token string">&quot;5s&quot;</span>
  <span class="token key property">&quot;io.containerd.timeout.shim.load&quot;</span> <span class="token punctuation">=</span> <span class="token string">&quot;5s&quot;</span>
  <span class="token key property">&quot;io.containerd.timeout.shim.shutdown&quot;</span> <span class="token punctuation">=</span> <span class="token string">&quot;3s&quot;</span>
  <span class="token key property">&quot;io.containerd.timeout.task.state&quot;</span> <span class="token punctuation">=</span> <span class="token string">&quot;2s&quot;</span>

<span class="token punctuation">[</span><span class="token table class-name">ttrpc</span><span class="token punctuation">]</span>
  <span class="token key property">address</span> <span class="token punctuation">=</span> <span class="token string">&quot;&quot;</span>
  <span class="token key property">gid</span> <span class="token punctuation">=</span> <span class="token number">0</span>
  <span class="token key property">uid</span> <span class="token punctuation">=</span> <span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这个配置文件比较复杂，我们可以将重点放在其中的 <code>plugins</code> 配置上面，仔细观察我们可以发现每一个顶级配置块的命名都是 <code>plugins.&quot;io.containerd.xxx.vx.xxx&quot;</code> 这种形式，每一个顶级配置块都表示一个插件，其中 <code>io.containerd.xxx.vx</code> 表示插件的类型，<code>vx</code> 后面的 <code>xxx</code> 表示插件的 ID，我们可以通过 <code>ctr</code> 查看插件列表：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr plugin <span class="token function">ls</span>
ctr plugin <span class="token function">ls</span>
TYPE                            ID                       PLATFORMS      STATUS
io.containerd.content.v1        content                  -              ok
io.containerd.snapshotter.v1    aufs                     linux/amd64    ok
io.containerd.snapshotter.v1    btrfs                    linux/amd64    skip
io.containerd.snapshotter.v1    devmapper                linux/amd64    error
io.containerd.snapshotter.v1    native                   linux/amd64    ok
io.containerd.snapshotter.v1    overlayfs                linux/amd64    ok
io.containerd.snapshotter.v1    zfs                      linux/amd64    skip
io.containerd.metadata.v1       bolt                     -              ok
io.containerd.differ.v1         walking                  linux/amd64    ok
io.containerd.gc.v1             scheduler                -              ok
io.containerd.service.v1        introspection-service    -              ok
io.containerd.service.v1        containers-service       -              ok
io.containerd.service.v1        content-service          -              ok
io.containerd.service.v1        diff-service             -              ok
io.containerd.service.v1        images-service           -              ok
io.containerd.service.v1        leases-service           -              ok
io.containerd.service.v1        namespaces-service       -              ok
io.containerd.service.v1        snapshots-service        -              ok
io.containerd.runtime.v1        linux                    linux/amd64    ok
io.containerd.runtime.v2        task                     linux/amd64    ok
io.containerd.monitor.v1        cgroups                  linux/amd64    ok
io.containerd.service.v1        tasks-service            -              ok
io.containerd.internal.v1       restart                  -              ok
io.containerd.grpc.v1           containers               -              ok
io.containerd.grpc.v1           content                  -              ok
io.containerd.grpc.v1           <span class="token function">diff</span>                     -              ok
io.containerd.grpc.v1           events                   -              ok
io.containerd.grpc.v1           healthcheck              -              ok
io.containerd.grpc.v1           images                   -              ok
io.containerd.grpc.v1           leases                   -              ok
io.containerd.grpc.v1           namespaces               -              ok
io.containerd.internal.v1       opt                      -              ok
io.containerd.grpc.v1           snapshots                -              ok
io.containerd.grpc.v1           tasks                    -              ok
io.containerd.grpc.v1           version                  -              ok
io.containerd.grpc.v1           cri                      linux/amd64    ok
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>顶级配置块下面的子配置块表示该插件的各种配置，比如 cri 插件下面就分为 containerd、cni 和 registry 的配置，而 containerd 下面又可以配置各种 runtime，还可以配置默认的 runtime。比如现在我们要为镜像配置一个加速器，那么就需要在 cri 配置块下面的 <code>registry</code> 配置块下面进行配置 <code>registry.mirrors</code>：</p><div class="language-toml ext-toml line-numbers-mode"><pre class="language-toml"><code><span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.grpc.v1.cri&quot;.registry</span><span class="token punctuation">]</span>
  <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.grpc.v1.cri&quot;.registry.mirrors</span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.grpc.v1.cri&quot;.registry.mirrors.&quot;docker.io&quot;</span><span class="token punctuation">]</span>
      <span class="token key property">endpoint</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;https://bqr1dr1n.mirror.aliyuncs.com&quot;</span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token table class-name">plugins.&quot;io.containerd.grpc.v1.cri&quot;.registry.mirrors.&quot;k8s.gcr.io&quot;</span><span class="token punctuation">]</span>
      <span class="token key property">endpoint</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;https://registry.aliyuncs.com/k8sxio&quot;</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>registry.mirrors.&quot;xxx&quot;</code>: 表示需要配置 mirror 的镜像仓库，例如 <code>registry.mirrors.&quot;docker.io&quot;</code> 表示配置 <a href="http://docker.io" target="_blank" rel="noopener noreferrer">docker.io<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 的 mirror。</li><li><code>endpoint</code>: 表示提供 mirror 的镜像加速服务，比如我们可以注册一个阿里云的镜像服务来作为 <a href="http://docker.io" target="_blank" rel="noopener noreferrer">docker.io<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 的 mirror。</li></ul><p>另外在默认配置中还有两个关于存储的配置路径：</p><div class="language-toml ext-toml line-numbers-mode"><pre class="language-toml"><code><span class="token key property">root</span> <span class="token punctuation">=</span> <span class="token string">&quot;/var/lib/containerd&quot;</span>
<span class="token key property">state</span> <span class="token punctuation">=</span> <span class="token string">&quot;/run/containerd&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>其中 <code>root</code> 是用来保存持久化数据，包括 Snapshots, Content, Metadata 以及各种插件的数据，每一个插件都有自己单独的目录，Containerd 本身不存储任何数据，它的所有功能都来自于已加载的插件。而另外的 <code>state</code> 是用来保存运行时的临时数据的，包括 sockets、pid、挂载点、运行时状态以及不需要持久化的插件数据。</p><h3 id="使用" tabindex="-1"><a class="header-anchor" href="#使用" aria-hidden="true">#</a> 使用</h3><p>我们知道 Docker CLI 工具提供了需要增强用户体验的功能，containerd 同样也提供一个对应的 CLI 工具：<code>ctr</code>，不过 ctr 的功能没有 docker 完善，但是关于镜像和容器的基本功能都是有的。接下来我们就先简单介绍下 <code>ctr</code> 的使用。</p><p><strong>帮助</strong></p><p>直接输入 <code>ctr</code> 命令即可获得所有相关的操作命令使用方式：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr
NAME:
   ctr -
        __
  _____/ /______
 / ___/ __/ ___/
/ /__/ /_/ /
<span class="token punctuation">\</span>___/<span class="token punctuation">\</span>__/_/

containerd CLI


USAGE:
   ctr <span class="token punctuation">[</span>global options<span class="token punctuation">]</span> <span class="token builtin class-name">command</span> <span class="token punctuation">[</span>command options<span class="token punctuation">]</span> <span class="token punctuation">[</span>arguments<span class="token punctuation">..</span>.<span class="token punctuation">]</span>

VERSION:
   v1.5.5

DESCRIPTION:

ctr is an unsupported debug and administrative client <span class="token keyword">for</span> interacting
with the containerd daemon. Because it is unsupported, the commands,
options, and operations are not guaranteed to be backward compatible or
stable from release to release of the containerd project.

COMMANDS:
   plugins, plugin            provides information about containerd plugins
   version                    print the client and server versions
   containers, c, container   manage containers
   content                    manage content
   events, event              display containerd events
   images, image, i           manage images
   leases                     manage leases
   namespaces, namespace, ns  manage namespaces
   pprof                      provide golang pprof outputs <span class="token keyword">for</span> containerd
   run                        run a container
   snapshots, snapshot        manage snapshots
   tasks, t, task             manage tasks
   <span class="token function">install</span>                    <span class="token function">install</span> a new package
   oci                        OCI tools
   shim                       interact with a shim directly
   help, h                    Shows a list of commands or <span class="token builtin class-name">help</span> <span class="token keyword">for</span> one <span class="token builtin class-name">command</span>

GLOBAL OPTIONS:
   <span class="token parameter variable">--debug</span>                      <span class="token builtin class-name">enable</span> debug output <span class="token keyword">in</span> logs
   <span class="token parameter variable">--address</span> value, <span class="token parameter variable">-a</span> value    address <span class="token keyword">for</span> containerd&#39;s GRPC server <span class="token punctuation">(</span>default: <span class="token string">&quot;/run/containerd/containerd.sock&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token variable">$CONTAINERD_ADDRESS</span><span class="token punctuation">]</span>
   <span class="token parameter variable">--timeout</span> value              total <span class="token function">timeout</span> <span class="token keyword">for</span> ctr commands <span class="token punctuation">(</span>default: 0s<span class="token punctuation">)</span>
   --connect-timeout value      <span class="token function">timeout</span> <span class="token keyword">for</span> connecting to containerd <span class="token punctuation">(</span>default: 0s<span class="token punctuation">)</span>
   <span class="token parameter variable">--namespace</span> value, <span class="token parameter variable">-n</span> value  namespace to use with commands <span class="token punctuation">(</span>default: <span class="token string">&quot;default&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token variable">$CONTAINERD_NAMESPACE</span><span class="token punctuation">]</span>
   --help, <span class="token parameter variable">-h</span>                   show <span class="token builtin class-name">help</span>
   --version, <span class="token parameter variable">-v</span>                print the version
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="镜像操作" tabindex="-1"><a class="header-anchor" href="#镜像操作" aria-hidden="true">#</a> 镜像操作</h4><p><strong>拉取镜像</strong></p><p>拉取镜像可以使用 <code>ctr image pull</code> 来完成，比如拉取 Docker Hub 官方镜像 <code>nginx:alpine</code>，需要注意的是镜像地址需要加上 <code>docker.io</code> Host 地址：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr image pull docker.io/library/nginx:alpine
docker.io/library/nginx:alpine:                                                   resolved       <span class="token operator">|</span>++++++++++++++++++++++++++++++++++++++<span class="token operator">|</span>
index-sha256:bead42240255ae1485653a956ef41c9e458eb077fcb6dc664cbc3aa9701a05ce:    exists         <span class="token operator">|</span>++++++++++++++++++++++++++++++++++++++<span class="token operator">|</span>
manifest-sha256:ce6ca11a3fa7e0e6b44813901e3289212fc2f327ee8b1366176666e8fb470f24: <span class="token keyword">done</span>           <span class="token operator">|</span>++++++++++++++++++++++++++++++++++++++<span class="token operator">|</span>
layer-sha256:9a6ac07b84eb50935293bb185d0a8696d03247f74fd7d43ea6161dc0f293f81f:    <span class="token keyword">done</span>           <span class="token operator">|</span>++++++++++++++++++++++++++++++++++++++<span class="token operator">|</span>
layer-sha256:e82f830de071ebcda58148003698f32205b7970b01c58a197ac60d6bb79241b0:    <span class="token keyword">done</span>           <span class="token operator">|</span>++++++++++++++++++++++++++++++++++++++<span class="token operator">|</span>
layer-sha256:d7c9fa7589ae28cd3306b204d5dd9a539612593e35df70f7a1d69ff7548e74cf:    <span class="token keyword">done</span>           <span class="token operator">|</span>++++++++++++++++++++++++++++++++++++++<span class="token operator">|</span>
layer-sha256:bf2b3ee132db5b4c65432e53aca69da4e609c6cb154e0d0e14b2b02259e9c1e3:    <span class="token keyword">done</span>           <span class="token operator">|</span>++++++++++++++++++++++++++++++++++++++<span class="token operator">|</span>
config-sha256:7ce0143dee376bfd2937b499a46fb110bda3c629c195b84b1cf6e19be1a9e23b:   <span class="token keyword">done</span>           <span class="token operator">|</span>++++++++++++++++++++++++++++++++++++++<span class="token operator">|</span>
layer-sha256:3c1eaf69ff492177c34bdbf1735b6f2e5400e417f8f11b98b0da878f4ecad5fb:    <span class="token keyword">done</span>           <span class="token operator">|</span>++++++++++++++++++++++++++++++++++++++<span class="token operator">|</span>
layer-sha256:29291e31a76a7e560b9b7ad3cada56e8c18d50a96cca8a2573e4f4689d7aca77:    <span class="token keyword">done</span>           <span class="token operator">|</span>++++++++++++++++++++++++++++++++++++++<span class="token operator">|</span>
elapsed: <span class="token number">11</span>.9s                                                                    total:  <span class="token number">8.7</span> Mi <span class="token punctuation">(</span><span class="token number">748.1</span> KiB/s<span class="token punctuation">)</span>
unpacking linux/amd64 sha256:bead42240255ae1485653a956ef41c9e458eb077fcb6dc664cbc3aa9701a05ce<span class="token punctuation">..</span>.
done: <span class="token number">410</span>.86624ms
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>也可以使用 <code>--platform</code> 选项指定对应平台的镜像。当然对应的也有推送镜像的命令 <code>ctr image push</code>，如果是私有镜像则在推送的时候可以通过 <code>--user</code> 来自定义仓库的用户名和密码。</p><p><strong>列出本地镜像</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr image <span class="token function">ls</span>
REF                            TYPE                                                      DIGEST                                                                  SIZE    PLATFORMS                                                                                LABELS
docker.io/library/nginx:alpine application/vnd.docker.distribution.manifest.list.v2+json sha256:bead42240255ae1485653a956ef41c9e458eb077fcb6dc664cbc3aa9701a05ce <span class="token number">9.5</span> MiB linux/386,linux/amd64,linux/arm/v6,linux/arm/v7,linux/arm64/v8,linux/ppc64le,linux/s390x -
➜  ~ ctr image <span class="token function">ls</span> <span class="token parameter variable">-q</span>
docker.io/library/nginx:alpine
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用 <code>-q（--quiet）</code> 选项可以只打印镜像名称。</p><p><strong>检测本地镜像</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr image check
REF                            TYPE                                                      DIGEST                                                                  STATUS         SIZE            UNPACKED
docker.io/library/nginx:alpine application/vnd.docker.distribution.manifest.list.v2+json sha256:bead42240255ae1485653a956ef41c9e458eb077fcb6dc664cbc3aa9701a05ce complete <span class="token punctuation">(</span><span class="token number">7</span>/7<span class="token punctuation">)</span> <span class="token number">9.5</span> MiB/9.5 MiB <span class="token boolean">true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>主要查看其中的 <code>STATUS</code>，<code>complete</code> 表示镜像是完整可用的状态。</p><p><strong>重新打标签</strong></p><p>同样的我们也可以重新给指定的镜像打一个 Tag：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr image tag docker.io/library/nginx:alpine harbor.k8s.local/course/nginx:alpine
harbor.k8s.local/course/nginx:alpine
➜  ~ ctr image <span class="token function">ls</span> <span class="token parameter variable">-q</span>
docker.io/library/nginx:alpine
harbor.k8s.local/course/nginx:alpine
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>删除镜像</strong></p><p>不需要使用的镜像也可以使用 <code>ctr image rm</code> 进行删除：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr image <span class="token function">rm</span> harbor.k8s.local/course/nginx:alpine
harbor.k8s.local/course/nginx:alpine
➜  ~ ctr image <span class="token function">ls</span> <span class="token parameter variable">-q</span>
docker.io/library/nginx:alpine
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>加上 <code>--sync</code> 选项可以同步删除镜像和所有相关的资源。</p><p><strong>将镜像挂载到主机目录</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr image <span class="token function">mount</span> docker.io/library/nginx:alpine /mnt
sha256:c3554b2d61e3c1cffcaba4b4fa7651c644a3354efaafa2f22cb53542f6c600dc
/mnt
➜  ~ tree <span class="token parameter variable">-L</span> <span class="token number">1</span> /mnt
/mnt
├── bin
├── dev
├── docker-entrypoint.d
├── docker-entrypoint.sh
├── etc
├── home
├── lib
├── media
├── mnt
├── opt
├── proc
├── root
├── run
├── sbin
├── srv
├── sys
├── tmp
├── usr
└── var

<span class="token number">18</span> directories, <span class="token number">1</span> <span class="token function">file</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>将镜像从主机目录上卸载</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr image unmount /mnt
/mnt
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>将镜像导出为压缩包</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr image <span class="token builtin class-name">export</span> nginx.tar.gz docker.io/library/nginx:alpine
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>从压缩包导入镜像</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr image <span class="token function">import</span> nginx.tar.gz
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="容器操作" tabindex="-1"><a class="header-anchor" href="#容器操作" aria-hidden="true">#</a> 容器操作</h4><p>容器相关操作可以通过 <code>ctr container</code> 获取。</p><p><strong>创建容器</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr container create docker.io/library/nginx:alpine nginx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>列出容器</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr container <span class="token function">ls</span>
CONTAINER    IMAGE                             RUNTIME
nginx        docker.io/library/nginx:alpine    io.containerd.runc.v2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>同样可以加上 <code>-q</code> 选项精简列表内容：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr container <span class="token function">ls</span> <span class="token parameter variable">-q</span>
nginx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>查看容器详细配置</strong></p><p>类似于 <code>docker inspect</code> 功能。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr container info nginx
<span class="token punctuation">{</span>
    <span class="token string">&quot;ID&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;nginx&quot;</span>,
    <span class="token string">&quot;Labels&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;io.containerd.image.config.stop-signal&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;SIGQUIT&quot;</span>
    <span class="token punctuation">}</span>,
    <span class="token string">&quot;Image&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;docker.io/library/nginx:alpine&quot;</span>,
    <span class="token string">&quot;Runtime&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;io.containerd.runc.v2&quot;</span>,
        <span class="token string">&quot;Options&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;type_url&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;containerd.runc.v1.Options&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>,
    <span class="token string">&quot;SnapshotKey&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;nginx&quot;</span>,
    <span class="token string">&quot;Snapshotter&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;overlayfs&quot;</span>,
    <span class="token string">&quot;CreatedAt&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2021-08-12T08:23:13.792871558Z&quot;</span>,
    <span class="token string">&quot;UpdatedAt&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2021-08-12T08:23:13.792871558Z&quot;</span>,
    <span class="token string">&quot;Extensions&quot;</span><span class="token builtin class-name">:</span> null,
    <span class="token string">&quot;Spec&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>删除容器</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr container <span class="token function">rm</span> nginx
➜  ~ ctr container <span class="token function">ls</span>
CONTAINER    IMAGE    RUNTIME
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>除了使用 <code>rm</code> 子命令之外也可以使用 <code>delete</code> 或者 <code>del</code> 删除容器。</p><h4 id="任务" tabindex="-1"><a class="header-anchor" href="#任务" aria-hidden="true">#</a> 任务</h4><p>上面我们通过 <code>container create</code> 命令创建的容器，并没有处于运行状态，只是一个静态的容器。一个 container 对象只是包含了运行一个容器所需的资源及相关配置数据，表示 namespaces、rootfs 和容器的配置都已经初始化成功了，只是用户进程还没有启动。</p><p>一个容器真正运行起来是由 Task 任务实现的，Task 可以为容器设置网卡，还可以配置工具来对容器进行监控等。</p><p>Task 相关操作可以通过 <code>ctr task</code> 获取，如下我们通过 Task 来启动容器：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr task start <span class="token parameter variable">-d</span> nginx
/docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration
/docker-entrypoint.sh: Looking <span class="token keyword">for</span> shell scripts <span class="token keyword">in</span> /docker-entrypoint.d/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>启动容器后可以通过 <code>task ls</code> 查看正在运行的容器：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr task <span class="token function">ls</span>
TASK     PID     STATUS
nginx    <span class="token number">3630</span>    RUNNING
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>同样也可以使用 <code>exec</code> 命令进入容器进行操作：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr task <span class="token builtin class-name">exec</span> --exec-id <span class="token number">0</span> <span class="token parameter variable">-t</span> nginx <span class="token function">sh</span>
/ <span class="token comment">#</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>不过这里需要注意必须要指定 <code>--exec-id</code> 参数，这个 id 可以随便写，只要唯一就行。</p><p>暂停容器，和 <code>docker pause</code> 类似的功能：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr task pause nginx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>暂停后容器状态变成了 <code>PAUSED</code>：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr task <span class="token function">ls</span>
TASK     PID     STATUS
nginx    <span class="token number">3630</span>    PAUSED
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>同样也可以使用 <code>resume</code> 命令来恢复容器：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr task resume nginx
➜  ~ ctr task <span class="token function">ls</span>
TASK     PID     STATUS
nginx    <span class="token number">3630</span>    RUNNING
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>不过需要注意 ctr 没有 stop 容器的功能，只能暂停或者杀死容器。杀死容器可以使用 <code>task kill</code> 命令:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr task <span class="token function">kill</span> nginx
➜  ~ ctr task <span class="token function">ls</span>
TASK     PID     STATUS
nginx    <span class="token number">3630</span>    STOPPED
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>杀掉容器后可以看到容器的状态变成了 <code>STOPPED</code>。同样也可以通过 <code>task rm</code> 命令删除 Task：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr task <span class="token function">rm</span> nginx
➜  ~ ctr task <span class="token function">ls</span>
TASK    PID    STATUS
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>除此之外我们还可以获取容器的 cgroup 相关信息，可以使用 <code>task metrics</code> 命令用来获取容器的内存、CPU 和 PID 的限额与使用量。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 重新启动容器</span>
➜  ~ ctr task metrics nginx
ID       TIMESTAMP
nginx    <span class="token number">2021</span>-08-12 08:50:46.952769941 +0000 UTC

METRIC                   VALUE
memory.usage_in_bytes    <span class="token number">8855552</span>
memory.limit_in_bytes    <span class="token number">9223372036854771712</span>
memory.stat.cache        <span class="token number">0</span>
cpuacct.usage            <span class="token number">22467106</span>
cpuacct.usage_percpu     <span class="token punctuation">[</span><span class="token number">2962708</span> <span class="token number">860891</span> <span class="token number">1163413</span> <span class="token number">1915748</span> <span class="token number">1058868</span> <span class="token number">2888139</span> <span class="token number">6159277</span> <span class="token number">5458062</span><span class="token punctuation">]</span>
pids.current             <span class="token number">9</span>
pids.limit               <span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>还可以使用 <code>task ps</code> 命令查看容器中所有进程在宿主机中的 PID：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr task <span class="token function">ps</span> nginx
PID     INFO
<span class="token number">3984</span>    -
<span class="token number">4029</span>    -
<span class="token number">4030</span>    -
<span class="token number">4031</span>    -
<span class="token number">4032</span>    -
<span class="token number">4033</span>    -
<span class="token number">4034</span>    -
<span class="token number">4035</span>    -
<span class="token number">4036</span>    -
➜  ~ ctr task <span class="token function">ls</span>
TASK     PID     STATUS
nginx    <span class="token number">3984</span>    RUNNING
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中第一个 PID <code>3984</code> 就是我们容器中的1号进程。</p><h4 id="命名空间" tabindex="-1"><a class="header-anchor" href="#命名空间" aria-hidden="true">#</a> 命名空间</h4><p>另外 Containerd 中也支持命名空间的概念，比如查看命名空间：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr ns <span class="token function">ls</span>
NAME    LABELS
default
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果不指定，ctr 默认使用的是 <code>default</code> 空间。同样也可以使用 <code>ns create</code> 命令创建一个命名空间：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr ns create <span class="token builtin class-name">test</span>
➜  ~ ctr ns <span class="token function">ls</span>
NAME    LABELS
default
<span class="token builtin class-name">test</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用 <code>remove</code> 或者 <code>rm</code> 可以删除 namespace：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr ns <span class="token function">rm</span> <span class="token builtin class-name">test</span>
<span class="token builtin class-name">test</span>
➜  ~ ctr ns <span class="token function">ls</span>
NAME    LABELS
default
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>有了命名空间后就可以在操作资源的时候指定 namespace，比如查看 test 命名空间的镜像，可以在操作命令后面加上 <code>-n test</code> 选项：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr <span class="token parameter variable">-n</span> <span class="token builtin class-name">test</span> image <span class="token function">ls</span>
REF TYPE DIGEST SIZE PLATFORMS LABELS
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>我们知道 Docker 其实也是默认调用的 containerd，事实上 Docker 使用的 containerd 下面的命名空间默认是 <code>moby</code>，而不是 <code>default</code>，所以假如我们有用 docker 启动容器，那么我们也可以通过 <code>ctr -n moby</code> 来定位下面的容器：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  ~ ctr <span class="token parameter variable">-n</span> moby container <span class="token function">ls</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>同样 Kubernetes 下使用的 containerd 默认命名空间是 <code>k8s.io</code>，所以我们可以使用 <code>ctr -n k8s.io</code> 来查看 Kubernetes 下面创建的容器。后续我们再介绍如何将 Kubernetes 集群的容器运行时切换到 <code>containerd</code>。</p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/vuepress-theme-hope/vuepress-theme-hope/edit/main/demo/theme-docs/src/zh/pip/docker/07.一文搞懂containerd.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><!----><!----></footer><nav class="page-nav"><!----><a href="/docs/zh/pip/docker/01.Docker%E5%9F%BA%E7%A1%80.html" class="nav-link next" aria-label="Docker基础"><div class="hint">下一页<span class="arrow right"></span></div><div class="link">Docker基础<!----></div></a></nav><div class="waline-wrapper" darkmode="false" style="display:block;"><div data-waline provider="Waline"><!--v-if--><div class="wl-comment"><!--v-if--><div class="wl-panel"><div class="wl-header item3"><!--[--><div class="wl-header-item"><label for="wl-nick">昵称</label><input id="wl-nick" class="wl-input wl-nick" name="nick" type="text" value></div><div class="wl-header-item"><label for="wl-mail">邮箱</label><input id="wl-mail" class="wl-input wl-mail" name="mail" type="email" value></div><div class="wl-header-item"><label for="wl-link">网址</label><input id="wl-link" class="wl-input wl-link" name="link" type="text" value></div><!--]--></div><textarea id="wl-edit" class="wl-editor" placeholder="请留言。(填写邮箱可在被回复时收到邮件提醒)"></textarea><div class="wl-preview" style="display:none;"><hr><h4>预览:</h4><!-- eslint-disable-next-line vue/no-v-html --><div class="wl-content"></div></div><div class="wl-footer"><div class="wl-actions"><a href="https://guides.github.com/features/mastering-markdown/" title="Markdown Guide" aria-label="Markdown is supported" class="wl-action" target="_blank" rel="noreferrer"><svg width="16" height="16" ariaHidden="true"><path d="M14.85 3H1.15C.52 3 0 3.52 0 4.15v7.69C0 12.48.52 13 1.15 13h13.69c.64 0 1.15-.52 1.15-1.15v-7.7C16 3.52 15.48 3 14.85 3zM9 11H7V8L5.5 9.92 4 8v3H2V5h2l1.5 2L7 5h2v6zm2.99.5L9.5 8H11V5h2v3h1.5l-2.51 3.5z" fill="currentColor"></path></svg></a><button class="wl-action" title="表情" style="display:none;"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M563.2 463.3 677 540c1.7 1.2 3.7 1.8 5.8 1.8.7 0 1.4-.1 2-.2 2.7-.5 5.1-2.1 6.6-4.4l25.3-37.8c1.5-2.3 2.1-5.1 1.6-7.8s-2.1-5.1-4.4-6.6l-73.6-49.1 73.6-49.1c2.3-1.5 3.9-3.9 4.4-6.6.5-2.7 0-5.5-1.6-7.8l-25.3-37.8a10.1 10.1 0 0 0-6.6-4.4c-.7-.1-1.3-.2-2-.2-2.1 0-4.1.6-5.8 1.8l-113.8 76.6c-9.2 6.2-14.7 16.4-14.7 27.5.1 11 5.5 21.3 14.7 27.4zM387 348.8h-45.5c-5.7 0-10.4 4.7-10.4 10.4v153.3c0 5.7 4.7 10.4 10.4 10.4H387c5.7 0 10.4-4.7 10.4-10.4V359.2c0-5.7-4.7-10.4-10.4-10.4zm333.8 241.3-41-20a10.3 10.3 0 0 0-8.1-.5c-2.6.9-4.8 2.9-5.9 5.4-30.1 64.9-93.1 109.1-164.4 115.2-5.7.5-9.9 5.5-9.5 11.2l3.9 45.5c.5 5.3 5 9.5 10.3 9.5h.9c94.8-8 178.5-66.5 218.6-152.7 2.4-5 .3-11.2-4.8-13.6zm186-186.1c-11.9-42-30.5-81.4-55.2-117.1-24.1-34.9-53.5-65.6-87.5-91.2-33.9-25.6-71.5-45.5-111.6-59.2-41.2-14-84.1-21.1-127.8-21.1h-1.2c-75.4 0-148.8 21.4-212.5 61.7-63.7 40.3-114.3 97.6-146.5 165.8-32.2 68.1-44.3 143.6-35.1 218.4 9.3 74.8 39.4 145 87.3 203.3.1.2.3.3.4.5l36.2 38.4c1.1 1.2 2.5 2.1 3.9 2.6 73.3 66.7 168.2 103.5 267.5 103.5 73.3 0 145.2-20.3 207.7-58.7 37.3-22.9 70.3-51.5 98.1-85 27.1-32.7 48.7-69.5 64.2-109.1 15.5-39.7 24.4-81.3 26.6-123.8 2.4-43.6-2.5-87-14.5-129zm-60.5 181.1c-8.3 37-22.8 72-43 104-19.7 31.1-44.3 58.6-73.1 81.7-28.8 23.1-61 41-95.7 53.4-35.6 12.7-72.9 19.1-110.9 19.1-82.6 0-161.7-30.6-222.8-86.2l-34.1-35.8c-23.9-29.3-42.4-62.2-55.1-97.7-12.4-34.7-18.8-71-19.2-107.9-.4-36.9 5.4-73.3 17.1-108.2 12-35.8 30-69.2 53.4-99.1 31.7-40.4 71.1-72 117.2-94.1 44.5-21.3 94-32.6 143.4-32.6 49.3 0 97 10.8 141.8 32 34.3 16.3 65.3 38.1 92 64.8 26.1 26 47.5 56 63.6 89.2 16.2 33.2 26.6 68.5 31 105.1 4.6 37.5 2.7 75.3-5.6 112.3z" fill="currentColor"></path></svg></button><button class="wl-action" title="表情包"><svg width="24" height="24" fill="currentcolor" viewBox="0 0 24 24"><path style="transform: translateY(0.5px)" d="M18.968 10.5H15.968V11.484H17.984V12.984H15.968V15H14.468V9H18.968V10.5V10.5ZM8.984 9C9.26533 9 9.49967 9.09367 9.687 9.281C9.87433 9.46833 9.968 9.70267 9.968 9.984V10.5H6.499V13.5H8.468V12H9.968V14.016C9.968 14.2973 9.87433 14.5317 9.687 14.719C9.49967 14.9063 9.26533 15 8.984 15H5.984C5.70267 15 5.46833 14.9063 5.281 14.719C5.09367 14.5317 5 14.2973 5 14.016V9.985C5 9.70367 5.09367 9.46933 5.281 9.282C5.46833 9.09467 5.70267 9.001 5.984 9.001H8.984V9ZM11.468 9H12.968V15H11.468V9V9Z"></path><path d="M18.5 3H5.75C3.6875 3 2 4.6875 2 6.75V18C2 20.0625 3.6875 21.75 5.75 21.75H18.5C20.5625 21.75 22.25 20.0625 22.25 18V6.75C22.25 4.6875 20.5625 3 18.5 3ZM20.75 18C20.75 19.2375 19.7375 20.25 18.5 20.25H5.75C4.5125 20.25 3.5 19.2375 3.5 18V6.75C3.5 5.5125 4.5125 4.5 5.75 4.5H18.5C19.7375 4.5 20.75 5.5125 20.75 6.75V18Z"></path></svg></button><input id="wl-image-upload" class="upload" type="file" accept=".png,.jpg,.jpeg,.webp,.bmp,.gif"><label for="wl-image-upload" class="wl-action" title="上传图片"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M784 112H240c-88 0-160 72-160 160v480c0 88 72 160 160 160h544c88 0 160-72 160-160V272c0-88-72-160-160-160zm96 640c0 52.8-43.2 96-96 96H240c-52.8 0-96-43.2-96-96V272c0-52.8 43.2-96 96-96h544c52.8 0 96 43.2 96 96v480z" fill="currentColor"></path><path d="M352 480c52.8 0 96-43.2 96-96s-43.2-96-96-96-96 43.2-96 96 43.2 96 96 96zm0-128c17.6 0 32 14.4 32 32s-14.4 32-32 32-32-14.4-32-32 14.4-32 32-32zm462.4 379.2-3.2-3.2-177.6-177.6c-25.6-25.6-65.6-25.6-91.2 0l-80 80-36.8-36.8c-25.6-25.6-65.6-25.6-91.2 0L200 728c-4.8 6.4-8 14.4-8 24 0 17.6 14.4 32 32 32 9.6 0 16-3.2 22.4-9.6L380.8 640l134.4 134.4c6.4 6.4 14.4 9.6 24 9.6 17.6 0 32-14.4 32-32 0-9.6-4.8-17.6-9.6-24l-52.8-52.8 80-80L769.6 776c6.4 4.8 12.8 8 20.8 8 17.6 0 32-14.4 32-32 0-8-3.2-16-8-20.8z" fill="currentColor"></path></svg></label><button class="wl-action" title="预览"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M710.816 654.301c70.323-96.639 61.084-230.578-23.705-314.843-46.098-46.098-107.183-71.109-172.28-71.109-65.008 0-126.092 25.444-172.28 71.109-45.227 46.098-70.756 107.183-70.756 172.106 0 64.923 25.444 126.007 71.194 172.106 46.099 46.098 107.184 71.109 172.28 71.109 51.414 0 100.648-16.212 142.824-47.404l126.53 126.006c7.058 7.06 16.297 10.979 26.406 10.979 10.105 0 19.343-3.919 26.402-10.979 14.467-14.467 14.467-38.172 0-52.723L710.816 654.301zm-315.107-23.265c-65.88-65.88-65.88-172.54 0-238.42 32.069-32.07 74.245-49.149 119.471-49.149 45.227 0 87.407 17.603 119.472 49.149 65.88 65.879 65.88 172.539 0 238.42-63.612 63.178-175.242 63.178-238.943 0zm0 0" fill="currentColor"></path><path d="M703.319 121.603H321.03c-109.8 0-199.469 89.146-199.469 199.38v382.034c0 109.796 89.236 199.38 199.469 199.38h207.397c20.653 0 37.384-16.645 37.384-37.299 0-20.649-16.731-37.296-37.384-37.296H321.03c-68.582 0-124.352-55.77-124.352-124.267V321.421c0-68.496 55.77-124.267 124.352-124.267h382.289c68.582 0 124.352 55.771 124.352 124.267V524.72c0 20.654 16.736 37.299 37.385 37.299 20.654 0 37.384-16.645 37.384-37.299V320.549c-.085-109.8-89.321-198.946-199.121-198.946zm0 0" fill="currentColor"></path></svg></button></div><div class="wl-info"><div class="wl-text-number">0 <!--v-if-->  字</div><button class="wl-btn">登录</button><button class="wl-btn primary" title="Cmd|Ctrl + Enter"><!--[-->提交<!--]--></button></div><div class="wl-gif-popup"><input type="text" placeholder="搜索表情包"><div class="wl-gallery" style="gap:6px;"><!--[--><!--]--></div><div class="wl-loading"><svg width="30" height="30" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><circle cx="50" cy="50" fill="none" stroke="currentColor" strokeWidth="4" r="40" stroke-dasharray="85 30"><animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="1s" values="0 50 50;360 50 50" keyTimes="0;1"></animateTransform></circle></svg></div></div><div class="wl-emoji-popup"><!--[--><!--]--><!--v-if--></div></div></div><!--v-if--></div><div class="wl-meta-head"><div class="wl-count"><!--v-if--> 评论</div><ul class="wl-sort"><!--[--><li class="active">按正序</li><li class="">按倒序</li><li class="">按热度</li><!--]--></ul></div><div class="wl-cards"><!--[--><!--]--></div><!--[--><div class="wl-loading"><svg width="30" height="30" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><circle cx="50" cy="50" fill="none" stroke="currentColor" strokeWidth="4" r="40" stroke-dasharray="85 30"><animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="1s" values="0 50 50;360 50 50" keyTimes="0;1"></animateTransform></circle></svg></div><!--]--><!-- Copyright Information --><div class="wl-power"> Powered by <a href="https://github.com/walinejs/waline" target="_blank" rel="noreferrer"> Waline </a> v2.13.0</div></div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">默认页脚</div><div class="copyright">Copyright © 2022 isKcount</div></footer><!--]--></div><!--]--><!----><!----><!--]--></div>
    <script type="module" src="/docs/assets/app.ca0279c0.js" defer></script>
  </body>
</html>
